

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; Ameba IoT Docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=b0e775ca" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/_static/custom.css" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Security and Encryption" href="../3_security/0_security_index.html" />
    <link rel="prev" title="Wi-Fi Adaptivity Test" href="0_wifi_adaptivity_index.html" />
   
  
  <script type="text/javascript" src="../../_static/js/selector.js"></script>

  <style>
    .wy-nav-content {max-width: 1000px;} /* 设置最大宽度 */
  </style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_product/0_ameba_product_center_index.html">Products Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_sdk/0_ameba_sdks_index.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_solutions/0_ameba_solutions_index.html">Ameba Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index.html">0.1 GCC Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gdb_debug/0_gdb_debug_index.html">0.2 GDB Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_library/0_gcc_build_library_index.html">0.3 GCC Build Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_example/0_sdk_example_index.html">0.4 SDK Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_memory_layout/0_layout_index.html">0.5 Flash &amp; RAM Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_user_config/0_usrcfg_index.html">0.6 User Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_tools/0_tools_index.html">0.7 Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_at_command/0_at_command_index.html">0.8 AT Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_file_system/0_vfs_index.html">0.9 Virtual File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_mpu_cache/0_mpu_cache_index.html">1.0 MPU and Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index.html">1.1 BOOT Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index.html">1.2 OTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_otpc/0_otpc_index.html">1.3 OTPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_chipen/0_chipen_index.html">1.4 CHIPEN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ipc/0_ipc_index.html">1.5 Inter Processor Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_pinmux/0_pinmux_index.html">1.6 PINMUX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index.html">1.7 GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index.html">1.9 Power Save</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_wifi_bridge/0_wifi_bridge_index.html">2.1 WHC Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_fullmac/0_fullmac_index.html">2.2 WHC FullMAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_tunnel/0_wifi_tunnel_index.html">2.3 Wi-Fi R-Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_csi/0_wifi_csi_index.html">2.5 Wi-Fi CSI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_wifi_adaptivity_index.html">2.6 Wi-Fi Adaptivity Test</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#standards">Standards</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interference-power">Interference Power</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#software-configuration">Software Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#edcca-mode">EDCCA Mode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#static-adjustment">Static Adjustment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-adjustment">Dynamic Adjustment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#edcca-threshold">EDCCA Threshold</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#command">Command</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#debug-sop">Debug SOP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3_security/0_security_index.html">3.1 Security &amp; Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_trng/0_trng_index.html">3.2 True Random Number Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_huk_derivation/0_huk_derivation_index_nda.html">3.3 HUK Derivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_rdp/0_rdp_index_nda.html">3.4 RDP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_rsip/0_rsip_index_nda.html">3.5 RSIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_secure_boot/0_secure_boot_index_nda.html">3.6 Secure Boot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_swd_protection/0_swd_protection_index_nda.html">3.7 SWD Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_tfm/0_tfm_index_nda.html">3.8 Trusted Firmware-M (TF-M)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_crypto_engine/0_crypto_engine_index.html">3.9 Crypto Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ecdsa_engine/0_ecdsa_index.html">3.a ECDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_eddsa_engine/0_eddsa_index.html">3.b EDDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_rsa_engine/0_rsa_index.html">3.c RSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai/0_ai_index.html">4.1 AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai_voice/0_ai_voice_index.html">4.2 AIVoice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index.html">4.3 Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_dsp/0_dsp_index.html">4.4 DSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mass_production/0_mp_index.html">6.1 Mass Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mp_image/0_mp_image_index.html">6.2 MP Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mptools/0_mptools_index.html">6.3 MP Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index.html">7.1 USB Host &amp; Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index.html">8.1 DMA Controllor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_psram/0_psram_index.html">8.2 PSRAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index.html">8.3 Thermal Meter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index.html">8.4 ADC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index.html">8.5 IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ledc/0_ledc_index.html">8.6 LEDC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_cap_touch/0_cap_touch_index.html">8.7 Cap-Touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_key_scan/0_key_scan_index.html">8.8 Key-Scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc_io/0_rtc_io_index.html">8.9 RTC-IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index.html">8.A LCDC</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">

        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_wifi_adaptivity_index.html">Wi-Fi Adaptivity Test</a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<span id="wifi-guide-adaptivity-test"></span><h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<section id="standards">
<h2>Standards<a class="headerlink" href="#standards" title="Link to this heading"></a></h2>
<p>Adaptivity is an automatic channel access mechanism by which a device avoids transmission in a channel in the presence of transmission in that channel. Any equipment with maximum declared RF output power level greater than 10dBm e.i.r.p. should apply Adaptivity mechanism.</p>
<p>ETSI has mandated Adaptivity certification since December 31, 2017. The related Standards are <em>ETSI EN 300 328 V2.2.2 (for 2G)</em> and <em>ETSI EN 301 893 V2.1.1 (for 5G)</em>. Steps of Adaptivity test are defined by ETSI as follows:</p>
<ol class="arabic simple">
<li><p>Connect the test object and the companion object, and the traffic is transmitted.</p></li>
<li><p>Add the interference signal, blocking signal of out of band is also necessary for 2G.</p></li>
<li><p>The test object stops TX.</p></li>
<li><p>Only allow short control signaling transmission (e.g. ACK) for the companion object.</p>
<ul class="simple">
<li><p>For 2G pass criteria, the TX duty cycle cannot exceed 10% within 50ms.</p></li>
<li><p>For 5G Pass criteria, the TX duty cycle within 50ms cannot exceed 5%.</p></li>
</ul>
</li>
<li><p>Repeat the above steps for different channels, bandwidths and modes.</p></li>
</ol>
</section>
<section id="interference-power">
<h2>Interference Power<a class="headerlink" href="#interference-power" title="Link to this heading"></a></h2>
<p>For interference signal power, the energy formula to be detected by ETSI is as follows. Additionally, the interference signal must exceed BW of the test object and have a 100% duty cycle.</p>
<ul class="simple">
<li><p>2G: TL = -70dBm/MHz + 10*log10(100mW/Pout)</p></li>
<li><p>5G: TL = -75dBm/MHz</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pout is the maximum TX power of test object.</p>
</div>
<p>Ameba is tested with the worst case in LAB.</p>
<ul class="simple">
<li><p>2G: TL = -70dBm/MHz</p></li>
<li><p>5G: TL = -75dBm/MHz</p></li>
</ul>
<p>The following table is the interference power with different frequencies and bandwidths.</p>
<table class="docutils align-default" id="id1" style="width: 100%">
<caption><span class="caption-text">Interference power with different frequencies and bandwidths</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Item</p></th>
<th class="head" colspan="2"><p>2G</p></th>
<th class="head" colspan="4"><p>5G</p></th>
</tr>
<tr class="row-even"><th class="head"><p>20MHZ</p></th>
<th class="head"><p>40MHZ</p></th>
<th class="head"><p>20MHZ</p></th>
<th class="head"><p>40MHZ</p></th>
<th class="head"><p>80MHZ</p></th>
<th class="head"><p>160MHZ</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Interference Power (dBm)</p></td>
<td><p>-57</p></td>
<td><p>-54</p></td>
<td><p>-62</p></td>
<td><p>-59</p></td>
<td><p>-56</p></td>
<td><p>-53</p></td>
</tr>
</tbody>
</table>
<p>When the interference power is greater than the threshold, the MAC is told to stop TX.</p>
<p>The following section illustrates software configuration, you can refer it to set EDCCA mode as <em>RTW_EDCCA_ADAPT</em> and adjust EDCCA threshold to pass Adaptivity test.</p>
</section>
</section>
<section id="software-configuration">
<h1>Software Configuration<a class="headerlink" href="#software-configuration" title="Link to this heading"></a></h1>
<section id="edcca-mode">
<h2>EDCCA Mode<a class="headerlink" href="#edcca-mode" title="Link to this heading"></a></h2>
<p>Ameba supports four EDCCA mode types:</p>
<ul class="simple">
<li><p><strong>RTW_EDCCA_NORM</strong>: Set EDCCA threshold dynamically with reference to current RSSI, default value</p></li>
<li><p><strong>RTW_EDCCA_ADAPT</strong>: Adaptivity certification for ETSI, fixed threshold, threshold can be modified by commands</p></li>
<li><p><strong>RTW_EDCCA_CS</strong>: Carrier Sense, Japan’s interference avoidance laws</p></li>
<li><p><strong>RTW_EDCCA_DISABLE</strong>: MAC TX without checking EDCCA signal</p></li>
</ul>
<p>There are two major differences between Adaptivity test (mode 1) and Carrier Sense (mode 2):</p>
<ul class="simple">
<li><p>The types of test interference required by ETSI regulations are AWGN White noise, remove preamble’s OFDM packet and LTE interference. Carrier Sense is single tone.</p></li>
<li><p>The interference retreat energy required by Carrier Sense is relatively high, which is -50dBm, and the interference energy threshold of ETSI is lower than that of carrier sense.</p></li>
</ul>
<p>The EDCCA mode types are defined in <code class="docutils literal notranslate"><span class="pre">component/wifi/driver/include/rtw_wifi_defs.h</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*The enumeration lists the edcca mode types*/</span>
<span class="k">enum</span><span class="w"> </span><span class="n">rtw_edcca_mode</span><span class="w"> </span><span class="p">{</span>
<span class="n">RTW_EDCCA_NORM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="cm">/* normal*/</span>
<span class="n">RTW_EDCCA_ADAPT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="cm">/* Adaptivity, ETSI*/</span>
<span class="n">RTW_EDCCA_CS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="cm">/*carrier sense, Japan*/</span>
<span class="n">RTW_EDCCA_DISABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="cm">/*disable*/</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="static-adjustment">
<h3>Static Adjustment<a class="headerlink" href="#static-adjustment" title="Link to this heading"></a></h3>
<p>The file for setting the EDCCA mode is in the following path, and it will be written statically during Wi-Fi initialization process.</p>
<ul class="simple">
<li><p>FreeRTOS:</p>
<ul>
<li><p>RTL8730E: <code class="docutils literal notranslate"><span class="pre">/component/soc/amebasmart/usrcfg/Ameba_wificfg.c</span></code></p></li>
<li><p>RTL8726EA/RTL8713EC/RTL8720EA/RTL8710EC: <code class="docutils literal notranslate"><span class="pre">/component/soc/amebalite/usrcfg/Ameba_wificfg.c</span></code></p></li>
<li><p>RTL8721Dx/RTL8711Dx: <code class="docutils literal notranslate"><span class="pre">/component/soc/amebadplus/usrcfg/Ameba_wificfg.c</span></code></p></li>
</ul>
</li>
<li><p>Linux:</p>
<ul>
<li><p>RTL8730E: <code class="docutils literal notranslate"><span class="pre">/firmware/component/wifi/cfg80211_fullmac/rtl8730e/ipc/Ameba_wificfg.c</span></code></p></li>
</ul>
</li>
</ul>
<p>Function name: <code class="xref py py-func docutils literal notranslate"><span class="pre">wifi_set_user_config()</span></code></p>
<ul>
<li><p>For ETSI Adaptivity certification, set EDCCA mode as <em>RTW_EDCCA_ADAPT</em></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">wifi_user_config_edcca_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RTW_EDCCA_ADAPT</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>For Carrier Sense, set EDCCA mode as <em>RTW_EDCCA_CS</em></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">wifi_user_config_edcca_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RTW_EDCCA_CS</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="dynamic-adjustment">
<h3>Dynamic Adjustment<a class="headerlink" href="#dynamic-adjustment" title="Link to this heading"></a></h3>
<p>In addition, EDCCA mode can also be set dynamically by commands.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The dynamic adjustment of EDCCA mode is supported <strong>only</strong> on Linux.</p>
</div>
<ul>
<li><p>Linux:</p>
<div class="toggle docutils container">
<p>The EDCCA mode has been added in <code class="docutils literal notranslate"><span class="pre">/proc/net/rtl8730e/wlan0/edcca_mode</span></code>. You can write or read it by the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">rtl8730e</span><span class="o">/</span><span class="n">wlan0</span><span class="o">/</span><span class="n">edcca_mode</span>
<span class="n">cat</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">rtl8730e</span><span class="o">/</span><span class="n">wlan0</span><span class="o">/</span><span class="n">edcca_mode</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>n is in [0, 1, 2, 9].</p>
</div>
<p>For example (Adaptivity certification):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span> <span class="c1"># echo 1 &gt; /proc/net/rtl8730e/wlan0/edcca_mode</span>
<span class="o">/</span> <span class="c1"># cat /proc/net/rtl8730e/wlan0/edcca_mode</span>
<span class="mi">1</span>
</pre></div>
</div>
</div>
</li>
<li><p>FreeRTOS:</p>
<p>Not support.</p>
</li>
</ul>
</section>
</section>
<section id="edcca-threshold">
<h2>EDCCA Threshold<a class="headerlink" href="#edcca-threshold" title="Link to this heading"></a></h2>
<section id="command">
<h3>Command<a class="headerlink" href="#command" title="Link to this heading"></a></h3>
<p>After connection with AP, you can get the current EDCCA threshold by the following command:</p>
<ul>
<li><p>FreeRTOS</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AT</span><span class="o">+</span><span class="n">WLDBG</span><span class="o">=</span><span class="n">get_edcca_th</span>
</pre></div>
</div>
</li>
<li><p>Linux</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATWZ</span> <span class="n">get_edcca_th</span>
</pre></div>
</div>
</li>
</ul>
<p>In most cases, the default values are sufficient to pass Adaptivity certification. If it doesn’t work, you can modify the EDCCA threshold by the following command:</p>
<ul>
<li><p>FreeRTOS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AT</span><span class="o">+</span><span class="n">WLDBG</span><span class="o">=</span><span class="n">fix_edcca_th</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>Linux:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATWZ</span> <span class="n">fix_edcca_th</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value’s unit is dBm and the scope is [-60, -80], and the minimum step is 1.</p>
</div>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h3>
<p>The examples of getting or setting the EDCCA threshold are as follows:</p>
<ul>
<li><p>FreeRTOS:</p>
<div class="toggle docutils container">
<ul>
<li><p>RTL8721Dx/RTL8711Dx 5G:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AT</span><span class="o">+</span><span class="n">WLDBG</span><span class="o">=</span><span class="n">get_edcca_th</span>
<span class="p">[</span><span class="n">WLDBG</span><span class="p">]:</span> <span class="n">_AT_WLAN_IWPRIV_</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="n">iwpriv_command</span><span class="p">]</span> <span class="n">cmd</span> <span class="n">name</span><span class="p">:</span> <span class="n">get_edcca_th</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="n">edcca</span> <span class="n">L2H</span> <span class="n">thre</span><span class="o">=-</span><span class="mi">65</span> <span class="n">dbm</span>

<span class="n">AT</span><span class="o">+</span><span class="n">WLDBG</span><span class="o">=</span><span class="n">fix_edcca_th</span> <span class="o">-</span><span class="mi">62</span>
<span class="p">[</span><span class="n">WLDBG</span><span class="p">]:</span> <span class="n">_AT_WLAN_IWPRIV_</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="n">iwpriv_command</span><span class="p">]</span> <span class="n">cmd</span> <span class="n">name</span><span class="p">:</span> <span class="n">fix_edcca_th</span>
</pre></div>
</div>
</li>
<li><p>RTL8730E 2G:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AT</span><span class="o">+</span><span class="n">WLDBG</span><span class="o">=</span><span class="n">get_edcca_th</span>
<span class="p">[</span><span class="n">WLDBG</span><span class="p">]:</span> <span class="n">_AT_WLAN_IWPRIV_</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="n">iwpriv_command</span><span class="p">]</span> <span class="n">cmd</span> <span class="n">name</span><span class="p">:</span> <span class="n">get_edcca_th</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="n">edcca</span> <span class="n">thre</span><span class="o">=-</span><span class="mi">60</span> <span class="n">dbm</span>

<span class="n">AT</span><span class="o">+</span><span class="n">WLDBG</span><span class="o">=</span><span class="n">fix_edcca_th</span> <span class="o">-</span><span class="mi">62</span>
<span class="p">[</span><span class="n">WLDBG</span><span class="p">]:</span> <span class="n">_AT_WLAN_IWPRIV_</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="n">iwpriv_command</span><span class="p">]</span> <span class="n">cmd</span> <span class="n">name</span><span class="p">:</span> <span class="n">fix_edcca_th</span>
</pre></div>
</div>
</li>
</ul>
</div>
</li>
<li><p>Linux:</p>
<div class="toggle docutils container">
<ul>
<li><p>RTL8730E:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span> <span class="c1"># ATWZ get_edcca_th</span>
<span class="p">[</span><span class="n">WLDBG</span><span class="p">]:</span> <span class="n">_AT_WLAN_IWPRIV_</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="n">iwpriv_command</span><span class="p">]</span> <span class="n">cmd</span> <span class="n">name</span><span class="p">:</span> <span class="n">get_edcca_th</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="n">edcca</span> <span class="n">thre</span><span class="o">=-</span><span class="mi">60</span> <span class="n">dbm</span>

<span class="o">/</span> <span class="c1"># ATWZ fix_edcca_th -61</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="n">iwpriv_command</span><span class="p">]</span> <span class="n">cmd</span> <span class="n">name</span><span class="p">:</span> <span class="n">fix_edcca_th</span>

<span class="o">/</span> <span class="c1"># ATWZ get_edcca_th</span>
<span class="p">[</span><span class="n">WLDBG</span><span class="p">]:</span> <span class="n">_AT_WLAN_IWPRIV_</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="n">iwpriv_command</span><span class="p">]</span> <span class="n">cmd</span> <span class="n">name</span><span class="p">:</span> <span class="n">get_edcca_th</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="n">edcca</span> <span class="n">thre</span><span class="o">=-</span><span class="mi">61</span> <span class="n">dbm</span>
</pre></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</section>
</section>
</section>
<section id="debug-sop">
<h1>Debug SOP<a class="headerlink" href="#debug-sop" title="Link to this heading"></a></h1>
<ol class="arabic">
<li><p>Verify that the Adaptivity mode is turned on.</p>
<p>The default SDK is normal EDCCA mode, so make sure that the driver switches to the Adaptivity mode for Adaptivity certification. Otherwise, the certification will fail.</p>
</li>
<li><p>Confirm whether there is a problem with the test method. For example:</p>
<ol class="loweralpha simple">
<li><p>It is recommended to test in a shielding room, excluding that some lab is not clean and may cause FA/CCA.</p></li>
<li><p>Adaptivity’s TP measures the TX of the object instead of the RX.</p></li>
<li><p>All antennas need to be connected to a source of interference. Otherwise, antenna diversity will cause authentication fail.</p></li>
<li><p>The RSSI of the object to be tested should be kept at -50dBm or above to prevent certification failure due to wire breakage. When a disconnection happens, a scan will be performed, and the scan will inevitably result in Adaptivity fail.</p></li>
<li><p>Confirm whether the interference energy size is correct. Some customers may mistake the meaning of dBM/MHZ and dBm, so they will mistype the interference energy and cause fail.</p></li>
</ol>
</li>
<li><p>If the proportion of missing packets exceeds the regulatory requirements: <code class="docutils literal notranslate"><span class="pre">2G:</span> <span class="pre">10%</span></code>, <code class="docutils literal notranslate"><span class="pre">5G:</span> <span class="pre">5%</span></code>, confirm whether it is our TX signal indeed.</p>
<p>You can check it by the following steps:</p>
<ol class="loweralpha simple">
<li><p>Use the sniffer to capture packets and check whether it is the beacon or BT signal sent by the AP.</p>
<ul class="simple">
<li><p>If it is indeed the packet of Ameba TX, check the packet type of TX. For example, is it scan packet or ACK?</p></li>
<li><p>If the problem is caused by AP, it is generally suggested that LAB should replace AP. This requirement is reasonable, because some AP behaviors will indeed lead to the Adaptivity failure of STA. For example, Ameba has TX silent, but the AP behavior may have been repeatedly harassing STA to let it back to ACK. ACK is a passive TX and cannot be blocked by the AdaptivIty mechanism.</p></li>
<li><p>If TX fail is caused by Ameba, for example, scan packet, which is sent by Ameba proactively, analyze why it enters the scan mode, which may be solved by modifying the driver code.</p></li>
</ul>
</li>
<li><p>When the proportion of missing packets is high or almost no stop TX, check whether the threshold is not appropriate. If the test energy hits correctly, the threshold can be adjusted appropriately to pass the test.</p></li>
</ol>
</li>
</ol>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="0_wifi_adaptivity_index.html" class="btn btn-neutral float-left" title="Wi-Fi Adaptivity Test" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../3_security/0_security_index.html" class="btn btn-neutral float-right" title="Security and Encryption" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Realsil.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>