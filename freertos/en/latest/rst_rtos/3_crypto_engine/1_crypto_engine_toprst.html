

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Supported ICs &mdash; Ameba IoT Docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dcc6a489" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dcc6a489" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="http://172.29.57.206:5000/docs/rst_rtos/3_crypto_engine/1_crypto_engine_toprst.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../../_static/tabs.js?v=3030b3cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ECDSA Engine" href="../3_ecdsa_engine/0_ecdsa_index.html" />
    <link rel="prev" title="Hardware Crypto Engine" href="0_crypto_engine_index.html" />
     

    

    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- 样式模板 -->
    <style>
        .wy-nav-content {
            max-width: 1100px;
             
        }

        .wy-nav-content {
            transition: margin 0.3s ease; /* 添加过渡效果 */
            margin-left: 0px !important; /* 侧边栏展开时的偏移 */
            max-width: calc(100% - 0px) !important; /* 调整最大宽度，使其与侧边栏宽度相关 */
        }

        .wy-nav-content.expanded {
            margin-left: 0 !important; /* 侧边栏收缩时内容区域回归左边 */
            max-width: 100% !important; /* 内容区域最大宽度调整 */
        }
    </style>

    <!-- 注入 TOC 映射和当前页面信息 -->
    

<!-- TOC 映射和当前文档信息 -->
<script>
// 将 Python 字典转换为 JS 对象
const TOC_TITLE_MAP = {"rst_rtos/0_ameba_product": "Products Center", "rst_rtos/0_ameba_product/0_ameba_product_center_index": "Products Center", "rst_rtos/0_ameba_sdk": "Ameba SDK", "rst_rtos/0_ameba_sdk/0_ameba_sdks_index": "Ameba SDK", "rst_rtos/0_ameba_solutions": "Ameba Solutions", "rst_rtos/0_ameba_solutions/0_ameba_solutions_index": "Ameba Solutions", "rst_rtos/0_at_command": "0.8 AT Commands", "rst_rtos/0_at_command/0_at_command_index": "0.8 AT Commands", "rst_rtos/0_build_system": "0.3 Build System", "rst_rtos/0_build_system/0_build_system_index": "0.3 Build System", "rst_rtos/0_file_system": "0.9 Virtual File System", "rst_rtos/0_file_system/0_vfs_index": "0.9 Virtual File System", "rst_rtos/0_ftl": "0.a Flash Translation Layer", "rst_rtos/0_ftl/0_ftl_index": "0.a Flash Translation Layer", "rst_rtos/0_gcc_build_environment": "0.1 GCC Build Environment", "rst_rtos/0_gcc_build_environment/0_gcc_build_index": "0.1 GCC Build Environment", "rst_rtos/0_gdb_debug": "0.2 GDB Debug", "rst_rtos/0_gdb_debug/0_gdb_debug_index": "0.2 GDB Debug", "rst_rtos/0_memory_layout": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_memory_layout/0_layout_index": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_sdk_example": "0.4 SDK Example", "rst_rtos/0_sdk_example/0_sdk_example_index": "0.4 SDK Example", "rst_rtos/0_tools": "0.7 Tools", "rst_rtos/0_tools/0_tools_index": "0.7 Tools", "rst_rtos/0_user_config": "0.6 User Config", "rst_rtos/0_user_config/0_usrcfg_index": "0.6 User Config", "rst_rtos/10_api_docs": "2.6 Wi-Fi API Reference", "rst_rtos/10_api_docs/0_api_index": "2.6 Wi-Fi API Reference", "rst_rtos/1_boot_process": "1.1 Boot Process", "rst_rtos/1_boot_process/0_boot_index": "1.1 Boot Process", "rst_rtos/1_chipen": "1.4 Chip Enable", "rst_rtos/1_chipen/0_chipen_index": "1.4 Chip Enable", "rst_rtos/1_gpio": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_gpio/0_gpio_index": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_ipc": "1.5 Inter Processor Communication", "rst_rtos/1_ipc/0_ipc_index": "1.5 Inter Processor Communication", "rst_rtos/1_mpu_cache": "1.0 Memory Management \u0026 Cache", "rst_rtos/1_mpu_cache/0_mpu_cache_index": "1.0 Memory Management \u0026 Cache", "rst_rtos/1_ota": "1.2 OTA", "rst_rtos/1_ota/0_ota_index": "1.2 OTA", "rst_rtos/1_otpc": "1.3 OTPC", "rst_rtos/1_otpc/0_otpc_index": "1.3 OTPC", "rst_rtos/1_pinmux": "1.6 Pin Multiplexing", "rst_rtos/1_pinmux/0_pinmux_index": "1.6 Pin Multiplexing", "rst_rtos/1_power_save": "1.9 Power Saving", "rst_rtos/1_power_save/0_ps_index": "1.9 Power Saving", "rst_rtos/2_whc_fullmac": "2.2 WHC FullMAC", "rst_rtos/2_whc_fullmac/0_fullmac_index": "2.2 WHC FullMAC", "rst_rtos/2_whc_wifi_bridge": "2.1 WHC Bridge", "rst_rtos/2_whc_wifi_bridge/0_wifi_bridge_index": "2.1 WHC Bridge", "rst_rtos/2_wifi_adaptivity_test": "2.5 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_adaptivity_test/0_wifi_adaptivity_index": "2.5 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_basic": "2.0 Wi-Fi Basic Mode", "rst_rtos/2_wifi_basic/0_wifi_basic_index": "2.0 Wi-Fi Basic Mode", "rst_rtos/2_wifi_csi": "2.4 Wi-Fi CSI", "rst_rtos/2_wifi_csi/0_wifi_csi_index": "2.4 Wi-Fi CSI", "rst_rtos/2_wifi_tunnel": "2.3 Wi-Fi R-Mesh", "rst_rtos/2_wifi_tunnel/0_wifi_tunnel_index": "2.3 Wi-Fi R-Mesh", "rst_rtos/3_ap_trustzone": "3.d AP Secure Service", "rst_rtos/3_ap_trustzone/0_ap_tz_index": "3.d AP Secure Service", "rst_rtos/3_crypto_engine": "3.9 Crypto Engine", "rst_rtos/3_crypto_engine/0_crypto_engine_index": "3.9 Crypto Engine", "rst_rtos/3_ecdsa_engine": "3.a ECDSA Engine", "rst_rtos/3_ecdsa_engine/0_ecdsa_index": "3.a ECDSA Engine", "rst_rtos/3_eddsa_engine": "3.b EDDSA Engine", "rst_rtos/3_eddsa_engine/0_eddsa_index": "3.b EDDSA Engine", "rst_rtos/3_rsa_engine": "3.c RSA Engine", "rst_rtos/3_rsa_engine/0_rsa_index": "3.c RSA Engine", "rst_rtos/3_security": "3.1 Security \u0026 Encryption", "rst_rtos/3_security/0_security_index": "3.1 Security \u0026 Encryption", "rst_rtos/3_trng": "3.2 True Random Number Generator", "rst_rtos/3_trng/0_trng_index": "3.2 True Random Number Generator", "rst_rtos/4_ai": "4.1 AI", "rst_rtos/4_ai/0_ai_index": "4.1 AI", "rst_rtos/4_ai_voice": "4.2 AIVoice", "rst_rtos/4_ai_voice/0_ai_voice_index": "4.2 AIVoice", "rst_rtos/4_dsp": "4.4 DSP", "rst_rtos/4_dsp/0_dsp_index": "4.4 DSP", "rst_rtos/4_multimedia": "4.3 Multimedia", "rst_rtos/4_multimedia/0_multimedia_index": "4.3 Multimedia", "rst_rtos/6_mass_production": "6.1 Mass Production", "rst_rtos/6_mass_production/0_mp_index": "6.1 Mass Production", "rst_rtos/6_mptools": "6.2 MP Tools", "rst_rtos/6_mptools/0_mptools_index": "6.2 MP Tools", "rst_rtos/7_usb": "7.1 USB Host \u0026 Device", "rst_rtos/7_usb/0_usb_index": "7.1 USB Host \u0026 Device", "rst_rtos/8_adc": "8.4 ADC", "rst_rtos/8_adc/0_adc_index": "8.4 ADC", "rst_rtos/8_cap_touch": "8.7 Cap-Touch", "rst_rtos/8_cap_touch/0_cap_touch_index": "8.7 Cap-Touch", "rst_rtos/8_dmac": "8.1 DMA Controller", "rst_rtos/8_dmac/0_dmac_index": "8.1 DMA Controller", "rst_rtos/8_ir": "8.5 IR", "rst_rtos/8_ir/0_ir_index": "8.5 IR", "rst_rtos/8_key_scan": "8.8 Key-Scan", "rst_rtos/8_key_scan/0_key_scan_index": "8.8 Key-Scan", "rst_rtos/8_lcdc": "8.a LCD Controller", "rst_rtos/8_lcdc/0_lcdc_index": "8.a LCD Controller", "rst_rtos/8_ledc": "8.6 LED Controller", "rst_rtos/8_ledc/0_ledc_index": "8.6 LED Controller", "rst_rtos/8_psram": "8.2 PSRAM", "rst_rtos/8_psram/0_psram_index": "8.2 PSRAM", "rst_rtos/8_rtc_io": "8.9 RTC-IO", "rst_rtos/8_rtc_io/0_rtc_io_index": "8.9 RTC-IO", "rst_rtos/8_thermal": "8.3 Thermal Meter", "rst_rtos/8_thermal/0_thermal_index": "8.3 Thermal Meter"};
console.log("TOC_TITLE_MAP:", TOC_TITLE_MAP);

// 获取当前页面的文档名 (例如 'rst_rtos/3_nda_secure_boot/0_secure_boot_index_nda')
const CURRENT_DOCNAME = 'rst_rtos/3_crypto_engine/1_crypto_engine_toprst';

// 动态查找顶级分类函数（定义为全局函数）
window.findTopLevelChapter = function(docname) {
    console.log("Attempting to find top-level chapter for:", docname);
    let bestMatch = "";
    let bestTitle = "Unknown Chapter";

    // 按路径长度降序排序以确保最长匹配
    const sortedPaths = Object.keys(TOC_TITLE_MAP).sort((a, b) => b.length - a.length);

    for (const path of sortedPaths) {
        console.log("Checking path:", path);
        if (docname === path || docname.startsWith(path + '/')) { // 子页面
            bestMatch = path;
            bestTitle = TOC_TITLE_MAP[path];
            console.log("Matched path:", path, "with title:", bestTitle);
            break;
        }
    }

    // 如果没有找到任何匹配项，则尝试更短的路径
    if (bestMatch === "") {
        const pathSegments = docname.split('/');
        while (pathSegments.length > 1) { // 至少保留根路径
            const candidate = pathSegments.join('/');
            console.log("Checking shorter path:", candidate);
            if (TOC_TITLE_MAP[candidate]) {
                bestTitle = TOC_TITLE_MAP[candidate];
                console.log("Matched shorter path:", candidate, "with title:", bestTitle);
                break;
            }
            pathSegments.pop();
        }
    }

    console.log("Final top-level chapter:", bestTitle);
    return bestTitle;
}

// 初始化时调用
document.addEventListener('DOMContentLoaded', function() {
    const topLevelChapter = findTopLevelChapter(CURRENT_DOCNAME);
    console.log("Top Level Chapter:", topLevelChapter);

    // 将顶级分类插入到DOM中（根据需要）
    const chapterElement = document.createElement('div');
    chapterElement.className = 'top-level-chapter';
    chapterElement.innerHTML = `<strong>Top Level Chapter: </strong>${topLevelChapter}`;
    document.body.appendChild(chapterElement);
});
</script>

    

    <!-- 左上角标题距离控制：Ameba IoT Docs -->
    <style>
        /* 新增的标题间距调整样式（添加在此处） */
        div[role="navigation"] > div[role="search"] {
            margin-bottom: 4px !important;
        }

        a.icon.icon-home {
            display: inline-block;
            margin-bottom: 2px !important;
        }
    </style>

    <!-- 引入功能模块 -->
    
    
<script>
    /* ====================== 嵌入式配置开始 ====================== */
    const embeddedConfig = {
        "freertos": {
            "name": "FreeRTOS",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        },
        "linux": {
            "name": "Linux",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        }
    };
    /* ====================== 嵌入式配置结束 ====================== */
</script>

<script>
    // 获取OS显示名称列表
    function getOSNames(data) {
        return Object.keys(data).map(key => data[key].name);
    }

    // 获取指定OS的语言列表
    function getLanguages(data, osKey) {
        return Object.keys(data[osKey]?.languages || {});
    }

    // 获取指定OS和语言的版本列表
    function getVersions(data, osKey, language) {
        return data[osKey]?.languages?.[language] || ['latest'];
    }

    // 根据显示名称查找OS键
    function findOSKey(data, displayName) {
        return Object.keys(data).find(key => data[key].name === displayName);
    }

    // 获取基础URL路径
    function getBaseURL() {
        const url = new URL(window.location.href);
        console.log('[DEBUG] getBaseURL:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const pathParts = url.pathname.split('/').filter(part => part !== '');
            const index = pathParts.indexOf('build');
            console.log('[DEBUG] getBaseURL0:', pathParts.slice(0, index + 1).join('/'));
            return `file://${pathParts.slice(0, index + 1).join('/')}/`;
        } else {
            // 网络路径处理
            const basePath = url.pathname.split('/')[1]; // 直接取第一个有效路径段
            console.log('[DEBUG] getBaseURL:', url.origin, basePath);
            return `${url.origin}/${basePath}/`;
        }
    }

    // 获取当前URL路径分段
    function getCurrentSegments() {
        const url = new URL(window.location.href);
        let segments = url.pathname.split('/').filter(segment => segment);


        console.log('[DEBUG] getCurrentSegments:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const index = segments.indexOf('build');
            segments = segments.slice(index + 1); // 去掉 build 及之前的路径
            console.log('[DEBUG] getCurrentSegments0:', segments);
        } else {
            // 网络路径处理
            segments = segments.slice(1); // 去掉 ameba-iot-docs/
            console.log('[DEBUG] getCurrentSegments:', segments);
        }

        return {
            osKey: segments[0] || 'freertos', // 默认为 freertos
            language: segments[1] || 'en',   // 默认为 en
            version: segments[2] || 'latest' // 默认为 latest
        };
    }

    // 绑定事件监听
    function bindEvents(baseURL, segments) {
        document.getElementById('os-selector').addEventListener('change', () => {
            const newOSKey = document.getElementById('os-selector').value;
            const availableLangs = getLanguages(embeddedConfig, newOSKey);
            const defaultLang = availableLangs[0] || 'en';
            const defaultVersion = getVersions(embeddedConfig, newOSKey, defaultLang)[0] || 'latest';
            console.log('OS Changed:', {newOSKey, defaultLang, defaultVersion});
            redirectTo(`${baseURL}${newOSKey}/${defaultLang}/${defaultVersion}/`);
        });

        document.getElementById('language-selector').addEventListener('change', () => {
            const newLang = document.getElementById('language-selector').value;
            const defaultVersion = getVersions(embeddedConfig, segments.osKey, newLang)[0] || 'latest';
            console.log('Language Changed:', {newLang, defaultVersion});
            redirectTo(`${baseURL}${segments.osKey}/${newLang}/${defaultVersion}/`);
        });

        document.getElementById('version-selector').addEventListener('change', () => {
            const newVer = document.getElementById('version-selector').value;
            console.log('Version Changed:', {newVer});
            redirectTo(`${baseURL}${segments.osKey}/${segments.language}/${newVer}/`);
        });
    }

    // 跳转函数
    function redirectTo(path) {
        const url = new URL(path, window.location.href);
        if (url.protocol === 'file:') {
            url.pathname += 'index.html';
        }
        console.log('Redirecting to:', url.href);
        window.location.href = url.href;
    }
</script>

<script>
    // 验证并修正路径参数
    function validateSegments(segments) {
        const currentOSName = embeddedConfig[segments.osKey]?.name;

        // 如果 OS 无效，默认设置为 FreeRTOS
        if (!currentOSName) {
            console.warn("Invalid OS key, defaulting to FreeRTOS");
            segments.osKey = 'freertos';
        }

        // 如果语言无效，默认设置为 en
        if (!getLanguages(embeddedConfig, segments.osKey).includes(segments.language)) {
            console.warn("Invalid language, defaulting to en");
            segments.language = 'en';
        }

        return segments;
    }

    // 设置初始选中值
    function setInitialValues(segments) {
        document.getElementById('os-selector').value = segments.osKey;
        document.getElementById('language-selector').value = segments.language;

        const versionSelector = document.getElementById('version-selector');
        const availableVersions = getVersions(embeddedConfig, segments.osKey, segments.language);
        versionSelector.value = availableVersions.includes(segments.version) ? segments.version : availableVersions[0] || 'latest';
    }
</script>

<style>
    .selectors-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr); /* 三列等宽 */
        gap: 4px;
        padding: 1px 1px;

        margin-top: var(--root-margin-top, 4px);
        margin-bottom: var(--root-margin-bottom, 0px);
    }

    .dual-selector-group {
        display: grid;
        grid-template-columns: 1fr 1fr; /* 两列等宽 */
        gap: 4px; /* 列间距 */
    }

    .selector-group {
        position: relative;
        width: 100%; /* 确保填满网格列 */
    }

    .selector-label {
        display: block;
        color: #a0b3c6;
        font-size: 0.85em;
        margin-bottom: 4px;
        padding-left: 4px;
    }

    .selector-dropdown {
        width: 100%;
        margin-top: var(--root-margin-top, 4px);
        margin-bottom: var(--root-margin-bottom, 0px);
        padding: 2px 2px;
        border: 2px white !important;
        border-radius: 6px !important;
        background: #627078 !important;
        color: white;
        font-size: 0.95em;
        transition: all 0.3s ease;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23a0b3c6'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
        display: flex;
        height: 30px;

        box-shadow: none !important; /* 不要边框阴影 */
        outline: none !important; /* 不要边框阴影 */
    }

    .selector-dropdown:hover {
        border-color: #4a6a8b;
        background-color: rgba(44, 62, 80, 1);
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .selector-dropdown:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
    }

    /* 移动端优化 */
    @media (max-width: 768px) {
        .selectors-grid {
            grid-template-columns: 1fr; /* 小屏幕下堆叠显示 */
            gap: 10px;
        }

        .selector-dropdown {
            padding: 10px 12px;
        }

        .dual-selector-group {
            grid-template-columns: 1fr; /* 小屏幕下堆叠显示 */
        }
    }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

    <!-- templates/sidebar_toggle.html -->


<div id="topleft-panel" style="display: block !important; padding: 0; background: none; border: none;"></div>


<div class="bottomleft-panel"></div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        try {
            const segments = validateSegments(getCurrentSegments());
            const baseURL = getBaseURL();

            // 渲染HTML
            document.getElementById('topleft-panel').innerHTML = `
<!-- templates/sidebar_user_panel_div.html -->


<!-- templates/sidebar_user_panel_div_docselect.html -->

<div class="selectors-grid">
    <!-- 系统选择器 -->
    <div class="selector-group">
        <select id="os-selector" class="selector-dropdown">
            ${Object.keys(embeddedConfig).map(key => `
                <option value="${key}">${embeddedConfig[key].name}</option>
            `).join('')}
        </select>
    </div>

    <!-- 语言选择器 -->
    <div class="selector-group">
        <select id="language-selector" class="selector-dropdown">
            ${getLanguages(embeddedConfig, segments.osKey).map(lang => `
                <option value="${lang}">${lang === 'en' ? 'en' : 'cn'}</option>
            `).join('')}
        </select>
    </div>

    <!-- 版本选择器 -->
    <div class="selector-group">
        <select id="version-selector" class="selector-dropdown">
            ${getVersions(embeddedConfig, segments.osKey, segments.language).map(ver => `
                <option value="${ver}">${ver}</option>
            `).join('')}
        </select>
    </div>
</div>

<div class="user-panel-container">
    <div class="user-panel">
        

    </div>
</div>`;

            // 设置初始值
            setInitialValues(segments);

            // 绑定事件
            bindEvents(baseURL, segments);

            // 将 user-panel 移动到 bottomleft-panel 内
            const userPanel = document.querySelector('.user-panel');
            const bottomleftPanel = document.querySelector('.bottomleft-panel');
            if (userPanel && bottomleftPanel) {
                bottomleftPanel.appendChild(userPanel); // 直接添加为子元素
            }
        } catch (error) {
            console.error("Error initializing selectors:", error);
        }
    });
</script>

<style>
    #topleft-panel {
        background: rgba(40, 58, 73, 0.9);
        border-radius: 4px;
        padding: 4px;
        margin: 4px 0;
        box-shadow: 0 4px 4px rgba(0,0,0,0.15);
        backdrop-filter: blur(4px);
    }

    /* 移动端优化 */
    @media (max-width: 768px) {
        #topleft-panel {
            margin: 8px 0;
            padding: 10px;
        }
    }
</style>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_product/0_ameba_product_center_index.html">Products Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_sdk/0_ameba_sdks_index.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_solutions/0_ameba_solutions_index.html">Ameba Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index.html">0.1 GCC Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gdb_debug/0_gdb_debug_index.html">0.2 GDB Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_build_system/0_build_system_index.html">0.3 Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_example/0_sdk_example_index.html">0.4 SDK Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_memory_layout/0_layout_index.html">0.5 Flash &amp; RAM Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_user_config/0_usrcfg_index.html">0.6 User Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_tools/0_tools_index.html">0.7 Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_at_command/0_at_command_index.html">0.8 AT Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_file_system/0_vfs_index.html">0.9 Virtual File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ftl/0_ftl_index.html">0.a Flash Translation Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_mpu_cache/0_mpu_cache_index.html">1.0 Memory Management &amp; Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index.html">1.1 Boot Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index.html">1.2 OTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_otpc/0_otpc_index.html">1.3 OTPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_chipen/0_chipen_index.html">1.4 Chip Enable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ipc/0_ipc_index.html">1.5 Inter Processor Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_pinmux/0_pinmux_index.html">1.6 Pin Multiplexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index.html">1.7 GPIO &amp; Pin Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index.html">1.9 Power Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_basic/0_wifi_basic_index.html">2.0 Wi-Fi Basic Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_wifi_bridge/0_wifi_bridge_index.html">2.1 WHC Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_fullmac/0_fullmac_index.html">2.2 WHC FullMAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_tunnel/0_wifi_tunnel_index.html">2.3 Wi-Fi R-Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_csi/0_wifi_csi_index.html">2.4 Wi-Fi CSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_adaptivity_test/0_wifi_adaptivity_index.html">2.5 Wi-Fi Adaptivity Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_api_docs/0_api_index.html">2.6 Wi-Fi API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_security/0_security_index.html">3.1 Security &amp; Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_trng/0_trng_index.html">3.2 True Random Number Generator</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_crypto_engine_index.html">3.9 Crypto Engine</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Supported ICs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#otp-keys-for-crypto">OTP Keys for Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="#crypto-key-order">Crypto Key Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="#crypto-key-flash-procedure">Crypto Key Flash Procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initializing-hardware-crypto-engine">Initializing Hardware Crypto Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-auto-loaded-otp-key-from-otp">Using Auto-loaded OTP Key from OTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#starting-crypto-engine-calculation">Starting Crypto Engine Calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hash-algorithm">Hash Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cipher-algorithm">Cipher Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#demo-code">Demo Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3_ecdsa_engine/0_ecdsa_index.html">3.a ECDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_eddsa_engine/0_eddsa_index.html">3.b EDDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_rsa_engine/0_rsa_index.html">3.c RSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ap_trustzone/0_ap_tz_index.html">3.d AP Secure Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai/0_ai_index.html">4.1 AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai_voice/0_ai_voice_index.html">4.2 AIVoice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index.html">4.3 Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_dsp/0_dsp_index.html">4.4 DSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mass_production/0_mp_index.html">6.1 Mass Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mptools/0_mptools_index.html">6.2 MP Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index.html">7.1 USB Host &amp; Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index.html">8.1 DMA Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_psram/0_psram_index.html">8.2 PSRAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index.html">8.3 Thermal Meter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index.html">8.4 ADC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index.html">8.5 IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ledc/0_ledc_index.html">8.6 LED Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_cap_touch/0_cap_touch_index.html">8.7 Cap-Touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_key_scan/0_key_scan_index.html">8.8 Key-Scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc_io/0_rtc_io_index.html">8.9 RTC-IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index.html">8.a LCD Controller</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">
    
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_crypto_engine_index.html">Hardware Crypto Engine</a></li>
      <li class="breadcrumb-item active">Supported ICs</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="hardware-crypto-engine"></span><!-- 下拉菜单 -->
<div style="margin: 20px 0; text-align: left;">
    <div style="display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 14px;">IC: </span>
        <select class="tab-selector" style="height: 22px; padding: 2px 8px; font-size: 13px;">
            <option value="RTL8721Dx">RTL8721Dx</option>
            <option value="RTL8720E">RTL8720E</option>
            <option value="RTL8726E">RTL8726E</option>
            <option value="RTL8730E">RTL8730E</option>
        </select>
    </div>
</div>

<!-- 修复后的 JavaScript -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const selector = document.querySelector('.tab-selector');

    selector.addEventListener('change', function() {
        const targetTab = this.value;
        const tabs = document.querySelectorAll('.sphinx-tabs-tab');
        let found = false;

        tabs.forEach(tab => {
            const tabText = tab.textContent.trim();
            if (tabText === targetTab) {
                tab.click();
                window.dispatchEvent(new Event('resize')); // 触发插件更新
                found = true;
            }
        });

        if (!found) {
            console.error("未找到选项卡:", targetTab);
        }
    });
});
</script><section id="supported-ics">
<h1>Supported ICs<a class="headerlink" href="#supported-ics" title="Link to this heading"></a></h1>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>IC</p></th>
<th class="head"><p>RTL8721Dx</p></th>
<th class="head"><p>RTL8726E</p></th>
<th class="head"><p>RTL8720E</p></th>
<th class="head"><p>RTL8730E</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Supported</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
</tr>
</tbody>
</table>
</section>
<section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<p>The Hardware Crypto Engine (also called IPsec) accelerates applications that need cryptographic functions, such as authentication, encryption and decryption.
Hardware crypto engine executing these functions cannot only reduce software overhead but also save CPU and memory resources, and the processing of it is more secure and faster than software. The key pair can be passed in by software or automatically loaded from OTP by hardware without software access the key.</p>
<section id="otp-keys-for-crypto">
<h2>OTP Keys for Crypto<a class="headerlink" href="#otp-keys-for-crypto" title="Link to this heading"></a></h2>
<p>Crypto engine loads the secret key in two ways: one is that the user passes the secret key into the engine (software accessible key), the other way is that Crypto automatically loads keys from OTP (software inaccessible key).</p>
<p>OTP physical map can store six keys for Crypto to use as secret keys, which can only be accessed by crypto engine and will not be tampered with or read by attackers.
The premise is that the secret key needs to be programmed into OTP physical map.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-0-0-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-3" name="0-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>Among these six keys, there are two secure keys and two non-secure keys available for SHA HAMC to choose from, and four secure keys and non-secure keys available for AES to choose from. Refer to the table below for specific information.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/opt_keys_for_crypto_rtl8721d.svg"><img alt="../../_images/opt_keys_for_crypto_rtl8721d.svg" height="702" src="../../_images/opt_keys_for_crypto_rtl8721d.svg" width="1246" /></a>
</figure>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Engine</p></th>
<th class="head"><p>Engine type</p></th>
<th class="head"><p>Key index</p></th>
<th class="head"><p>OTP key</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SHA HAMC</p></td>
<td><p>Secure</p></td>
<td><p>0</p></td>
<td><p>S_IPSEC_Key1</p></td>
</tr>
<tr class="row-odd"><td><p>SHA HAMC</p></td>
<td><p>Secure</p></td>
<td><p>1</p></td>
<td><p>S_IPSEC_Key2</p></td>
</tr>
<tr class="row-even"><td><p>SHA HAMC</p></td>
<td><p>Non-Secure</p></td>
<td><p>0</p></td>
<td><p>NS_IPSEC_Key1</p></td>
</tr>
<tr class="row-odd"><td><p>SHA HAMC</p></td>
<td><p>Non-Secure</p></td>
<td><p>1</p></td>
<td><p>NS_IPSEC_Key2</p></td>
</tr>
<tr class="row-even"><td><p>AES</p></td>
<td><p>Secure</p></td>
<td><p>0</p></td>
<td><p>S_IPSEC_Key1</p></td>
</tr>
<tr class="row-odd"><td><p>AES</p></td>
<td><p>Secure</p></td>
<td><p>1</p></td>
<td><p>S_IPSEC_Key2</p></td>
</tr>
<tr class="row-even"><td><p>AES</p></td>
<td><p>Secure</p></td>
<td><p>2</p></td>
<td><p>RSIP_AES_key1</p></td>
</tr>
<tr class="row-odd"><td><p>AES</p></td>
<td><p>Secure</p></td>
<td><p>3</p></td>
<td><p>RSIP_AES_key2</p></td>
</tr>
<tr class="row-even"><td><p>AES</p></td>
<td><p>Non-Secure</p></td>
<td><p>0</p></td>
<td><p>NS_IPSEC_Key1</p></td>
</tr>
<tr class="row-odd"><td><p>AES</p></td>
<td><p>Non-Secure</p></td>
<td><p>1</p></td>
<td><p>NS_IPSEC_Key2</p></td>
</tr>
<tr class="row-even"><td><p>AES</p></td>
<td><p>Non-Secure</p></td>
<td><p>2</p></td>
<td><p>RSIP_AES_key1</p></td>
</tr>
<tr class="row-odd"><td><p>AES</p></td>
<td></td>
<td><p>3</p></td>
<td><p>RSIP_AES_key2</p></td>
</tr>
</tbody>
</table>
<p>The detailed functions of OTP key are as follows:</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>OTP key name</p></th>
<th class="head"><p>Address</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>Logic Map 0x200</p></td>
<td><p>32 bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td><p>Secure crypto engine will auto-load this key for HAMC or AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>Logic Map 0x220</p></td>
<td><p>32 bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td><p>Secure crypto engine will auto-load this key for HAMC or AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1</p></td>
<td><p>Logic Map 0x240</p></td>
<td><p>32 bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td><p>Non-Secure crypto engine will auto-load this key for HAMC or AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2</p></td>
<td><p>Logic Map 0x260</p></td>
<td><p>32 bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td><p>Non-Secure crypto engine will auto-load this key for HAMC or AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_key1</p></td>
<td><p>Logic Map 0x2c0</p></td>
<td><p>32 bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td><p>Non-Secure AES engine and secure AES engine will auto-load this key for AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_key2</p></td>
<td><p>Logic Map 0x2e0</p></td>
<td><p>32 bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td><p>Non-Secure AES engine and secure AES engine will auto-load this key for AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[3]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key1 to prevent from being read out.</p>
<p>1: Disable read protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x365[4]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key1 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x365[5]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key2 to prevent from being read out.</p>
<p>1: Disable read protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x365[6]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key2 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key1 to prevent from being read out.</p>
<p>1: Disable read protection for NS_SHA_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x366[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key1 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x366[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key2 to prevent from being read out.</p>
<p>1: Disable read protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x366[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key2 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x366[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key1 to prevent from being read out.</p>
<p>1: Disable read protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x367[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key1 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x367[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key2 to prevent from being read out.</p>
<p>1: Disable read protection for RSIP_AES_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x367[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key2 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key2.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For the two secure keys of IPsec, if the system enables RDP, SDK will use <code class="docutils literal notranslate"><span class="pre">S_IPSEC_Key1</span></code> for secure data protection by default. And if sboot uses HMAC as hash algorithm, it will use <code class="docutils literal notranslate"><span class="pre">S_IPSEC_Key2</span></code>.</p></li>
<li><p>Users need to reasonably allocate the use of keys according to the above contents. For more information, refer to <span class="xref std std-ref">Secure Boot</span> and <span class="xref std std-ref">Read Protection</span>.</p></li>
</ul>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>OTP KEY name</p></th>
<th class="head"><p>Address</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>Logic Map 0x200</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td rowspan="2"><p>Secure crypto engine will auto-load this key for HAMC or AES function</p>
<p>when OTPKey_init function is enabled.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>Logic Map 0x220</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1</p></td>
<td><p>Logic Map 0x240</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td rowspan="2"><p>Non-secure crypto engine will auto-load this key for HAMC function</p>
<p>when OTPKey_init function is enabled.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2</p></td>
<td><p>Logic Map 0x260</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_key1</p></td>
<td><p>Logic Map 0x2c0</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td rowspan="2"><p>Non-secure AES engine and secure AES engine will auto-load this key</p>
<p>for AES function when OTPKey_init function is enabled.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_key2</p></td>
<td><p>Logic Map 0x2e0</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[3]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key1 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key1 Write</p></td>
<td><p>Physical Map 0x365[4]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key1 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x365[5]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key2 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x365[6]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key2 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key1 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for NS_SHA_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x366[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key1 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x366[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key2 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x366[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key2 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x366[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key1 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x367[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key1 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x367[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key2 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for RSIP_AES_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x367[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key2 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key2.</p>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>OTP KEY name</p></th>
<th class="head"><p>Address</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>Logic Map 0x200</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td rowspan="2"><p>Secure crypto engine will auto-load this key for HAMC or AES function</p>
<p>when OTPKey_init function is enabled.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>Logic Map 0x220</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1</p></td>
<td><p>Logic Map 0x240</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td rowspan="2"><p>Non-secure crypto engine will auto-load this key for HAMC function</p>
<p>when OTPKey_init function is enabled.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2</p></td>
<td><p>Logic Map 0x260</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_key1</p></td>
<td><p>Logic Map 0x2c0</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
<td rowspan="2"><p>Non-secure AES engine and secure AES engine will auto-load this key</p>
<p>for AES function when OTPKey_init function is enabled.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_key2</p></td>
<td><p>Logic Map 0x2e0</p></td>
<td><p>32bytes</p></td>
<td><p>Each Byte 0xFF</p></td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[3]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key1 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key1 Write</p></td>
<td><p>Physical Map 0x365[4]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key1 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x365[5]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key2 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x365[6]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key2 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key1 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for NS_SHA_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x366[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key1 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x366[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key2 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x366[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key2 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x366[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key1 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x367[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key1 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x367[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key2 to prevent from being</p>
<p>read out.</p>
<p>1: Disable read protection for RSIP_AES_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x367[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key2 to prevent from being</p>
<p>programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key2.</p>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-3" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-3" name="0-3" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>OTP KEY name</p></th>
<th class="head"><p>Address</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>Logic Map 0x200</p></td>
<td><p>32 bytes</p></td>
<td><p>Each byte 0xFF</p></td>
<td><p>Secure crypto engine will auto-load this key for HAMC or AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>Logic Map 0x220</p></td>
<td><p>32 bytes</p></td>
<td><p>Each byte 0xFF</p></td>
<td><p>Secure crypto engine will auto-load this key for HAMC or AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1</p></td>
<td><p>Logic Map 0x240</p></td>
<td><p>32 bytes</p></td>
<td><p>Each byte 0xFF</p></td>
<td><p>Non secure crypto engine will auto-load this key for HAMC function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2</p></td>
<td><p>Logic Map 0x260</p></td>
<td><p>32 bytes</p></td>
<td><p>Each byte 0xFF</p></td>
<td><p>Non secure crypto engine will auto-load this key for HAMC function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_key1</p></td>
<td><p>Logic Map 0x2C0</p></td>
<td><p>32 bytes</p></td>
<td><p>Each byte 0xFF</p></td>
<td><p>Non secure AES engine and secure AES engine will auto-load this key for AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_key2</p></td>
<td><p>Logic Map 0x2E0</p></td>
<td><p>32 bytes</p></td>
<td><p>Each byte 0xFF</p></td>
<td><p>Non secure AES engine and secure AES engine will auto-load this key for AES function when OTPKey_init function is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[3]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key1 to prevent from being read out.</p>
<p>1: Disable read protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x365[4]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key1 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>S_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x365[5]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for S_IPSEC_Key2 to prevent from being read out.</p>
<p>1: Disable read protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x365[6]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for S_IPSEC_Key2 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for S_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x365[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key1 to prevent from being read out.</p>
<p>1: Disable read protection for NS_SHA_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x366[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key1 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x366[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for NS_IPSEC_Key2 to prevent from being read out.</p>
<p>1: Disable read protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x366[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for NS_IPSEC_Key2 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for NS_IPSEC_Key2.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key1_Read_Protection</p></td>
<td><p>Physical Map 0x366[7]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key1 to prevent from being read out.</p>
<p>1: Disable read protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key1_Write_Protection</p></td>
<td><p>Physical Map 0x367[0]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key1 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key1.</p>
</td>
</tr>
<tr class="row-even"><td><p>RSIP_AES_Key2_Read_Protection</p></td>
<td><p>Physical Map 0x367[1]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable read protection for RSIP_AES_Key2 to prevent from being read out.</p>
<p>1: Disable read protection for RSIP_AES_Key2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>RSIP_AES_Key2_Write_Protection</p></td>
<td><p>Physical Map 0x367[2]</p></td>
<td><p>1 bit</p></td>
<td><p>1</p></td>
<td><p>0: Enable write protection for RSIP_AES_Key2 to prevent from being programmed to all 0 by hacker.</p>
<p>1: Disable write protection for RSIP_AES_Key2.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For the two secure keys of IPsec, if the system enables RDP, SDK will use <code class="docutils literal notranslate"><span class="pre">S_IPSEC_Key1</span></code> for secure data protection by default. And if secure boot uses HMAC as a hash algorithm, it will use <code class="docutils literal notranslate"><span class="pre">S_IPSEC_Key2</span></code>.</p></li>
<li><p>Users need to reasonably allocate the use of keys according to the above contents. For more information, refer to refer to <span class="xref std std-ref">Secure Boot</span> and <span class="xref std std-ref">Read Protection</span>.</p></li>
</ul>
</div>
</div></div>
</section>
<section id="crypto-key-order">
<h2>Crypto Key Order<a class="headerlink" href="#crypto-key-order" title="Link to this heading"></a></h2>
<p>The key order for Crypto Engine is the same with mbedtls, it uses little endian mode. For example, if the key is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mh">0x0123456789abcdef0123456789abcdef00112233445566778899aabbccddeeff</span>
</pre></div>
</div>
<p>When the key is put in an array and pass to HW engine using RTK API or mbedtls API, the array should like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span> <span class="n">key1</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span><span class="o">=</span><span class="p">{</span>
<span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x01</span>
<span class="p">};</span>
</pre></div>
</div>
<p>When program the key into OTP, customer should use the following commands, Take NS_SHA_key2 as an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span> <span class="n">wraw</span> <span class="mh">0x260</span> <span class="mi">20</span> <span class="n">ffeeddccbbaa99887766554433221100efcdab8967452301efcdab8967452301</span>
</pre></div>
</div>
<p>The contents in OTP is:</p>
<table class="docutils align-default" style="width: 100%">
<tbody>
<tr class="row-odd"><td><p>0x260</p></td>
<td><p>ff</p></td>
<td><p>ee</p></td>
<td><p>dd</p></td>
<td><p>cc</p></td>
<td><p>bb</p></td>
<td><p>aa</p></td>
<td><p>99</p></td>
<td><p>88</p></td>
<td><p>77</p></td>
<td><p>66</p></td>
<td><p>55</p></td>
<td><p>44</p></td>
<td><p>33</p></td>
<td><p>22</p></td>
<td><p>11</p></td>
<td><p>00</p></td>
</tr>
<tr class="row-even"><td><p>0x270</p></td>
<td><p>ef</p></td>
<td><p>cd</p></td>
<td><p>ab</p></td>
<td><p>89</p></td>
<td><p>67</p></td>
<td><p>45</p></td>
<td><p>23</p></td>
<td><p>01</p></td>
<td><p>ef</p></td>
<td><p>cd</p></td>
<td><p>ab</p></td>
<td><p>89</p></td>
<td><p>67</p></td>
<td><p>45</p></td>
<td><p>23</p></td>
<td><p>01</p></td>
</tr>
</tbody>
</table>
</section>
<section id="crypto-key-flash-procedure">
<h2>Crypto Key Flash Procedure<a class="headerlink" href="#crypto-key-flash-procedure" title="Link to this heading"></a></h2>
<p>The process of programming OTP physical map is as follows:</p>
<ol class="arabic">
<li><p>Generate the key.</p></li>
<li><p>Write into OTP physical map by the command <code class="docutils literal notranslate"><span class="pre">efuse</span> <span class="pre">wraw</span> <span class="pre">&lt;address&gt;</span> <span class="pre">&lt;length&gt;</span> <span class="pre">&lt;data&gt;</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span> <span class="n">wraw</span> <span class="mh">0x260</span> <span class="mi">20</span> <span class="mi">0123456789</span><span class="n">abcdef0123456789abcdef00112233445566778899aabbccddeeff</span>
</pre></div>
</div>
</li>
<li><p>Use the command <code class="docutils literal notranslate"><span class="pre">efuse</span> <span class="pre">rraw</span></code> to read OTP key back to check if it is written correctly. If not, re-write it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span> <span class="n">rraw</span>
</pre></div>
</div>
</li>
<li><p>Enable Key Read Protection and Write Protection to prevent key exposure and tampering after the written IPSEC Key is confirmed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span> <span class="n">wraw</span> <span class="mh">0x366</span> <span class="mi">1</span> <span class="n">f9</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After read protection and write protection are programmed, the key can never be read out again. Please maintain the key pair carefully.</p>
</div>
</section>
</section>
<section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h1>
<section id="initializing-hardware-crypto-engine">
<h2>Initializing Hardware Crypto Engine<a class="headerlink" href="#initializing-hardware-crypto-engine" title="Link to this heading"></a></h2>
<p>Call initialization APIs to initialize the engine before using and any calculation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The power of the engine will be turn off when the system enters low power status, so the settings will be rested .A new round initialization is suggested during resume.</p>
</div>
</section>
<section id="using-auto-loaded-otp-key-from-otp">
<h2>Using Auto-loaded OTP Key from OTP<a class="headerlink" href="#using-auto-loaded-otp-key-from-otp" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Initialize AES OTP key function:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CRYPTO_OTPKey_Init</span><span class="p">(</span><span class="n">keynum</span><span class="p">,</span><span class="w"> </span><span class="n">ENABLE</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Initialize HMAC OTP key function:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CRYPTO_OTPKey_SHA_Init</span><span class="p">(</span><span class="n">keynum</span><span class="p">,</span><span class="w"> </span><span class="n">ENABLE</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="starting-crypto-engine-calculation">
<h2>Starting Crypto Engine Calculation<a class="headerlink" href="#starting-crypto-engine-calculation" title="Link to this heading"></a></h2>
<p>Choose a hash or cipher algorithm, and call the following APIs to calculate the hash digest or cipher text.</p>
<section id="hash-algorithm">
<h3>Hash Algorithm<a class="headerlink" href="#hash-algorithm" title="Link to this heading"></a></h3>
<p>If a hash algorithm is selected, and the message length doesn’t exceed 245745 (=15 * (214 -1)) bytes, Hash APIs <code class="docutils literal notranslate"><span class="pre">rtl_crypto_xxx</span></code> can be used to calculate the digest.</p>
<p>If the message length exceeds 245745 bytes or you want to divide this message into many particular size blocks to process them, you could use <code class="docutils literal notranslate"><span class="pre">Sequential</span> <span class="pre">Hash</span> <span class="pre">Mechanism</span></code> to verify the hash function.</p>
<p>Sequential hash breaks a whole long message into several piece of message payload, then calculate the payload in sequence, until the last message payload.</p>
<p>When using sequential hash, follow the steps below:</p>
<ol class="arabic simple">
<li><p>Initialize sequential hash: use Hash APIs <code class="docutils literal notranslate"><span class="pre">rtl_crypto_xxx_init</span></code> to initialize.</p></li>
<li><p>Handle each piece of message payload: call Hash APIs <code class="docutils literal notranslate"><span class="pre">rtl_crypto_xxx_update</span></code> once when one piece message payload.</p></li>
<li><p>Handle the last piece of message payload: call Hash APIs <code class="docutils literal notranslate"><span class="pre">rtl_crypto_xxx_final</span></code> once when one piece message payload.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>Considering that the crypto engine moves data through DMA and bypasses the D-Cache, if the destination array is placed in stack and the start address is not 32-byte aligned, the cache line would be dirty during function call in some cases. To avoid reading wrong digest back, users should choose one of the following methods:</p>
<ul class="simple">
<li><p>The digest array is a global variable.</p></li>
<li><p>Or the start address of digest array should be 32-byte aligned if it’s a local variable.</p></li>
<li><p>Or call the following line to restore data from memory before reading digest when calculation is finished if it’s a local variable.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">DCache_Invalidate</span><span class="p">(((</span><span class="n">u32</span><span class="p">)</span><span class="n">digest</span><span class="o">&amp;</span><span class="n">CACHE_LINE_ADDR_MSK</span><span class="p">),(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">digest</span><span class="p">)</span><span class="o">+</span><span class="n">CACHE_LINE_SIZE</span><span class="p">));</span>
</pre></div>
</div>
</li>
<li><p>After Application Core (like KM4) power gating, IPsec needs to be initialized again to work normally.</p></li>
<li><p>To prevent errors caused by multi-core access to crypto simultaneously, a lock is added before <code class="docutils literal notranslate"><span class="pre">CRYPTO_OTPKey_Init</span></code>, and the lock is released after crypto calculation.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*take sema to obtain the right to crypto engine*/</span>
<span class="p">{</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">IPC_SEMTake</span><span class="p">(</span><span class="n">IPC_SEM_CRYPTO</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_TRUE</span><span class="p">);</span>
<span class="n">CRYPTO_OTPKey_SHA_Init</span><span class="p">(</span><span class="n">keynum</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="n">rtl_crypto_hmac_sha2_update</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">IN</span><span class="w"> </span><span class="n">u32</span><span class="w"> </span><span class="n">msglen</span><span class="p">,</span><span class="w"> </span><span class="n">hw_sha_context</span><span class="w"> </span><span class="o">*</span><span class="n">ctx</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">rtl_crypto_hmac_sha2_final</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">pDigest</span><span class="p">,</span><span class="w"> </span><span class="n">hw_sha_context</span><span class="w"> </span><span class="o">*</span><span class="n">ctx</span><span class="p">);</span>

<span class="cm">/*free sema to release the right to crypto engine*/</span>
<span class="n">IPC_SEMFree</span><span class="p">(</span><span class="n">IPC_SEM_CRYPTO</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</div>
</section>
<section id="cipher-algorithm">
<h3>Cipher Algorithm<a class="headerlink" href="#cipher-algorithm" title="Link to this heading"></a></h3>
<p>Steps to encrypt or decrypt message are as follows:</p>
<ol class="arabic simple">
<li><p>Call Cipher APIs <code class="docutils literal notranslate"><span class="pre">rtl_crypto_aes_xxx_init</span></code> to initialize</p></li>
<li><p>Encrypt or decrypt the message</p>
<ul class="simple">
<li><p>Call Cipher APIs <code class="docutils literal notranslate"><span class="pre">rtl_crypto_aes_xxx_encrypt</span></code> to encrypt source message.</p></li>
<li><p>Call Cipher APIs <code class="docutils literal notranslate"><span class="pre">rtl_crypto_aes_xxx_decrypt</span></code> to decrypt source message.</p></li>
</ul>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To prevent errors caused by multi-core access to crypto simultaneously, a lock is added before <code class="docutils literal notranslate"><span class="pre">CRYPTO_OTPKey_Init</span></code>, and the lock is released after <code class="docutils literal notranslate"><span class="pre">rtl_crypto_aes_xxx_encrypt</span></code> or <code class="docutils literal notranslate"><span class="pre">rtl_crypto_aes_xxx_decrypt</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*take sema to obtain the right to crypto engine*/</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">IPC_SEMTake</span><span class="p">(</span><span class="n">IPC_SEM_CRYPTO</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_TRUE</span><span class="p">);</span>
<span class="n">CRYPTO_OTPKey_Init</span><span class="p">(</span><span class="n">keynum</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="n">rtl_crypto_aes_xxx_encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">msglen</span><span class="p">,</span><span class="w"> </span><span class="n">pIv</span><span class="p">,</span><span class="w"> </span><span class="n">ivlen</span><span class="p">,</span><span class="w"> </span><span class="n">pResult</span><span class="p">);</span>
<span class="cm">/*free sema to release the right to crypto engine*/</span>
<span class="n">IPC_SEMFree</span><span class="p">(</span><span class="n">IPC_SEM_CRYPTO</span><span class="p">);</span>
<span class="cm">/*take sema to obtain the right to crypto engine*/</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">IPC_SEMTake</span><span class="p">(</span><span class="n">IPC_SEM_CRYPTO</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_TRUE</span><span class="p">);</span>
<span class="w">   </span><span class="n">CRYPTO_OTPKey_Init</span><span class="p">(</span><span class="n">keynum</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="w">   </span><span class="n">rtl_crypto_aes_xxx_decrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">msglen</span><span class="p">,</span><span class="w"> </span><span class="n">pIv</span><span class="p">,</span><span class="w"> </span><span class="n">ivlen</span><span class="p">,</span><span class="w"> </span><span class="n">pResult</span><span class="p">);</span>
<span class="cm">/*free sema to release the right to crypto engine*/</span>
<span class="n">IPC_SEMFree</span><span class="p">(</span><span class="n">IPC_SEM_CRYPTO</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="demo-code">
<h1>Demo Code<a class="headerlink" href="#demo-code" title="Link to this heading"></a></h1>
<p>The demo code of hardware crypto engine locates at  <code class="docutils literal notranslate"><span class="pre">{SDK}\component\example\peripheral\raw\Crypto</span></code> .</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="0_crypto_engine_index.html" class="btn btn-neutral float-left" title="Hardware Crypto Engine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../3_ecdsa_engine/0_ecdsa_index.html" class="btn btn-neutral float-right" title="ECDSA Engine" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Realsil.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>

    <!-- 问题反馈按钮和对话框 -->
    

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
     

    <!-- templates/sidebar_toggle.html -->

<button id="sidebar-toggle-button" aria-label="Toggle sidebar"></button>

<script>
    function sidebarToggleButton() {
        const sidebar = document.querySelector('.wy-nav-side');
        const contentArea = document.querySelector('.wy-nav-content');
        const contentAreaWrap = document.querySelector('.wy-nav-content-wrap');
        const sidebarToggleButton = document.getElementById('sidebar-toggle-button');

        console.log('Sidebar:', sidebar);
        console.log('Content Area:', contentArea);
        console.log('Toggle Button:', sidebarToggleButton);

        if (!sidebar || !contentArea || !sidebarToggleButton) {
            console.error('One or more elements not found');
            return;
        }

        let isSidebarCollapsed = false;

        sidebarToggleButton.addEventListener('click', function() {
            document.documentElement.classList.add('sidebar-transitioning');// 添加过渡类

            if (isSidebarCollapsed) {
                document.documentElement.classList.remove('sidebar-collapsed'); // 改为使用CSS类控制

                sidebar.style.marginLeft = '0px';
                contentAreaWrap.style.marginLeft = '300px';
                contentArea.classList.remove('expanded');

                sidebarToggleButton.style.left = '300px';
            } else {
                document.documentElement.classList.add('sidebar-collapsed');

                sidebar.style.marginLeft = '-300px';
                contentAreaWrap.style.marginLeft = '0px';
                contentArea.classList.add('expanded');

                sidebarToggleButton.style.left = '0px';
            }

            // 同步状态
            isSidebarCollapsed = !isSidebarCollapsed;

            // 过渡结束后移除标记
            setTimeout(() => {
                document.documentElement.classList.remove('sidebar-transitioning');
            }, 300); // 必须与过渡时间匹配
        });
    }
</script>

<style>
    #sidebar-toggle-button {
        position: fixed;
        left: 300px;
        top: 0;
        z-index: 1002;

        width: 4px;  /* 竖线宽度 */
        /* 增加热区 */
        padding: 0 15px; /* 左右各扩展12px点击区域 */
        margin: 0 -15px; /* 抵消padding带来的位置偏移 */
        clip-path: inset(0 -15px); /* 保持视觉宽度4px */

        height: 100vh; /* 竖线高度 */
        background: #2d2d2d;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: none;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);

        /* 隐藏原始文字 */
        color: transparent;
        font-size: 0;

        /* 修正交互区域 */
        padding: 0;
        margin: 0;

        /* 新增：防止内容溢出 */
        overflow: visible;

        /* 调整箭头定位 */
        &::before {
            top: 50vh; /* 改为视口中点定位 */
            transform: translateY(-50%);
        }

        &::after {
            top: 50vh;
            transform: translateY(-50%) rotate(45deg);
        }
    }

    /* 动态箭头指示器 */
    #sidebar-toggle-button::before {
        content: '‹';
        position: absolute;
        left: 6px;
        top: 50%;
        width: 24px;
        height: 24px;
        background: #3498db;
        color: white;
        font-size: 18px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transform: translateY(-50%);
        opacity: 0;
        transition: all 0.3s ease;
        pointer-events: none;
    }

    #sidebar-toggle-button::after {
        content: '';
        position: absolute;

        left: -15px;  /* 向左扩展12px */
        right: -15px; /* 向右扩展12px */

        top: 50%;
        width: 8px;
        height: 8px;
        border: 2px solid white;
        border-width: 2px 2px 0 0;
        transform: translateY(-50%) rotate(45deg);
        opacity: 0;
        transition: all 0.3s ease;
    }

    /* 悬停效果 */
    #sidebar-toggle-button:hover {
        width: 10px;
        background: #2980b9;
    }

    /* 点击动画 */
    #sidebar-toggle-button:active {
        transform: translateY(-50%) scale(0.9);
    }
</style>

<!-- 统一移动速度 -->
<style>
    /* 统一过渡参数 */
    :root {
        --sidebar-transition: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .wy-nav-side,
    .wy-nav-content-wrap,
    #sidebar-toggle-button {
        transition: all var(--sidebar-transition) !important;
    }

    /* 按钮样式调整 */
    #sidebar-toggle-button {
        left: 300px;
        transition: left var(--sidebar-transition),
                    width 150ms ease, /* 悬停效果保持独立 */
                    background 150ms ease;
    }

    /* 折叠状态 */
    .sidebar-collapsed {
        .wy-nav-side {
            margin-left: -300px !important;
        }

        .wy-nav-content-wrap {
            margin-left: 0 !important;
        }

        #sidebar-toggle-button {
            left: 0 !important;
        }
    }

    /* 禁用点击时的过渡 */
    .sidebar-transitioning {
        .wy-nav-side,
        .wy-nav-content-wrap,
        #sidebar-toggle-button {
            transition: none !important;
        }
    }
</style>

    

    <script>
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            

            sidebarToggleButton();
        });


    </script>



</body>
</html>