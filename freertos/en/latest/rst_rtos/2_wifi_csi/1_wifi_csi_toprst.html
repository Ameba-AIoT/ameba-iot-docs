

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wi-Fi CSI Introduction &mdash; Ameba IoT Docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dcc6a489" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dcc6a489" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="http://172.29.57.206:5000/docs/rst_rtos/2_wifi_csi/1_wifi_csi_toprst.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../../_static/tabs.js?v=3030b3cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Wi-Fi Adaptivity Test" href="../2_wifi_adaptivity_test/0_wifi_adaptivity_index.html" />
    <link rel="prev" title="Wi-Fi CSI" href="0_wifi_csi_index.html" />
     

    

    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- 样式模板 -->
    <style>
        .wy-nav-content {
            max-width: 1100px;
             
        }

        .wy-nav-content {
            transition: margin 0.3s ease; /* 添加过渡效果 */
            margin-left: 0px !important; /* 侧边栏展开时的偏移 */
            max-width: calc(100% - 0px) !important; /* 调整最大宽度，使其与侧边栏宽度相关 */
        }

        .wy-nav-content.expanded {
            margin-left: 0 !important; /* 侧边栏收缩时内容区域回归左边 */
            max-width: 100% !important; /* 内容区域最大宽度调整 */
        }
    </style>

    <!-- 注入 TOC 映射和当前页面信息 -->
    

<!-- TOC 映射和当前文档信息 -->
<script>
// 将 Python 字典转换为 JS 对象
const TOC_TITLE_MAP = {"rst_rtos/0_ameba_product": "Products Center", "rst_rtos/0_ameba_product/0_ameba_product_center_index": "Products Center", "rst_rtos/0_ameba_sdk": "Ameba SDK", "rst_rtos/0_ameba_sdk/0_ameba_sdks_index": "Ameba SDK", "rst_rtos/0_ameba_solutions": "Ameba Solutions", "rst_rtos/0_ameba_solutions/0_ameba_solutions_index": "Ameba Solutions", "rst_rtos/0_at_command": "0.8 AT Commands", "rst_rtos/0_at_command/0_at_command_index": "0.8 AT Commands", "rst_rtos/0_build_system": "0.3 Build System", "rst_rtos/0_build_system/0_build_system_index": "0.3 Build System", "rst_rtos/0_file_system": "0.9 Virtual File System", "rst_rtos/0_file_system/0_vfs_index": "0.9 Virtual File System", "rst_rtos/0_ftl": "0.a Flash Translation Layer", "rst_rtos/0_ftl/0_ftl_index": "0.a Flash Translation Layer", "rst_rtos/0_gcc_build_environment": "0.1 GCC Build Environment", "rst_rtos/0_gcc_build_environment/0_gcc_build_index": "0.1 GCC Build Environment", "rst_rtos/0_gdb_debug": "0.2 GDB Debug", "rst_rtos/0_gdb_debug/0_gdb_debug_index": "0.2 GDB Debug", "rst_rtos/0_memory_layout": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_memory_layout/0_layout_index": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_sdk_example": "0.4 SDK Example", "rst_rtos/0_sdk_example/0_sdk_example_index": "0.4 SDK Example", "rst_rtos/0_tools": "0.7 Tools", "rst_rtos/0_tools/0_tools_index": "0.7 Tools", "rst_rtos/0_user_config": "0.6 User Config", "rst_rtos/0_user_config/0_usrcfg_index": "0.6 User Config", "rst_rtos/10_api_docs": "2.6 Wi-Fi API Reference", "rst_rtos/10_api_docs/0_api_index": "2.6 Wi-Fi API Reference", "rst_rtos/1_boot_process": "1.1 Boot Process", "rst_rtos/1_boot_process/0_boot_index": "1.1 Boot Process", "rst_rtos/1_chipen": "1.4 Chip Enable", "rst_rtos/1_chipen/0_chipen_index": "1.4 Chip Enable", "rst_rtos/1_gpio": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_gpio/0_gpio_index": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_ipc": "1.5 Inter Processor Communication", "rst_rtos/1_ipc/0_ipc_index": "1.5 Inter Processor Communication", "rst_rtos/1_mpu_cache": "1.0 Memory Management \u0026 Cache", "rst_rtos/1_mpu_cache/0_mpu_cache_index": "1.0 Memory Management \u0026 Cache", "rst_rtos/1_ota": "1.2 OTA", "rst_rtos/1_ota/0_ota_index": "1.2 OTA", "rst_rtos/1_otpc": "1.3 OTPC", "rst_rtos/1_otpc/0_otpc_index": "1.3 OTPC", "rst_rtos/1_pinmux": "1.6 Pin Multiplexing", "rst_rtos/1_pinmux/0_pinmux_index": "1.6 Pin Multiplexing", "rst_rtos/1_power_save": "1.9 Power Saving", "rst_rtos/1_power_save/0_ps_index": "1.9 Power Saving", "rst_rtos/2_whc_fullmac": "2.2 WHC FullMAC", "rst_rtos/2_whc_fullmac/0_fullmac_index": "2.2 WHC FullMAC", "rst_rtos/2_whc_wifi_bridge": "2.1 WHC Bridge", "rst_rtos/2_whc_wifi_bridge/0_wifi_bridge_index": "2.1 WHC Bridge", "rst_rtos/2_wifi_adaptivity_test": "2.5 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_adaptivity_test/0_wifi_adaptivity_index": "2.5 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_basic": "2.0 Wi-Fi Basic Mode", "rst_rtos/2_wifi_basic/0_wifi_basic_index": "2.0 Wi-Fi Basic Mode", "rst_rtos/2_wifi_csi": "2.4 Wi-Fi CSI", "rst_rtos/2_wifi_csi/0_wifi_csi_index": "2.4 Wi-Fi CSI", "rst_rtos/2_wifi_tunnel": "2.3 Wi-Fi R-Mesh", "rst_rtos/2_wifi_tunnel/0_wifi_tunnel_index": "2.3 Wi-Fi R-Mesh", "rst_rtos/3_ap_trustzone": "3.d AP Secure Service", "rst_rtos/3_ap_trustzone/0_ap_tz_index": "3.d AP Secure Service", "rst_rtos/3_crypto_engine": "3.9 Crypto Engine", "rst_rtos/3_crypto_engine/0_crypto_engine_index": "3.9 Crypto Engine", "rst_rtos/3_ecdsa_engine": "3.a ECDSA Engine", "rst_rtos/3_ecdsa_engine/0_ecdsa_index": "3.a ECDSA Engine", "rst_rtos/3_eddsa_engine": "3.b EDDSA Engine", "rst_rtos/3_eddsa_engine/0_eddsa_index": "3.b EDDSA Engine", "rst_rtos/3_rsa_engine": "3.c RSA Engine", "rst_rtos/3_rsa_engine/0_rsa_index": "3.c RSA Engine", "rst_rtos/3_security": "3.1 Security \u0026 Encryption", "rst_rtos/3_security/0_security_index": "3.1 Security \u0026 Encryption", "rst_rtos/3_trng": "3.2 True Random Number Generator", "rst_rtos/3_trng/0_trng_index": "3.2 True Random Number Generator", "rst_rtos/4_ai": "4.1 AI", "rst_rtos/4_ai/0_ai_index": "4.1 AI", "rst_rtos/4_ai_voice": "4.2 AIVoice", "rst_rtos/4_ai_voice/0_ai_voice_index": "4.2 AIVoice", "rst_rtos/4_dsp": "4.4 DSP", "rst_rtos/4_dsp/0_dsp_index": "4.4 DSP", "rst_rtos/4_multimedia": "4.3 Multimedia", "rst_rtos/4_multimedia/0_multimedia_index": "4.3 Multimedia", "rst_rtos/6_mass_production": "6.1 Mass Production", "rst_rtos/6_mass_production/0_mp_index": "6.1 Mass Production", "rst_rtos/6_mptools": "6.2 MP Tools", "rst_rtos/6_mptools/0_mptools_index": "6.2 MP Tools", "rst_rtos/7_usb": "7.1 USB Host \u0026 Device", "rst_rtos/7_usb/0_usb_index": "7.1 USB Host \u0026 Device", "rst_rtos/8_adc": "8.4 ADC", "rst_rtos/8_adc/0_adc_index": "8.4 ADC", "rst_rtos/8_cap_touch": "8.7 Cap-Touch", "rst_rtos/8_cap_touch/0_cap_touch_index": "8.7 Cap-Touch", "rst_rtos/8_dmac": "8.1 DMA Controller", "rst_rtos/8_dmac/0_dmac_index": "8.1 DMA Controller", "rst_rtos/8_ir": "8.5 IR", "rst_rtos/8_ir/0_ir_index": "8.5 IR", "rst_rtos/8_key_scan": "8.8 Key-Scan", "rst_rtos/8_key_scan/0_key_scan_index": "8.8 Key-Scan", "rst_rtos/8_lcdc": "8.a LCD Controller", "rst_rtos/8_lcdc/0_lcdc_index": "8.a LCD Controller", "rst_rtos/8_ledc": "8.6 LED Controller", "rst_rtos/8_ledc/0_ledc_index": "8.6 LED Controller", "rst_rtos/8_psram": "8.2 PSRAM", "rst_rtos/8_psram/0_psram_index": "8.2 PSRAM", "rst_rtos/8_rtc_io": "8.9 RTC-IO", "rst_rtos/8_rtc_io/0_rtc_io_index": "8.9 RTC-IO", "rst_rtos/8_thermal": "8.3 Thermal Meter", "rst_rtos/8_thermal/0_thermal_index": "8.3 Thermal Meter"};
console.log("TOC_TITLE_MAP:", TOC_TITLE_MAP);

// 获取当前页面的文档名 (例如 'rst_rtos/3_nda_secure_boot/0_secure_boot_index_nda')
const CURRENT_DOCNAME = 'rst_rtos/2_wifi_csi/1_wifi_csi_toprst';

// 动态查找顶级分类函数（定义为全局函数）
window.findTopLevelChapter = function(docname) {
    console.log("Attempting to find top-level chapter for:", docname);
    let bestMatch = "";
    let bestTitle = "Unknown Chapter";

    // 按路径长度降序排序以确保最长匹配
    const sortedPaths = Object.keys(TOC_TITLE_MAP).sort((a, b) => b.length - a.length);

    for (const path of sortedPaths) {
        console.log("Checking path:", path);
        if (docname === path || docname.startsWith(path + '/')) { // 子页面
            bestMatch = path;
            bestTitle = TOC_TITLE_MAP[path];
            console.log("Matched path:", path, "with title:", bestTitle);
            break;
        }
    }

    // 如果没有找到任何匹配项，则尝试更短的路径
    if (bestMatch === "") {
        const pathSegments = docname.split('/');
        while (pathSegments.length > 1) { // 至少保留根路径
            const candidate = pathSegments.join('/');
            console.log("Checking shorter path:", candidate);
            if (TOC_TITLE_MAP[candidate]) {
                bestTitle = TOC_TITLE_MAP[candidate];
                console.log("Matched shorter path:", candidate, "with title:", bestTitle);
                break;
            }
            pathSegments.pop();
        }
    }

    console.log("Final top-level chapter:", bestTitle);
    return bestTitle;
}

// 初始化时调用
document.addEventListener('DOMContentLoaded', function() {
    const topLevelChapter = findTopLevelChapter(CURRENT_DOCNAME);
    console.log("Top Level Chapter:", topLevelChapter);

    // 将顶级分类插入到DOM中（根据需要）
    const chapterElement = document.createElement('div');
    chapterElement.className = 'top-level-chapter';
    chapterElement.innerHTML = `<strong>Top Level Chapter: </strong>${topLevelChapter}`;
    document.body.appendChild(chapterElement);
});
</script>

    

    <!-- 左上角标题距离控制：Ameba IoT Docs -->
    <style>
        /* 新增的标题间距调整样式（添加在此处） */
        div[role="navigation"] > div[role="search"] {
            margin-bottom: 4px !important;
        }

        a.icon.icon-home {
            display: inline-block;
            margin-bottom: 2px !important;
        }
    </style>

    <!-- 引入功能模块 -->
    
    
<script>
    /* ====================== 嵌入式配置开始 ====================== */
    const embeddedConfig = {
        "freertos": {
            "name": "FreeRTOS",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        },
        "linux": {
            "name": "Linux",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        }
    };
    /* ====================== 嵌入式配置结束 ====================== */
</script>

<script>
    // 获取OS显示名称列表
    function getOSNames(data) {
        return Object.keys(data).map(key => data[key].name);
    }

    // 获取指定OS的语言列表
    function getLanguages(data, osKey) {
        return Object.keys(data[osKey]?.languages || {});
    }

    // 获取指定OS和语言的版本列表
    function getVersions(data, osKey, language) {
        return data[osKey]?.languages?.[language] || ['latest'];
    }

    // 根据显示名称查找OS键
    function findOSKey(data, displayName) {
        return Object.keys(data).find(key => data[key].name === displayName);
    }

    // 获取基础URL路径
    function getBaseURL() {
        const url = new URL(window.location.href);
        console.log('[DEBUG] getBaseURL:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const pathParts = url.pathname.split('/').filter(part => part !== '');
            const index = pathParts.indexOf('build');
            console.log('[DEBUG] getBaseURL0:', pathParts.slice(0, index + 1).join('/'));
            return `file://${pathParts.slice(0, index + 1).join('/')}/`;
        } else {
            // 网络路径处理
            const basePath = url.pathname.split('/')[1]; // 直接取第一个有效路径段
            console.log('[DEBUG] getBaseURL:', url.origin, basePath);
            return `${url.origin}/${basePath}/`;
        }
    }

    // 获取当前URL路径分段
    function getCurrentSegments() {
        const url = new URL(window.location.href);
        let segments = url.pathname.split('/').filter(segment => segment);


        console.log('[DEBUG] getCurrentSegments:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const index = segments.indexOf('build');
            segments = segments.slice(index + 1); // 去掉 build 及之前的路径
            console.log('[DEBUG] getCurrentSegments0:', segments);
        } else {
            // 网络路径处理
            segments = segments.slice(1); // 去掉 ameba-iot-docs/
            console.log('[DEBUG] getCurrentSegments:', segments);
        }

        return {
            osKey: segments[0] || 'freertos', // 默认为 freertos
            language: segments[1] || 'en',   // 默认为 en
            version: segments[2] || 'latest' // 默认为 latest
        };
    }

    // 绑定事件监听
    function bindEvents(baseURL, segments) {
        document.getElementById('os-selector').addEventListener('change', () => {
            const newOSKey = document.getElementById('os-selector').value;
            const availableLangs = getLanguages(embeddedConfig, newOSKey);
            const defaultLang = availableLangs[0] || 'en';
            const defaultVersion = getVersions(embeddedConfig, newOSKey, defaultLang)[0] || 'latest';
            console.log('OS Changed:', {newOSKey, defaultLang, defaultVersion});
            redirectTo(`${baseURL}${newOSKey}/${defaultLang}/${defaultVersion}/`);
        });

        document.getElementById('language-selector').addEventListener('change', () => {
            const newLang = document.getElementById('language-selector').value;
            const defaultVersion = getVersions(embeddedConfig, segments.osKey, newLang)[0] || 'latest';
            console.log('Language Changed:', {newLang, defaultVersion});
            redirectTo(`${baseURL}${segments.osKey}/${newLang}/${defaultVersion}/`);
        });

        document.getElementById('version-selector').addEventListener('change', () => {
            const newVer = document.getElementById('version-selector').value;
            console.log('Version Changed:', {newVer});
            redirectTo(`${baseURL}${segments.osKey}/${segments.language}/${newVer}/`);
        });
    }

    // 跳转函数
    function redirectTo(path) {
        const url = new URL(path, window.location.href);
        if (url.protocol === 'file:') {
            url.pathname += 'index.html';
        }
        console.log('Redirecting to:', url.href);
        window.location.href = url.href;
    }
</script>

<script>
    // 验证并修正路径参数
    function validateSegments(segments) {
        const currentOSName = embeddedConfig[segments.osKey]?.name;

        // 如果 OS 无效，默认设置为 FreeRTOS
        if (!currentOSName) {
            console.warn("Invalid OS key, defaulting to FreeRTOS");
            segments.osKey = 'freertos';
        }

        // 如果语言无效，默认设置为 en
        if (!getLanguages(embeddedConfig, segments.osKey).includes(segments.language)) {
            console.warn("Invalid language, defaulting to en");
            segments.language = 'en';
        }

        return segments;
    }

    // 设置初始选中值
    function setInitialValues(segments) {
        document.getElementById('os-selector').value = segments.osKey;
        document.getElementById('language-selector').value = segments.language;

        const versionSelector = document.getElementById('version-selector');
        const availableVersions = getVersions(embeddedConfig, segments.osKey, segments.language);
        versionSelector.value = availableVersions.includes(segments.version) ? segments.version : availableVersions[0] || 'latest';
    }
</script>

<style>
    .selectors-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr); /* 三列等宽 */
        gap: 4px;
        padding: 1px 1px;

        margin-top: var(--root-margin-top, 4px);
        margin-bottom: var(--root-margin-bottom, 0px);
    }

    .dual-selector-group {
        display: grid;
        grid-template-columns: 1fr 1fr; /* 两列等宽 */
        gap: 4px; /* 列间距 */
    }

    .selector-group {
        position: relative;
        width: 100%; /* 确保填满网格列 */
    }

    .selector-label {
        display: block;
        color: #a0b3c6;
        font-size: 0.85em;
        margin-bottom: 4px;
        padding-left: 4px;
    }

    .selector-dropdown {
        width: 100%;
        margin-top: var(--root-margin-top, 4px);
        margin-bottom: var(--root-margin-bottom, 0px);
        padding: 2px 2px;
        border: 2px white !important;
        border-radius: 6px !important;
        background: #627078 !important;
        color: white;
        font-size: 0.95em;
        transition: all 0.3s ease;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23a0b3c6'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
        display: flex;
        height: 30px;

        box-shadow: none !important; /* 不要边框阴影 */
        outline: none !important; /* 不要边框阴影 */
    }

    .selector-dropdown:hover {
        border-color: #4a6a8b;
        background-color: rgba(44, 62, 80, 1);
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .selector-dropdown:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
    }

    /* 移动端优化 */
    @media (max-width: 768px) {
        .selectors-grid {
            grid-template-columns: 1fr; /* 小屏幕下堆叠显示 */
            gap: 10px;
        }

        .selector-dropdown {
            padding: 10px 12px;
        }

        .dual-selector-group {
            grid-template-columns: 1fr; /* 小屏幕下堆叠显示 */
        }
    }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

    <!-- templates/sidebar_toggle.html -->


<div id="topleft-panel" style="display: block !important; padding: 0; background: none; border: none;"></div>


<div class="bottomleft-panel"></div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        try {
            const segments = validateSegments(getCurrentSegments());
            const baseURL = getBaseURL();

            // 渲染HTML
            document.getElementById('topleft-panel').innerHTML = `
<!-- templates/sidebar_user_panel_div.html -->


<!-- templates/sidebar_user_panel_div_docselect.html -->

<div class="selectors-grid">
    <!-- 系统选择器 -->
    <div class="selector-group">
        <select id="os-selector" class="selector-dropdown">
            ${Object.keys(embeddedConfig).map(key => `
                <option value="${key}">${embeddedConfig[key].name}</option>
            `).join('')}
        </select>
    </div>

    <!-- 语言选择器 -->
    <div class="selector-group">
        <select id="language-selector" class="selector-dropdown">
            ${getLanguages(embeddedConfig, segments.osKey).map(lang => `
                <option value="${lang}">${lang === 'en' ? 'en' : 'cn'}</option>
            `).join('')}
        </select>
    </div>

    <!-- 版本选择器 -->
    <div class="selector-group">
        <select id="version-selector" class="selector-dropdown">
            ${getVersions(embeddedConfig, segments.osKey, segments.language).map(ver => `
                <option value="${ver}">${ver}</option>
            `).join('')}
        </select>
    </div>
</div>

<div class="user-panel-container">
    <div class="user-panel">
        

    </div>
</div>`;

            // 设置初始值
            setInitialValues(segments);

            // 绑定事件
            bindEvents(baseURL, segments);

            // 将 user-panel 移动到 bottomleft-panel 内
            const userPanel = document.querySelector('.user-panel');
            const bottomleftPanel = document.querySelector('.bottomleft-panel');
            if (userPanel && bottomleftPanel) {
                bottomleftPanel.appendChild(userPanel); // 直接添加为子元素
            }
        } catch (error) {
            console.error("Error initializing selectors:", error);
        }
    });
</script>

<style>
    #topleft-panel {
        background: rgba(40, 58, 73, 0.9);
        border-radius: 4px;
        padding: 4px;
        margin: 4px 0;
        box-shadow: 0 4px 4px rgba(0,0,0,0.15);
        backdrop-filter: blur(4px);
    }

    /* 移动端优化 */
    @media (max-width: 768px) {
        #topleft-panel {
            margin: 8px 0;
            padding: 10px;
        }
    }
</style>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_product/0_ameba_product_center_index.html">Products Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_sdk/0_ameba_sdks_index.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_solutions/0_ameba_solutions_index.html">Ameba Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index.html">0.1 GCC Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gdb_debug/0_gdb_debug_index.html">0.2 GDB Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_build_system/0_build_system_index.html">0.3 Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_example/0_sdk_example_index.html">0.4 SDK Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_memory_layout/0_layout_index.html">0.5 Flash &amp; RAM Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_user_config/0_usrcfg_index.html">0.6 User Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_tools/0_tools_index.html">0.7 Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_at_command/0_at_command_index.html">0.8 AT Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_file_system/0_vfs_index.html">0.9 Virtual File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ftl/0_ftl_index.html">0.a Flash Translation Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_mpu_cache/0_mpu_cache_index.html">1.0 Memory Management &amp; Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index.html">1.1 Boot Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index.html">1.2 OTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_otpc/0_otpc_index.html">1.3 OTPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_chipen/0_chipen_index.html">1.4 Chip Enable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ipc/0_ipc_index.html">1.5 Inter Processor Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_pinmux/0_pinmux_index.html">1.6 Pin Multiplexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index.html">1.7 GPIO &amp; Pin Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index.html">1.9 Power Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_basic/0_wifi_basic_index.html">2.0 Wi-Fi Basic Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_wifi_bridge/0_wifi_bridge_index.html">2.1 WHC Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_fullmac/0_fullmac_index.html">2.2 WHC FullMAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_tunnel/0_wifi_tunnel_index.html">2.3 Wi-Fi R-Mesh</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_wifi_csi_index.html">2.4 Wi-Fi CSI</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Wi-Fi CSI Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#active-csi-unicast-mode">Active CSI: Unicast Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#active-csi-broadcast-mode">Active CSI: Broadcast Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#passive-csi">Passive CSI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wi-fi-csi-architecture">Wi-Fi CSI Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wi-fi-csi-related-apis">Wi-Fi CSI Related APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wifi-csi-config">wifi_csi_config</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parameter-definitions">Parameter Definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameter-values">Parameter Values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wifi-csi-report">wifi_csi_report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Parameter Definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#csi-buffer-layout">CSI Buffer Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="#number-of-subcarriers-for-csi-raw-data">Number of Subcarriers for CSI Raw Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wifi-reg-event-handler">wifi_reg_event_handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wifi-unreg-event-handler">wifi_unreg_event_handler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wi-fi-csi-usage-notes">Wi-Fi CSI Usage Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-requirements">Basic Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#method4-design-considerations">METHOD4 Design Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compiling-wi-fi-csi-image">Compiling Wi-Fi CSI Image</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wi-fi-csi-example">Wi-Fi CSI Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview-of-wi-fi-csi-example">Overview of Wi-Fi CSI Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#details-of-wi-fi-csi-example">Details of Wi-Fi CSI Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-initialization">Example Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wi-fi-csi-entry-function">Wi-Fi CSI Entry Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wi-fi-csi-thread">Wi-Fi CSI Thread</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wi-fi-csi-callback-function">Wi-Fi CSI Callback Function</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_adaptivity_test/0_wifi_adaptivity_index.html">2.5 Wi-Fi Adaptivity Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_api_docs/0_api_index.html">2.6 Wi-Fi API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_security/0_security_index.html">3.1 Security &amp; Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_trng/0_trng_index.html">3.2 True Random Number Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_crypto_engine/0_crypto_engine_index.html">3.9 Crypto Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ecdsa_engine/0_ecdsa_index.html">3.a ECDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_eddsa_engine/0_eddsa_index.html">3.b EDDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_rsa_engine/0_rsa_index.html">3.c RSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ap_trustzone/0_ap_tz_index.html">3.d AP Secure Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai/0_ai_index.html">4.1 AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai_voice/0_ai_voice_index.html">4.2 AIVoice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index.html">4.3 Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_dsp/0_dsp_index.html">4.4 DSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mass_production/0_mp_index.html">6.1 Mass Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mptools/0_mptools_index.html">6.2 MP Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index.html">7.1 USB Host &amp; Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index.html">8.1 DMA Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_psram/0_psram_index.html">8.2 PSRAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index.html">8.3 Thermal Meter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index.html">8.4 ADC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index.html">8.5 IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ledc/0_ledc_index.html">8.6 LED Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_cap_touch/0_cap_touch_index.html">8.7 Cap-Touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_key_scan/0_key_scan_index.html">8.8 Key-Scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc_io/0_rtc_io_index.html">8.9 RTC-IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index.html">8.a LCD Controller</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">
    
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_wifi_csi_index.html">Wi-Fi CSI</a></li>
      <li class="breadcrumb-item active">Wi-Fi CSI Introduction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wi-fi-csi-introduction">
<span id="wifi-csi"></span><h1>Wi-Fi CSI Introduction<a class="headerlink" href="#wi-fi-csi-introduction" title="Link to this heading"></a></h1>
<p>Wi-Fi CSI (Channel State Information) is a technology used to describe the characteristics of wireless channels. It aims to quantify the aggregate effect of wireless phenomena (such as interference, multipath, doppler shift…) on wireless signals in a given environment by reporting complete CSIs. And can be used in applications such as human activity analysis, WiFi indoor positioning, and gesture recognition.</p>
<p>Realtek Wi-Fi CSI is divided into Active CSI and Passive CSI schemes based on whether the Realtek device (STA mode or SoftAP mode) participates in transmitting the CSI triggering frames.</p>
<ul class="simple">
<li><p><strong>Active CSI</strong>: The Realtek device needs to actively transmit CSI triggering frames</p>
<ul>
<li><p>Active CSI is divided into two modes based on the type of CSI triggering frame: unicast mode and broadcast mode. For details, refer to <a class="reference internal" href="#wifi-acitve-csi-unicast-mode"><span class="std std-ref">Active CSI: Unicast Mode</span></a> and <a class="reference internal" href="#wifi-acitve-csi-broadcast-mode"><span class="std std-ref">Active CSI: Broadcast Mode</span></a>.</p></li>
<li><p>Using Public Action frame as CSI triggering frame in Active CSI.</p></li>
</ul>
</li>
<li><p><strong>Passive CSI</strong>: The Realtek device is not required to transmit CSI triggering frames</p>
<ul>
<li><p>Details refer to <a class="reference internal" href="#wifi-passive-csi"><span class="std std-ref">Passive CSI</span></a>.</p></li>
</ul>
</li>
</ul>
<section id="active-csi-unicast-mode">
<span id="wifi-acitve-csi-unicast-mode"></span><h2>Active CSI: Unicast Mode<a class="headerlink" href="#active-csi-unicast-mode" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>METHOD1</strong>: A Realtek STA transmits a unicast CSI triggering frame to the AP and derives CSI from the ACK response to the previous CSI triggering frame (one-to-one communication).</p></li>
<li><p><strong>METHOD1_Variant</strong>: A Realtek STA transmits a unicast CSI triggering frame to another STAx and derives CSI from the ACK response to the previous CSI triggering frame (one-to-many communication via polling).</p></li>
<li><p><strong>METHOD2</strong>: A Realtek SoftAP transmits a unicast CSI triggering frame to associated stations and derives CSI from the ACK response to the previous unicast CSI triggering frame (one-to-many communication via polling).</p></li>
</ul>
<figure class="align-center" id="id2">
<span id="collecting-csi-from-rx-ack-packet-response-mode"></span><a class="reference internal image-reference" href="../../_images/collecting_csi_from_rx_ack_packet_response_mode.svg"><img alt="../../_images/collecting_csi_from_rx_ack_packet_response_mode.svg" height="489" src="../../_images/collecting_csi_from_rx_ack_packet_response_mode.svg" width="1346" /></a>
<figcaption>
<p><span class="caption-text">Collect CSI from Rx ACK Packet in Rx Response Mode</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="active-csi-broadcast-mode">
<span id="wifi-acitve-csi-broadcast-mode"></span><h2>Active CSI: Broadcast Mode<a class="headerlink" href="#active-csi-broadcast-mode" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>METHOD3</strong>: Realtek SoftAP transmits a broadcast CSI triggering frame, which are decoded by Realtek STAs to derive CSI.</p></li>
<li><p><strong>METHOD4</strong>: A Realtek STA transmits a broadcast CSI triggering frame, which are decoded by neighboring Realtek STAs to derive CSI.</p></li>
</ul>
<figure class="align-center" id="id3">
<span id="collecting-csi-from-rx-broadcast-packet-normal-mode"></span><a class="reference internal image-reference" href="../../_images/collecting_csi_from_rx_broadcast_packet_normal_mode.svg"><img alt="../../_images/collecting_csi_from_rx_broadcast_packet_normal_mode.svg" height="624" src="../../_images/collecting_csi_from_rx_broadcast_packet_normal_mode.svg" width="1305" /></a>
<figcaption>
<p><span class="caption-text">Collect CSI from Rx Broadcast Packet in Rx Normal Mode</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="passive-csi">
<span id="wifi-passive-csi"></span><h2>Passive CSI<a class="headerlink" href="#passive-csi" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>METHOD5</strong>: A Realtek STA/SoftAP derives CSI from received packets in Rx Normal Mode (one-to-one communication).</p></li>
</ul>
<figure class="align-center" id="id4">
<span id="collecting-csi-from-rx-packet-normal-mode"></span><a class="reference internal image-reference" href="../../_images/collecting_csi_from_rx_packet_normal_mode.svg"><img alt="../../_images/collecting_csi_from_rx_packet_normal_mode.svg" height="485" src="../../_images/collecting_csi_from_rx_packet_normal_mode.svg" width="812" /></a>
<figcaption>
<p><span class="caption-text">Collect CSI from Rx packet in Rx Normal Mode</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="wi-fi-csi-architecture">
<h1>Wi-Fi CSI Architecture<a class="headerlink" href="#wi-fi-csi-architecture" title="Link to this heading"></a></h1>
<p>Wi-Fi CSI report mainly consists of three modules:</p>
<ol class="arabic simple">
<li><p>Configure and Enable Wi-Fi CSI</p>
<ul class="simple">
<li><p>The APP must call the API to configure Wi-Fi CSI parameters as needed and enable the Wi-Fi CSI function.</p></li>
<li><p>The APP must call the API to disable the Wi-Fi CSI function when inactive.</p></li>
</ul>
</li>
<li><p>Register/Deregister Wi-Fi CSI Callback</p>
<ul class="simple">
<li><p>Register a Wi-Fi CSI callback function when enabling Wi-Fi CSI. The Wi-Fi driver will transmit a flag to notify the APP when each CSI packet ready through the callback function.</p></li>
<li><p>Release the Wi-Fi CSI callback function when disabling Wi-Fi CSI.</p></li>
</ul>
</li>
<li><p>Report Wi-Fi CSI</p>
<ul class="simple">
<li><p>The APP should run a separate thread to wait for the CSI report ready flag, then call the API to read the CSI report.</p></li>
</ul>
</li>
</ol>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../../_images/csi_architecture.svg"><img alt="../../_images/csi_architecture.svg" height="551" src="../../_images/csi_architecture.svg" width="742" /></a>
<figcaption>
<p><span class="caption-text">Wi-Fi CSI architecture</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="wi-fi-csi-related-apis">
<h1>Wi-Fi CSI Related APIs<a class="headerlink" href="#wi-fi-csi-related-apis" title="Link to this heading"></a></h1>
<section id="wifi-csi-config">
<h2>wifi_csi_config<a class="headerlink" href="#wifi-csi-config" title="Link to this heading"></a></h2>
<ul>
<li><p>Function prototype:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">wifi_csi_config</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">rtw_csi_action_parm_t</span><span class="w"> </span><span class="o">*</span><span class="n">act_param</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Description: CSI parameter configuration and enable/disable</p>
<ul class="simple">
<li><p>act = <code class="docutils literal notranslate"><span class="pre">RTW_CSI_ACT_CFG</span></code> to configure Wi-Fi CSI parameters</p></li>
<li><p>act = <code class="docutils literal notranslate"><span class="pre">RTW_CSI_ACT_EN</span></code> to enable/disable Wi-Fi CSI. If disabled, the APP must reconfigure Wi-Fi CSI parameters before re-enabling Wi-Fi CSI.</p></li>
</ul>
</li>
</ul>
<section id="parameter-definitions">
<h3>Parameter Definitions<a class="headerlink" href="#parameter-definitions" title="Link to this heading"></a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-0-0-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-3" name="0-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>group_num</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI info subcarrier decimation</p>
<ul class="simple">
<li><p>0: per tone</p></li>
<li><p>1: per 2 tone</p></li>
<li><p>2: per 4 tone</p></li>
<li><p>3: per 8 tone</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>accuracy</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI raw data (CH I: In-phase, real part / Q: Quadrature, imaginary part) word length</p>
<ul class="simple">
<li><p>0: S(8,3) -&gt; a signed 8-bit number with 3 fractional bits</p></li>
<li><p>1: S(16,11) -&gt; a signed 16-bit number with 11 fractional bits</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>alg_opt</p></td>
<td><p>u8</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ch_opt</p></td>
<td><p>u8</p></td>
<td><p>Configure CSI acquisition from leagcy or non-legacy LTF</p></td>
</tr>
<tr class="row-even"><td><p>csi_role</p></td>
<td><p>u8</p></td>
<td><p>Specify the operational role of devices with Wi-Fi CSI enabled</p></td>
</tr>
<tr class="row-odd"><td><p>mode</p></td>
<td><p>u8</p></td>
<td><p>Specify which mode for fetching Wi-Fi CSI</p>
<ul class="simple">
<li><p>0: Rx Normal Mode (estimating CSI by the currently received packet)</p></li>
<li><p>2: Rx Response Mode (estimating CSI by receiving ACK for the previous transmission)</p></li>
<li><p>others reserved</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>act</p></td>
<td><p>u8</p></td>
<td><p>Enable Wi-Fi CSI or configure Wi-Fi CSI parameters</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_mgnt</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>trig_frame_ctrl</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_data</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>enable</p></td>
<td><p>u8</p></td>
<td><ul class="simple">
<li><p>0: disable Wi-Fi CSI function</p></li>
<li><p>1: enable Wi-Fi CSI function</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>trig_period</p></td>
<td><p>u8</p></td>
<td><p>Wi-Fi CSI sounding rate, unit: 320us (recommended value: 15~255)</p></td>
</tr>
<tr class="row-even"><td><p>data_rate</p></td>
<td><p>u8</p></td>
<td><p>Specify Tx data rate of CSI triggering frame, but the parameters is invalid in Rx Response Mode for getting Wi-Fi CSI</p>
<p>because Wi-Fi CSI dependeds on the data rate of the response ACK frame.</p>
<ul class="simple">
<li><p>Only support OFDM/HT rate</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>data_bw</p></td>
<td><p>u8</p></td>
<td><p>Specify the bandwidth of CSI triggering frame, but the parameters is invalid in Rx Response Mode for getting Wi-Fi CSI</p>
<p>because Wi-Fi CSI dependeds on the bandwidth of the response ACK frame.</p>
<ul class="simple">
<li><p>0: 20MHz</p></li>
<li><p>1: 40MHz</p></li>
<li><p>Others: reserved</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">data_bw</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">data_rate</span></code> must be set to at least <strong>RTW_RATE_MCS0</strong></p>
</div>
</td>
</tr>
<tr class="row-even"><td><p>mac_addr[6]</p></td>
<td><p>u8</p></td>
<td><p>Specify destination address (MAC address) for CSI triggering frame (purpose to fetch CSI information from response packet)</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">multi_type</span></code> = 1, the <code class="docutils literal notranslate"><span class="pre">mac_addr</span></code> is reserved.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>multi_type</p></td>
<td><p>u8</p></td>
<td><p>Specify whether the CSI triggering frame is unicast or broadcast, only valid in Active CSI.</p>
<ul class="simple">
<li><p>0: unicast (using unicast packet and fetching CSI from the ACK for unicast packet)</p></li>
<li><p>1: broadcast (using broadcast packet and other devices fetching CSI from the broadcast packet)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>trig_flag</p></td>
<td><p>u8</p></td>
<td><p>Specify role for transmitting CSI triggering frame in METHOD4 and role for transmitting response ACK for CSI triggering</p>
<p>frame in METHOD1_Variant, others are reserved.</p>
<ul class="simple">
<li><p>Value = 1 ~ 15 (0 is reserved)</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>group_num</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI info subcarrier decimation</p>
<ul class="simple">
<li><p>0: per tone</p></li>
<li><p>1: per 2 tone</p></li>
<li><p>2: per 4 tone</p></li>
<li><p>3: per 16 tone</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>accuracy</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI raw data (CH I: In-phase, real part / Q: Quadrature, imaginary part) word length</p>
<ul class="simple">
<li><p>0: S(8,4) -&gt; a signed 8-bit number with 4 fractional bits</p></li>
<li><p>1: S(16,12) -&gt; a signed 16-bit number with 12 fractional bits</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>alg_opt</p></td>
<td><p>u8</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ch_opt</p></td>
<td><p>u8</p></td>
<td><p>Configure CSI acquisition from leagcy or non-legacy LTF</p></td>
</tr>
<tr class="row-even"><td><p>csi_role</p></td>
<td><p>u8</p></td>
<td><p>Specify the operational role of devices with Wi-Fi CSI enabled</p></td>
</tr>
<tr class="row-odd"><td><p>mode</p></td>
<td><p>u8</p></td>
<td><p>Specify which mode for fetching Wi-Fi CSI</p>
<ul class="simple">
<li><p>0: Rx Normal Mode (estimating CSI by the currently received packet)</p></li>
<li><p>2: Rx Response Mode (estimating CSI by receiving ACK for the previous transmission)</p></li>
<li><p>others reserved</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>act</p></td>
<td><p>u8</p></td>
<td><p>Enable Wi-Fi CSI or configure Wi-Fi CSI parameters</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_mgnt</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>trig_frame_ctrl</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_data</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>enable</p></td>
<td><p>u8</p></td>
<td><ul class="simple">
<li><p>0: disable Wi-Fi CSI function</p></li>
<li><p>1: enable Wi-Fi CSI function</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>trig_period</p></td>
<td><p>u8</p></td>
<td><p>Wi-Fi CSI sounding rate, unit: 320us (recommended value: 15~255)</p></td>
</tr>
<tr class="row-even"><td><p>data_rate</p></td>
<td><p>u8</p></td>
<td><p>Specify Tx data rate of CSI triggering frame, but the parameters is invalid in Rx Response Mode for getting Wi-Fi CSI</p>
<p>because Wi-Fi CSI dependeds on the data rate of the response ACK frame.</p>
<ul class="simple">
<li><p>Only support OFDM/HT/HE rate</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>data_bw</p></td>
<td><p>u8</p></td>
<td><p>Specify the bandwidth of trigger frame, only support 20MHz</p>
<ul class="simple">
<li><p>0: 20MHz</p></li>
<li><p>Others: reserved</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>mac_addr[6]</p></td>
<td><p>u8</p></td>
<td><p>Specify destination address (MAC address) for CSI triggering frame (purpose to fetch CSI information from response packet)</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">multi_type</span></code> = 1, the <code class="docutils literal notranslate"><span class="pre">mac_addr</span></code> is reserved.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>multi_type</p></td>
<td><p>u8</p></td>
<td><p>Specify whether the CSI triggering frame is unicast or broadcast, only valid in Active CSI.</p>
<ul class="simple">
<li><p>0: unicast (using unicast packet and fetching CSI from the ACK for unicast packet)</p></li>
<li><p>1: broadcast (using broadcast packet and other devices fetching CSI from the broadcast packet)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>trig_flag</p></td>
<td><p>u8</p></td>
<td><p>Specify role for transmitting CSI triggering frame in METHOD4 and role for transmitting response ACK for CSI triggering</p>
<p>frame in METHOD1_Variant, others are reserved.</p>
<ul class="simple">
<li><p>Value = 1 ~ 15 (0 is reserved)</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>group_num</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI info subcarrier decimation</p>
<ul class="simple">
<li><p>0: per tone</p></li>
<li><p>1: per 2 tone</p></li>
<li><p>2: per 4 tone</p></li>
<li><p>3: per 16 tone</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>accuracy</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI raw data (CH I: In-phase, real part / Q: Quadrature, imaginary part) word length</p>
<ul class="simple">
<li><p>0: S(8,4) -&gt; a signed 8-bit number with 4 fractional bits</p></li>
<li><p>1: S(16,12) -&gt; a signed 16-bit number with 12 fractional bits</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>alg_opt</p></td>
<td><p>u8</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ch_opt</p></td>
<td><p>u8</p></td>
<td><p>Configure CSI acquisition from leagcy or non-legacy LTF</p></td>
</tr>
<tr class="row-even"><td><p>csi_role</p></td>
<td><p>u8</p></td>
<td><p>Specify the operational role of devices with Wi-Fi CSI enabled</p></td>
</tr>
<tr class="row-odd"><td><p>mode</p></td>
<td><p>u8</p></td>
<td><p>Specify which mode for fetching Wi-Fi CSI</p>
<ul class="simple">
<li><p>0: Rx Normal Mode (estimating CSI by the currently received packet)</p></li>
<li><p>2: Rx Response Mode (estimating CSI by receiving ACK for the previous transmission)</p></li>
<li><p>others reserved</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>act</p></td>
<td><p>u8</p></td>
<td><p>Enable Wi-Fi CSI or configure Wi-Fi CSI parameters</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_mgnt</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>trig_frame_ctrl</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_data</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>enable</p></td>
<td><p>u8</p></td>
<td><ul class="simple">
<li><p>0: disable Wi-Fi CSI function</p></li>
<li><p>1: enable Wi-Fi CSI function</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>trig_period</p></td>
<td><p>u8</p></td>
<td><p>Wi-Fi CSI sounding rate, unit: 320us (recommended value: 15~255)</p></td>
</tr>
<tr class="row-even"><td><p>data_rate</p></td>
<td><p>u8</p></td>
<td><p>Specify Tx data rate of CSI triggering frame, but the parameters is invalid in Rx Response Mode for getting Wi-Fi CSI</p>
<p>because Wi-Fi CSI dependeds on the data rate of the response ACK frame.</p>
<ul class="simple">
<li><p>Only support OFDM/HT/HE rate</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>data_bw</p></td>
<td><p>u8</p></td>
<td><p>Specify the bandwidth of trigger frame, only support 20MHz</p>
<ul class="simple">
<li><p>0: 20MHz</p></li>
<li><p>Others: reserved</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>mac_addr[6]</p></td>
<td><p>u8</p></td>
<td><p>Specify destination address (MAC address) for CSI triggering frame (purpose to fetch CSI information from response packet)</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">multi_type</span></code> = 1, the <code class="docutils literal notranslate"><span class="pre">mac_addr</span></code> is reserved.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>multi_type</p></td>
<td><p>u8</p></td>
<td><p>Specify whether the CSI triggering frame is unicast or broadcast, only valid in Active CSI.</p>
<ul class="simple">
<li><p>0: unicast (using unicast packet and fetching CSI from the ACK for unicast packet)</p></li>
<li><p>1: broadcast (using broadcast packet and other devices fetching CSI from the broadcast packet)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>trig_flag</p></td>
<td><p>u8</p></td>
<td><p>Specify role for transmitting CSI triggering frame in METHOD4 and role for transmitting response ACK for CSI triggering</p>
<p>frame in METHOD1_Variant, others are reserved.</p>
<ul class="simple">
<li><p>Value = 1 ~ 15 (0 is reserved)</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-3" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-3" name="0-3" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>group_num</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI info subcarrier decimation</p>
<ul class="simple">
<li><p>0: per tone</p></li>
<li><p>1: per 2 tone</p></li>
<li><p>2: per 4 tone</p></li>
<li><p>3: per 16 tone</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>accuracy</p></td>
<td><p>u8</p></td>
<td><p>Specify the CSI raw data (CH I: In-phase, real part / Q: Quadrature, imaginary part) word length</p>
<ul class="simple">
<li><p>0: S(8,4) -&gt; a signed 8-bit number with 4 fractional bits</p></li>
<li><p>1: S(16,12) -&gt; a signed 16-bit number with 12 fractional bits</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>alg_opt</p></td>
<td><p>u8</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ch_opt</p></td>
<td><p>u8</p></td>
<td><p>Configure CSI acquisition from leagcy or non-legacy LTF</p></td>
</tr>
<tr class="row-even"><td><p>csi_role</p></td>
<td><p>u8</p></td>
<td><p>Specify the operational role of devices with Wi-Fi CSI enabled</p></td>
</tr>
<tr class="row-odd"><td><p>mode</p></td>
<td><p>u8</p></td>
<td><p>Specify which mode for fetching Wi-Fi CSI</p>
<ul class="simple">
<li><p>0: Rx Normal Mode (estimating CSI by the currently received packet)</p></li>
<li><p>2: Rx Response Mode (estimating CSI by receiving ACK for the previous transmission)</p></li>
<li><p>others reserved</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>act</p></td>
<td><p>u8</p></td>
<td><p>Enable Wi-Fi CSI or configure Wi-Fi CSI parameters</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_mgnt</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>trig_frame_ctrl</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-odd"><td><p>trig_frame_data</p></td>
<td><p>u16</p></td>
<td><p>Specify frame type(s) of CSI triggering frame for fetching CSI (used for Rx Normal Mode and no need for Rx Response Mode)</p></td>
</tr>
<tr class="row-even"><td><p>enable</p></td>
<td><p>u8</p></td>
<td><ul class="simple">
<li><p>0: disable Wi-Fi CSI function</p></li>
<li><p>1: enable Wi-Fi CSI function</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>trig_period</p></td>
<td><p>u8</p></td>
<td><p>Wi-Fi CSI sounding rate, unit: 320us (recommended value: 15~255)</p></td>
</tr>
<tr class="row-even"><td><p>data_rate</p></td>
<td><p>u8</p></td>
<td><p>Specify Tx data rate of CSI triggering frame, but the parameters is invalid in Rx Response Mode for getting Wi-Fi CSI</p>
<p>because Wi-Fi CSI dependeds on the data rate of the response ACK frame.</p>
<ul class="simple">
<li><p>Support OFDM/HT/VHT/HE rate</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>data_bw</p></td>
<td><p>u8</p></td>
<td><p>Specify the bandwidth of trigger frame, only support 20MHz</p>
<ul class="simple">
<li><p>0: 20MHz</p></li>
<li><p>Others: reserved</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>mac_addr[6]</p></td>
<td><p>u8</p></td>
<td><p>Specify destination address (MAC address) for CSI triggering frame (purpose to fetch CSI information from response packet)</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">multi_type</span></code> = 1, the <code class="docutils literal notranslate"><span class="pre">mac_addr</span></code> is reserved.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>multi_type</p></td>
<td><p>u8</p></td>
<td><p>Specify whether the CSI triggering frame is unicast or broadcast, only valid in Active CSI.</p>
<ul class="simple">
<li><p>0: unicast (using unicast packet and fetching CSI from the ACK for unicast packet)</p></li>
<li><p>1: broadcast (using broadcast packet and other devices fetching CSI from the broadcast packet)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>trig_flag</p></td>
<td><p>u8</p></td>
<td><p>Specify role for transmitting CSI triggering frame in METHOD4 and role for transmitting response ACK for CSI triggering</p>
<p>frame in METHOD1_Variant, others are reserved.</p>
<ul class="simple">
<li><p>Value = 1 ~ 15 (0 is reserved)</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="parameter-values">
<h3>Parameter Values<a class="headerlink" href="#parameter-values" title="Link to this heading"></a></h3>
<ul>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">group_num</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi group num.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_GROUP_NUM_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="cm">/**&lt; per tone */</span>
<span class="w">   </span><span class="n">RTW_CSI_GROUP_NUM_2</span><span class="p">,</span><span class="w">      </span><span class="cm">/**&lt; per 2tone */</span>
<span class="w">   </span><span class="n">RTW_CSI_GROUP_NUM_4</span><span class="p">,</span><span class="w">      </span><span class="cm">/**&lt; per 4tone */</span>
<span class="w">   </span><span class="n">RTW_CSI_GROUP_NUM_8_16</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; per 8tone for dplus; per 16tone for others */</span>
<span class="w">   </span><span class="n">RTW_CSI_GROUP_NUM_MAX</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi accuracy.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_ACCU_1BYTE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; S(8,3) for dplus and S(8,4) for others */</span>
<span class="w">   </span><span class="n">RTW_CSI_ACCU_2BYTES</span><span class="p">,</span><span class="w">      </span><span class="cm">/**&lt; S(16,11) for dplus and S(16,12) for others */</span>
<span class="w">   </span><span class="n">RTW_CSI_ACCU_MAX</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">ch_opt</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi ch_opt.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_CH_LEGACY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; legacy part(L-LTF) channel estmation result */</span>
<span class="w">   </span><span class="n">RTW_CSI_CH_NON_LEGACY</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; non-legacy(HT-LTF) part */</span>
<span class="w">   </span><span class="n">RTW_CSI_CH_MAX</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">csi_role</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi csi_role.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_OP_ROLE_TRX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="cm">/**&lt; both trx */</span>
<span class="w">   </span><span class="n">RTW_CSI_OP_ROLE_TX</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="cm">/**&lt; only tx csi triggering frame */</span>
<span class="w">   </span><span class="n">RTW_CSI_OP_ROLE_RX</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">  </span><span class="cm">/**&lt; only rx csi triggering frame for fetching csi report */</span>
<span class="w">   </span><span class="n">RTW_CSI_OP_ROLE_MAX</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">mode</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi mode.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_MODE_NORMAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="cm">/**&lt; rx normal mode */</span>
<span class="w">   </span><span class="n">RTW_CSI_MODE_NDP</span><span class="p">,</span><span class="w">         </span><span class="cm">/**&lt; rx ndp mode: not support */</span>
<span class="w">   </span><span class="n">RTW_CSI_MODE_RX_RESP</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; rx response mode */</span>
<span class="w">   </span><span class="n">RTW_CSI_MODE_MAX</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">act</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi enable or config.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_ACT_EN</span><span class="p">,</span><span class="w">           </span><span class="cm">/**&lt; enable or disable csi func */</span>
<span class="w">   </span><span class="n">RTW_CSI_ACT_CFG</span><span class="p">,</span><span class="w">          </span><span class="cm">/**&lt; config csi parameters */</span>
<span class="w">   </span><span class="n">RTW_CSI_ACT_MAX</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">trig_frame_mgnt</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi trig management frame subtype.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_ASSOCREQ</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_ASSOCRSP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_REASSOCREQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_REASSOCRSP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_PROBEREQ</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_PROBERSP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_BEACON</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_ATIM</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_DISASSOC</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_AUTH</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_DEAUTH</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_ACTION</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">trig_frame_ctrl</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi trig control frame subtype.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_TRIGGER</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_BA</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_PSPOLL</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_RTS</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_CTS</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_ACK</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_CFEND</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_CFEND_CFACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">trig_frame_data</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief csi trig data frame subtype.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_DATA</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_DATA_CFACK</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_DATA_CFPOLL</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_DATA_CFACKPOLL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_DATA_NULL</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_CF_ACK</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_CF_POLL</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_CF_ACKPOLL</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_QOS_DATA</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
<span class="w">   </span><span class="n">RTW_CSI_TRIG_QOS_DATA_NULL</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>The values of <code class="docutils literal notranslate"><span class="pre">data_rate</span></code>:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-1-1-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-2" name="1-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-1-1-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-3" name="1-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief The enumeration lists the BIT 7 HT Rate.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_RATE_1M</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x02 */</span>
<span class="w">   </span><span class="n">RTW_RATE_2M</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x04 */</span>
<span class="w">   </span><span class="n">RTW_RATE_5_5M</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0B</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x0B */</span>
<span class="w">   </span><span class="n">RTW_RATE_6M</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x0C */</span>
<span class="w">   </span><span class="n">RTW_RATE_9M</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">0x12</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x12 */</span>
<span class="w">   </span><span class="n">RTW_RATE_11M</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x16</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x16 */</span>
<span class="w">   </span><span class="n">RTW_RATE_12M</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x18 */</span>
<span class="w">   </span><span class="n">RTW_RATE_18M</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x24 */</span>
<span class="w">   </span><span class="n">RTW_RATE_24M</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x30 */</span>
<span class="w">   </span><span class="n">RTW_RATE_36M</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x48</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x48 */</span>
<span class="w">   </span><span class="n">RTW_RATE_48M</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x60 */</span>
<span class="w">   </span><span class="n">RTW_RATE_54M</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x6C</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x6C */</span>

<span class="w">   </span><span class="n">RTW_RATE_MCS0</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w">     </span><span class="cm">/**&lt; 0x80 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS1</span><span class="p">,</span><span class="w">               </span><span class="cm">/**&lt; 0x81 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS2</span><span class="p">,</span><span class="w">               </span><span class="cm">/**&lt; 0x82 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS3</span><span class="p">,</span><span class="w">               </span><span class="cm">/**&lt; 0x83 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS4</span><span class="p">,</span><span class="w">               </span><span class="cm">/**&lt; 0x84 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS5</span><span class="p">,</span><span class="w">               </span><span class="cm">/**&lt; 0x85 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS6</span><span class="p">,</span><span class="w">               </span><span class="cm">/**&lt; 0x86 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS7</span><span class="p">,</span><span class="w">               </span><span class="cm">/**&lt; 0x87 */</span>

<span class="w">   </span><span class="n">RTW_RATE_UNKNOWN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFF</span><span class="w">      </span><span class="cm">/**&lt; MAX */</span>
<span class="p">};</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief The enumeration lists the BIT 7 HT Rate.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_RATE_1M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x02 */</span>
<span class="w">   </span><span class="n">RTW_RATE_2M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x04 */</span>
<span class="w">   </span><span class="n">RTW_RATE_5_5M</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0B</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x0B */</span>
<span class="w">   </span><span class="n">RTW_RATE_6M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x0C */</span>
<span class="w">   </span><span class="n">RTW_RATE_9M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x12</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x12 */</span>
<span class="w">   </span><span class="n">RTW_RATE_11M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x16</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x16 */</span>
<span class="w">   </span><span class="n">RTW_RATE_12M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x18 */</span>
<span class="w">   </span><span class="n">RTW_RATE_18M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x24 */</span>
<span class="w">   </span><span class="n">RTW_RATE_24M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x30 */</span>
<span class="w">   </span><span class="n">RTW_RATE_36M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x48</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x48 */</span>
<span class="w">   </span><span class="n">RTW_RATE_48M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x60 */</span>
<span class="w">   </span><span class="n">RTW_RATE_54M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x6C</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x6C */</span>

<span class="w">   </span><span class="n">RTW_RATE_MCS0</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x80 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS1</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x81 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS2</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x82 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS3</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x83 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS4</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x84 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS5</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x85 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS6</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x86 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS7</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x87 */</span>

<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xD0</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0xD0 */</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS1</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS2</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS3</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS4</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS5</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS6</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS7</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS8</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS9</span><span class="p">,</span>

<span class="w">   </span><span class="n">RTW_RATE_UNKNOWN</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFF</span><span class="w">     </span><span class="cm">/**&lt; MAX */</span>
<span class="p">};</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-2" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-2" name="1-2" role="tabpanel" tabindex="0"><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief The enumeration lists the BIT 7 HT Rate.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_RATE_1M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x02 */</span>
<span class="w">   </span><span class="n">RTW_RATE_2M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x04 */</span>
<span class="w">   </span><span class="n">RTW_RATE_5_5M</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0B</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x0B */</span>
<span class="w">   </span><span class="n">RTW_RATE_6M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x0C */</span>
<span class="w">   </span><span class="n">RTW_RATE_9M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x12</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x12 */</span>
<span class="w">   </span><span class="n">RTW_RATE_11M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x16</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x16 */</span>
<span class="w">   </span><span class="n">RTW_RATE_12M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x18 */</span>
<span class="w">   </span><span class="n">RTW_RATE_18M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x24 */</span>
<span class="w">   </span><span class="n">RTW_RATE_24M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x30 */</span>
<span class="w">   </span><span class="n">RTW_RATE_36M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x48</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x48 */</span>
<span class="w">   </span><span class="n">RTW_RATE_48M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x60 */</span>
<span class="w">   </span><span class="n">RTW_RATE_54M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x6C</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x6C */</span>

<span class="w">   </span><span class="n">RTW_RATE_MCS0</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0x80 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS1</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x81 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS2</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x82 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS3</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x83 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS4</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x84 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS5</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x85 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS6</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x86 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS7</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x87 */</span>

<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xD0</span><span class="p">,</span><span class="w">    </span><span class="cm">/**&lt; 0xD0 */</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS1</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS2</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS3</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS4</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS5</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS6</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS7</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS8</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS9</span><span class="p">,</span>

<span class="w">   </span><span class="n">RTW_RATE_UNKNOWN</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFF</span><span class="w">     </span><span class="cm">/**&lt; MAX */</span>
<span class="p">};</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-3" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-3" name="1-3" role="tabpanel" tabindex="0"><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief The enumeration lists the BIT 7 HT Rate.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTW_RATE_1M</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x02 */</span>
<span class="w">   </span><span class="n">RTW_RATE_2M</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x04 */</span>
<span class="w">   </span><span class="n">RTW_RATE_5_5M</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0B</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x0B */</span>
<span class="w">   </span><span class="n">RTW_RATE_6M</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x0C */</span>
<span class="w">   </span><span class="n">RTW_RATE_9M</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x12</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x12 */</span>
<span class="w">   </span><span class="n">RTW_RATE_11M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x16</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x16 */</span>
<span class="w">   </span><span class="n">RTW_RATE_12M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x18 */</span>
<span class="w">   </span><span class="n">RTW_RATE_18M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x24 */</span>
<span class="w">   </span><span class="n">RTW_RATE_24M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x30 */</span>
<span class="w">   </span><span class="n">RTW_RATE_36M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x48</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x48 */</span>
<span class="w">   </span><span class="n">RTW_RATE_48M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x60 */</span>
<span class="w">   </span><span class="n">RTW_RATE_54M</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x6C</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x6C */</span>

<span class="w">   </span><span class="n">RTW_RATE_MCS0</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0x80 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS1</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x81 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS2</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x82 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS3</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x83 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS4</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x84 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS5</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x85 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS6</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x86 */</span>
<span class="w">   </span><span class="n">RTW_RATE_MCS7</span><span class="p">,</span><span class="w">                 </span><span class="cm">/**&lt; 0x87 */</span>

<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xA0</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0xA0 */</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS1</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS2</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS3</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS4</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS5</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS6</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS7</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS8</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_VHT1SS_MCS9</span><span class="p">,</span>

<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS0</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">0xD0</span><span class="p">,</span><span class="w">   </span><span class="cm">/**&lt; 0xD0 */</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS1</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS2</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS3</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS4</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS5</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS6</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS7</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS8</span><span class="p">,</span>
<span class="w">   </span><span class="n">RTW_RATE_HE1SS_MCS9</span><span class="p">,</span>

<span class="w">   </span><span class="n">RTW_RATE_UNKNOWN</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFF</span><span class="w">    </span><span class="cm">/**&lt; MAX */</span>
<span class="p">};</span>
</pre></div>
</div>
</div></div>
</li>
</ul>
</section>
</section>
<section id="wifi-csi-report">
<h2>wifi_csi_report<a class="headerlink" href="#wifi-csi-report" title="Link to this heading"></a></h2>
<ul>
<li><p>Function prototype:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">wifi_csi_report</span><span class="p">(</span><span class="n">u32</span><span class="w"> </span><span class="n">buf_len</span><span class="p">,</span><span class="w"> </span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">csi_buf</span><span class="p">,</span><span class="w"> </span><span class="n">u32</span><span class="w"> </span><span class="o">*</span><span class="n">len</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Description: fetch Wi-Fi CSI report (CSI header information and CSI raw data)</p></li>
</ul>
<section id="id1">
<h3>Parameter Definitions<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>buf_len</p></td>
<td><p>u32</p></td>
<td><p>Buffer size for storing CSI packet which specified by APP</p></td>
</tr>
<tr class="row-odd"><td><p>csi_buf</p></td>
<td><p>u8*</p></td>
<td><p>CSI data buffer address for storing CSI packet which specified by APP</p></td>
</tr>
<tr class="row-even"><td><p>len</p></td>
<td><p>u32*</p></td>
<td><p>Size of CSI raw data</p></td>
</tr>
</tbody>
</table>
</section>
<section id="csi-buffer-layout">
<h3>CSI Buffer Layout<a class="headerlink" href="#csi-buffer-layout" title="Link to this heading"></a></h3>
<p>The CSI buffer is divided into two sections: <strong>CSI header information</strong> and <strong>CSI raw data</strong>. The size of the raw data is indicated by <em>csi_data_length</em> field within the CSI header information.</p>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../../_images/csi_buffer_layout.svg"><img alt="../../_images/csi_buffer_layout.svg" height="164" src="../../_images/csi_buffer_layout.svg" width="233" /></a>
<figcaption>
<p><span class="caption-text">CSI buffer layout</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="csi-header-information">
<h4>CSI Header Information<a class="headerlink" href="#csi-header-information" title="Link to this heading"></a></h4>
<p>The CSI header information follows a fixed-order format consisting of predefined fields. The diagram below illustrates the structure of the CSI header information.</p>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../../_images/csi_header_information_format.svg"><img alt="../../_images/csi_header_information_format.svg" height="124" src="../../_images/csi_header_information_format.svg" width="820" /></a>
<figcaption>
<p><span class="caption-text">CSI header information format</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The following list shows the description of each field.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Subfield</p></th>
<th class="head"><p>Size (bytes)</p></th>
<th class="head"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>csi_signature</p></td>
<td><p>2</p></td>
<td><p>Pattern that may be used to detect a new CSI packet.</p>
<p>The unique pattern is set to the value 0xABCD.</p>
</td>
</tr>
<tr class="row-odd"><td><p>hdr_len</p></td>
<td><p>1</p></td>
<td><p>Length of the CSI header information except the subfields of <em>csi_signature</em> and <em>hdr_len</em>.</p></td>
</tr>
<tr class="row-even"><td><p>mac_addr</p></td>
<td><p>6</p></td>
<td><p>Device MAC address, indicates transmitter address of CSI triggering frame in Active CSI</p>
<p>and receiver address of CSI triggering frame in Passive CSI.</p>
</td>
</tr>
<tr class="row-odd"><td><p>trig_addr</p></td>
<td><p>6</p></td>
<td><p>Device MAC address, indicates destination address of CSI triggering frame in Active CSI</p>
<p>and source address of CSI triggering frame in Passive CSI.</p>
<ul class="simple">
<li><p>Reserved in METHOD4</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>hw_assigned_timestamp</p></td>
<td><p>4</p></td>
<td><p>CSI timestamp, unit: us.</p></td>
</tr>
<tr class="row-odd"><td><p>csi_sequence</p></td>
<td><p>4</p></td>
<td><p>CSI packet sequence number (invalid in METHOD4).</p></td>
</tr>
<tr class="row-even"><td><p>csi_data_length</p></td>
<td><p>4</p></td>
<td><p>CSI raw_data length, unit: byte.</p></td>
</tr>
<tr class="row-odd"><td><p>csi_valid</p></td>
<td><p>1</p></td>
<td><p>Indicate the current CSI raw data whether valid.</p></td>
</tr>
<tr class="row-even"><td><p>channel</p></td>
<td><p>1</p></td>
<td><p>Operation channel of current device.</p></td>
</tr>
<tr class="row-odd"><td><p>bandwidth</p></td>
<td><p>1</p></td>
<td><p>Operation bandwidth.</p>
<ul class="simple">
<li><p>0: 20MHz</p></li>
<li><p>1: 40MHz</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>rx_rate</p></td>
<td><p>1</p></td>
<td><p>Indicate the rate of packet which used to derive CSI.</p></td>
</tr>
<tr class="row-odd"><td><p>protocol_mode</p></td>
<td><p>1</p></td>
<td><p>Inidcate the protocol mode of the packet which is used to fetch CSI.</p>
<ul class="simple">
<li><p>0: OFDM</p></li>
<li><p>1: HT</p></li>
<li><p>2: VHT</p></li>
<li><p>3: HE</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>num_sub_carrier</p></td>
<td><p>2</p></td>
<td><p>Number of subcarriers contain in CSI raw data.</p></td>
</tr>
<tr class="row-odd"><td><p>num_bit_per_tone</p></td>
<td><p>1</p></td>
<td><p>CSI data word length (sum of I and Q).</p>
<p>Accuracy: S(8,X) or S(16,X)</p>
</td>
</tr>
<tr class="row-even"><td><p>rssi[2]</p></td>
<td><p>1</p></td>
<td><p>Received signal strength, dBm, rssi[1] is reserved.</p></td>
</tr>
<tr class="row-odd"><td><p>evm[2]</p></td>
<td><p>2</p></td>
<td><p>Error vector magnitude, dB, Reserved.</p></td>
</tr>
<tr class="row-even"><td><p>rxsc</p></td>
<td><p>1</p></td>
<td><p>Indicate which sub 20M channel is used to transmit packet.</p></td>
</tr>
<tr class="row-odd"><td><p>n_rx</p></td>
<td><p>1</p></td>
<td><p>Reserved.</p></td>
</tr>
<tr class="row-even"><td><p>n_sts</p></td>
<td><p>1</p></td>
<td><p>Reserved.</p></td>
</tr>
<tr class="row-odd"><td><p>trig_flag</p></td>
<td><p>1</p></td>
<td><p>Idicates source of role for triggering CSI</p>
<p>Valid in only METHOD4 and reserved in other METHODs.</p>
</td>
</tr>
<tr class="row-even"><td><p>rsvd</p></td>
<td><p>5</p></td>
<td><p>Reserved.</p></td>
</tr>
</tbody>
</table>
<p><strong>Example of CSI header information &amp; raw data</strong></p>
<p>The following is a comparison of CSI buffer content and parsed CSI header information:</p>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="../../_images/comparison_between_parsed_csi_header_information_data_and_csi_buffer_data.svg"><img alt="../../_images/comparison_between_parsed_csi_header_information_data_and_csi_buffer_data.svg" height="341" src="../../_images/comparison_between_parsed_csi_header_information_data_and_csi_buffer_data.svg" width="758" /></a>
<figcaption>
<p><span class="caption-text">Comparison between the parsed CSI header information and the data in the CSI buffer</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="csi-raw-data-layout">
<h4>CSI Raw Data Layout<a class="headerlink" href="#csi-raw-data-layout" title="Link to this heading"></a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-2-2-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-2" name="2-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-2-2-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-3" name="2-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><p>A tone index of -20MHz~0 corresponds to 64:127, and 0~20MHz corresponds to 0:63.</p>
<ul class="simple">
<li><p>legacy 20MHz: tone_index (102, 103, …, 127, 1, 2, …, 26)</p></li>
<li><p>non-legacy 20MHz: tone_index (100, 101, 102, 103, …, 127, 1, 2, …, 26, 27, 28)</p></li>
<li><p>legacy 40MHz: tone_index (70, 71, …, 94, 95, 97, 98, …, 122, 6, 7, …, 30, 31, 33, 34, …, 57, 58)</p></li>
<li><p>non-legacy 40MHz: tone_index (71, 72, …, 127, 1, 2, …, 56, 57)</p></li>
</ul>
<p><strong>Example of CSI Raw Data (without Decimation): 20MHz</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a VHT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 1 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id9">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_without_decimation_dplus.svg"><img alt="../../_images/csi_raw_data_layout_without_decimation_dplus.svg" height="376" src="../../_images/csi_raw_data_layout_without_decimation_dplus.svg" width="757" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (without decimation)</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>Example of CSI Raw Data (with Decimation): 20MHz</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a VHT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 3 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12. Select tone idx based on the principle of <em>tone_idx%group_num==0</em>.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id10">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_with_decimation_dplus.svg"><img alt="../../_images/csi_raw_data_layout_with_decimation_dplus.svg" height="96" src="../../_images/csi_raw_data_layout_with_decimation_dplus.svg" width="1135" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (with decimation)</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>CSI Data Parsing Guide</strong></p>
<p>Extract the first 4 bytes [f7 fd 0d ed] from CSI raw data and decode I/Q components as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// 16-bit to float (Q5.11)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_16</span><span class="p">(</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x8000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xffff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">11</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">11</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 8-bit to float (Q5.3)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_8</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">   </span><span class="cm">/* accuracy = 1: S(16,11) */</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">Q_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfdf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">I_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed0d</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(16-bit): I=%04x Q=%04x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_16</span><span class="p">,</span><span class="w"> </span><span class="n">Q_16</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">I_16</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">Q_16</span><span class="p">));</span>

<span class="w">   </span><span class="cm">/* accuracy = 0: S(8,3) */</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfd</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0d</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_1</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_1</span><span class="p">));</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_2</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_2</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">//CSI(16-bit): I=ef0d Q=fdf7 -&gt; (-2.368652, -0.254395j)</span>
<span class="c1">//CSI(8-bit): I=fd Q=f7 -&gt; (-0.375000, -1.125000j)</span>
<span class="c1">//CSI(8-bit): I=ed Q=0d -&gt; (-2.375000, 1.625000j)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><p>A tone index of 0~20MHz corresponds to 0:63.</p>
<p><strong>Example of CSI Raw Data (without Decimation)</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a HT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 1 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id11">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg"><img alt="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg" height="294" src="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg" width="757" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (without decimation)</span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>Example of CSI Raw Data (with Decimation)</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a HT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 3 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12. The total subcarriers number <cite>= ceil((tone_num/2)/group_num) * 2 = ceil(56/2/16)*2 = 4</cite>.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg"><img alt="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg" height="96" src="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg" width="757" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (with decimation)</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>CSI Data Parsing Guide</strong></p>
<p>Extract the first 4 bytes [f7 fd 0d ed] from CSI raw data and decode I/Q components as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// 16-bit to float (Q4.12)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_16</span><span class="p">(</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x8000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xffff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 8-bit to float (Q4.4)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_8</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">   </span><span class="cm">/* accuracy = 1: S(16,12) */</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">Q_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfdf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">I_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed0d</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(16-bit): I=%04x Q=%04x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_16</span><span class="p">,</span><span class="w"> </span><span class="n">Q_16</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">I_16</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">Q_16</span><span class="p">));</span>

<span class="w">   </span><span class="cm">/* accuracy = 0: S(8,4) */</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfd</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0d</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_1</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_1</span><span class="p">));</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_2</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_2</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">//CSI(16-bit): I=ef0d Q=fdf7 -&gt; (-1.184326, -0.127197j)</span>
<span class="c1">//CSI(8-bit): I=fd Q=f7 -&gt; (-0.187500, -0.562500j)</span>
<span class="c1">//CSI(8-bit): I=ed Q=0d -&gt; (-1.187500, 0.812500j)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-2" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-2" name="2-2" role="tabpanel" tabindex="0"><p>A tone index of 0~20MHz corresponds to 0:63.</p>
<p><strong>Example of CSI Raw Data (without Decimation)</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a HT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 1 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id13">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg"><img alt="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg" height="294" src="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg" width="757" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (without decimation)</span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>Example of CSI Raw Data (with Decimation)</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a HT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 3 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12. The total subcarriers number <cite>= ceil((tone_num/2)/group_num) * 2 = ceil(56/2/16)*2 = 4</cite>.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id14">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg"><img alt="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg" height="96" src="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg" width="757" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (with decimation)</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>CSI Data Parsing Guide</strong></p>
<p>Extract the first 4 bytes [f7 fd 0d ed] from CSI raw data and decode I/Q components as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// 16-bit to float (Q4.12)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_16</span><span class="p">(</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x8000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xffff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 8-bit to float (Q4.4)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_8</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">   </span><span class="cm">/* accuracy = 1: S(16,12) */</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">Q_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfdf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">I_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed0d</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(16-bit): I=%04x Q=%04x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_16</span><span class="p">,</span><span class="w"> </span><span class="n">Q_16</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">I_16</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">Q_16</span><span class="p">));</span>

<span class="w">   </span><span class="cm">/* accuracy = 0: S(8,4) */</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfd</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0d</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_1</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_1</span><span class="p">));</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_2</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_2</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">//CSI(16-bit): I=ef0d Q=fdf7 -&gt; (-1.184326, -0.127197j)</span>
<span class="c1">//CSI(8-bit): I=fd Q=f7 -&gt; (-0.187500, -0.562500j)</span>
<span class="c1">//CSI(8-bit): I=ed Q=0d -&gt; (-1.187500, 0.812500j)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-3" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-3" name="2-3" role="tabpanel" tabindex="0"><p>A tone index of 0~20MHz corresponds to 0:63.</p>
<p><strong>Example of CSI Raw Data (without Decimation)</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a HT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 1 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id15">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg"><img alt="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg" height="294" src="../../_images/csi_raw_data_layout_without_decimation_lite_smart.svg" width="757" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (without decimation)</span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>Example of CSI Raw Data (with Decimation)</strong></p>
<p>Each subcarrier (tone) has an Nrx*Nsts CSI matrix. Take a HT MIMO 1x2 matrix as an example (<code class="docutils literal notranslate"><span class="pre">group_num</span></code>: 3 + <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>: 0), the sequences of H are H11 and H12. The total subcarriers number <cite>= ceil((tone_num/2)/group_num) * 2 = ceil(56/2/16)*2 = 4</cite>.</p>
<p>The layout of CSI raw data is:</p>
<figure class="align-center" id="id16">
<a class="reference internal image-reference" href="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg"><img alt="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg" height="96" src="../../_images/csi_raw_data_layout_with_decimation_lite_smart.svg" width="757" /></a>
<figcaption>
<p><span class="caption-text">CSI raw data layout (with decimation)</span><a class="headerlink" href="#id16" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>CSI Data Parsing Guide</strong></p>
<p>Extract the first 4 bytes [f7 fd 0d ed] from CSI raw data and decode I/Q components as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// 16-bit to float (Q4.12)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_16</span><span class="p">(</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x8000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xffff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 8-bit to float (Q4.4)</span>
<span class="kt">float</span><span class="w"> </span><span class="nf">get_csi_val_8</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0xff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">   </span><span class="cm">/* accuracy = 1: S(16,12) */</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">Q_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfdf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">I_16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed0d</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(16-bit): I=%04x Q=%04x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_16</span><span class="p">,</span><span class="w"> </span><span class="n">Q_16</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">I_16</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_16</span><span class="p">(</span><span class="n">Q_16</span><span class="p">));</span>

<span class="w">   </span><span class="cm">/* accuracy = 0: S(8,4) */</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf7</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfd</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Q_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0d</span><span class="p">;</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">I_8_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xed</span><span class="p">;</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_1</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_1</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_1</span><span class="p">));</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;CSI(8-bit): I=%02x Q=%02x -&gt; (%f, %fj)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">I_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">Q_8_2</span><span class="p">,</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">I_8_2</span><span class="p">),</span><span class="w"> </span><span class="n">get_csi_val_8</span><span class="p">(</span><span class="n">Q_8_2</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">//CSI(16-bit): I=ef0d Q=fdf7 -&gt; (-1.184326, -0.127197j)</span>
<span class="c1">//CSI(8-bit): I=fd Q=f7 -&gt; (-0.187500, -0.562500j)</span>
<span class="c1">//CSI(8-bit): I=ed Q=0d -&gt; (-1.187500, 0.812500j)</span>
</pre></div>
</div>
</div></div>
</section>
</section>
<section id="number-of-subcarriers-for-csi-raw-data">
<h3>Number of Subcarriers for CSI Raw Data<a class="headerlink" href="#number-of-subcarriers-for-csi-raw-data" title="Link to this heading"></a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-3-3-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-2" name="3-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-3-3-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-3" name="3-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><table class="docutils align-default" id="id17" style="width: 100%">
<caption><span class="caption-text">{N_tone(BW) * group_num}</span><a class="headerlink" href="#id17" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>BW</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>1/2</p></th>
<th class="head"><p>1/4</p></th>
<th class="head"><p>1/8</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Non-HT</p></td>
<td><p>20M</p></td>
<td><p>52</p></td>
<td><p>26</p></td>
<td><p>12</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>HT</p></td>
<td><p>20M</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>VHT</p></td>
<td><p>20M</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>Non-HT</p></td>
<td><p>40M</p></td>
<td><p>104</p></td>
<td><p>52</p></td>
<td><p>24</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-even"><td><p>HT</p></td>
<td><p>40M</p></td>
<td><p>114</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
</tr>
<tr class="row-odd"><td><p>VHT</p></td>
<td><p>40M</p></td>
<td><p>114</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><table class="docutils align-default" id="id18" style="width: 100%">
<caption><span class="caption-text">{N_tone(BW) * group_num}</span><a class="headerlink" href="#id18" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>1</p></th>
<th class="head"><p>1/2</p></th>
<th class="head"><p>1/4</p></th>
<th class="head"><p>1/16</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Non-HT</p></td>
<td><p>52</p></td>
<td><p>26</p></td>
<td><p>14</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>HT</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>HE</p></td>
<td><p>242</p></td>
<td><p>122</p></td>
<td><p>62</p></td>
<td><p>16</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-3-3-2" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-2" name="3-2" role="tabpanel" tabindex="0"><table class="docutils align-default" id="id19" style="width: 100%">
<caption><span class="caption-text">{N_tone(BW) * group_num}</span><a class="headerlink" href="#id19" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>1</p></th>
<th class="head"><p>1/2</p></th>
<th class="head"><p>1/4</p></th>
<th class="head"><p>1/16</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Non-HT</p></td>
<td><p>52</p></td>
<td><p>26</p></td>
<td><p>14</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>HT</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>HE</p></td>
<td><p>242</p></td>
<td><p>122</p></td>
<td><p>62</p></td>
<td><p>16</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-3-3-3" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-3" name="3-3" role="tabpanel" tabindex="0"><table class="docutils align-default" id="id20" style="width: 100%">
<caption><span class="caption-text">{N_tone(BW) * group_num}</span><a class="headerlink" href="#id20" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>1</p></th>
<th class="head"><p>1/2</p></th>
<th class="head"><p>1/4</p></th>
<th class="head"><p>1/16</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Non-HT</p></td>
<td><p>52</p></td>
<td><p>26</p></td>
<td><p>14</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>HT</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>VHT</p></td>
<td><p>56</p></td>
<td><p>28</p></td>
<td><p>14</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>HE</p></td>
<td><p>242</p></td>
<td><p>122</p></td>
<td><p>62</p></td>
<td><p>16</p></td>
</tr>
</tbody>
</table>
</div></div>
</section>
</section>
<section id="wifi-reg-event-handler">
<h2>wifi_reg_event_handler<a class="headerlink" href="#wifi-reg-event-handler" title="Link to this heading"></a></h2>
<ul>
<li><p>Function prototype:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">wifi_reg_event_handler</span><span class="p">(</span><span class="n">u32</span><span class="w"> </span><span class="n">event_cmds</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">handler_func</span><span class="p">)(</span><span class="n">s8</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_data</span><span class="p">),</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">handler_user_data</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Description: register a callback function.</p>
<dl class="field-list simple">
<dt class="field-odd">event_cmds<span class="colon">:</span></dt>
<dd class="field-odd"><p>parameter in, u32 event_cmds &gt;&gt; RTW_EVENT_CSI_DONE</p>
</dd>
<dt class="field-even">handler_func<span class="colon">:</span></dt>
<dd class="field-even"><p>parameter in, function pointer &gt;&gt; function name</p>
</dd>
<dt class="field-odd">handler_user_data<span class="colon">:</span></dt>
<dd class="field-odd"><p>parameter in, void *handler_user_data generally points to user data &gt;&gt; NULL</p>
</dd>
</dl>
</li>
<li><p>For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* callback function example */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">example_callback_func</span><span class="p">(</span><span class="n">s8</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">buf_len</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userdata</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">UNUSED</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="w">    </span><span class="n">UNUSED</span><span class="p">(</span><span class="n">buf_len</span><span class="p">);</span>
<span class="w">    </span><span class="n">UNUSED</span><span class="p">(</span><span class="n">flags</span><span class="p">);</span>
<span class="w">    </span><span class="n">UNUSED</span><span class="p">(</span><span class="n">userdata</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* do something */</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* register wifi event callback function */</span>
<span class="n">wifi_reg_event_handler</span><span class="p">(</span><span class="n">Element_ID</span><span class="p">,</span><span class="w"> </span><span class="n">example_callback_func</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="wifi-unreg-event-handler">
<h2>wifi_unreg_event_handler<a class="headerlink" href="#wifi-unreg-event-handler" title="Link to this heading"></a></h2>
<ul>
<li><p>Function prototype:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">wifi_unreg_event_handler</span><span class="p">(</span><span class="n">u32</span><span class="w"> </span><span class="n">event_cmds</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">handler_func</span><span class="p">)(</span><span class="n">s8</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_data</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>Description: release a callback function.</p>
<dl class="field-list simple">
<dt class="field-odd">event_cmds<span class="colon">:</span></dt>
<dd class="field-odd"><p>parameter in, u32 event_cmds &gt;&gt; RTW_EVENT_CSI_DONE</p>
</dd>
<dt class="field-even">handler_func<span class="colon">:</span></dt>
<dd class="field-even"><p>parameter in, function pointer &gt;&gt; function name</p>
</dd>
</dl>
</li>
<li><p>For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* release wifi event callback function */</span>
<span class="n">wifi_unreg_event_handler</span><span class="p">(</span><span class="n">RTW_EVENT_CSI_DONE</span><span class="p">,</span><span class="w"> </span><span class="n">example_callback_func</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="wi-fi-csi-usage-notes">
<h1>Wi-Fi CSI Usage Notes<a class="headerlink" href="#wi-fi-csi-usage-notes" title="Link to this heading"></a></h1>
<section id="basic-requirements">
<h2>Basic Requirements<a class="headerlink" href="#basic-requirements" title="Link to this heading"></a></h2>
<ul>
<li><p>Parameter configurations for different CSI methods should follow example in <a class="reference internal" href="#collecting-csi-from-rx-ack-packet-response-mode"><span class="std std-ref">Collect CSI from Rx ACK Packet in Rx Response Mode</span></a>, <a class="reference internal" href="#collecting-csi-from-rx-broadcast-packet-normal-mode"><span class="std std-ref">Collect CSI from Rx Broadcast Packet in Rx Normal Mode</span></a> and <a class="reference internal" href="#collecting-csi-from-rx-packet-normal-mode"><span class="std std-ref">Collect CSI from Rx packet in Rx Normal Mode</span></a>.</p></li>
<li><p><strong>Disable power saving mode</strong> before enabling Wi-Fi CSI function.</p>
<ul>
<li><p><strong>How to disable</strong>: Navigate to <code class="docutils literal notranslate"><span class="pre">component/soc/amebaxxx/usrcfg/ameba_wificfg.c</span></code>, locate the <code class="xref py py-func docutils literal notranslate"><span class="pre">wifi_set_user_config()</span></code> and modify as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">wifi_user_config</span><span class="p">.</span><span class="n">lps_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">wifi_user_config</span><span class="p">.</span><span class="n">lps_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RTW_PS_MODE_ACTIVE</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><strong>Mandatory parameters</strong>: <em>data_rate</em> and must set to be greater than or equal to OFDM rate.</p></li>
<li><p><strong>Optional parameters</strong>: <em>group_num</em>, <em>accuarcy</em>, <em>ch_opt</em>, <em>csi_role</em>, <em>trig_period</em>, <em>data_bw</em>, <em>trig_frame_xx</em>, <em>trig_flag</em>, <em>multi_type</em> and can be configured as needed.</p></li>
</ul>
</section>
<section id="method4-design-considerations">
<h2>METHOD4 Design Considerations<a class="headerlink" href="#method4-design-considerations" title="Link to this heading"></a></h2>
<p><strong>METHOD1</strong>, <strong>METHOD2</strong>, <strong>METHOD3</strong> and <strong>METHOD5</strong> are normal interactions between STA and AP in infrastructure mode, Realtek driver will construct the MAC address of CSI triggering frame in accordance with Wi-Fi protocol standards.</p>
<p>For example, if the Ameba chip acts as the STA role, the frame format specified by the Wi-Fi standards is shown in the following figure:</p>
<figure class="align-center" id="id21">
<a class="reference internal image-reference" href="../../_images/interaction_between_sta_and_ap_infrastructure_mode.svg"><img alt="../../_images/interaction_between_sta_and_ap_infrastructure_mode.svg" height="176" src="../../_images/interaction_between_sta_and_ap_infrastructure_mode.svg" width="705" /></a>
<figcaption>
<p><span class="caption-text">Interaction between STA and AP in infrastructure mode</span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>However, <strong>METHOD4</strong> involves interaction between STAs in infrastructure mode, which is not fully compliant with Wi-Fi protocol standards. To ensure other STAs can receive packets from the target STA, the Ameba chip will forge CSI triggering frame by modifying the MAC address fields of the CSI trigger frames to <code class="docutils literal notranslate"><span class="pre">A1=broadcast</span> <span class="pre">address</span></code> and <code class="docutils literal notranslate"><span class="pre">A2=BSSID</span></code>. This ensures that the MAC layer of Realtek receiving devices does not filter out the packets.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only when the Realtek MAC layer receives the Wi-Fi packet will it trigger the CSI circuit to capture CSI reports.</p>
</div>
<figure class="align-center" id="id22">
<a class="reference internal image-reference" href="../../_images/interaction_between_sta_and_sta_infrastructure_mode.svg"><img alt="../../_images/interaction_between_sta_and_sta_infrastructure_mode.svg" height="298" src="../../_images/interaction_between_sta_and_sta_infrastructure_mode.svg" width="864" /></a>
<figcaption>
<p><span class="caption-text">Interaction between STA and STA in infrastructure mode</span><a class="headerlink" href="#id22" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Additionally, <strong>METHOD4</strong> has another issue: as shown in the figure above, Ameba2 receives Wi-Fi packets from both Ameba3 and Ameba1 with identical content, making it impossible for Ameba2 to distinguish whether the CSI packet was triggered by Ameba1 or Ameba3. To resolve this issue, we will fill the unique identifier <code class="docutils literal notranslate"><span class="pre">trig_flag</span></code> into the Fragment Number subfield in Sequence Control filed of Wi-Fi packet, and this identifier will be carried in the corresponding CSI packet. The application layer can distinguish which device the CSI belongs to base on <code class="docutils literal notranslate"><span class="pre">trig_flag</span></code>.</p>
<figure class="align-center" id="id23">
<a class="reference internal image-reference" href="../../_images/mapping_trig_flag_with_sta.svg"><img alt="../../_images/mapping_trig_flag_with_sta.svg" height="598" src="../../_images/mapping_trig_flag_with_sta.svg" width="988" /></a>
<figcaption>
<p><span class="caption-text">Mapping of trig_flag with STAx</span><a class="headerlink" href="#id23" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="compiling-wi-fi-csi-image">
<h2>Compiling Wi-Fi CSI Image<a class="headerlink" href="#compiling-wi-fi-csi-image" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">{SDK}/amebaxxx_gcc_project</span></code> and run the following command:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="o">/</span><span class="n">menuconfig</span><span class="p">.</span><span class="n">py</span>
</pre></div>
</div>
</li>
<li><p>Locate <span class="menuselection">CONFIG WIFI &gt; Enable CSI</span>, select <span class="menuselection">Enable CSI</span>, then save and exit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">----</span><span class="n">Connectivity</span> <span class="n">config</span><span class="o">----</span>
    <span class="n">CONFIG</span> <span class="n">WHC</span> <span class="n">INTF</span> <span class="o">---&gt;</span>
<span class="hll">    <span class="n">CONFIG</span> <span class="n">WIFI</span> <span class="o">---&gt;</span>
</span>             <span class="n">SDK</span> <span class="n">MODE</span> <span class="p">(</span><span class="n">NORMAL</span> <span class="n">INIC</span><span class="p">)</span>  <span class="o">---&gt;</span>
      <span class="p">[</span> <span class="p">]</span>    <span class="n">Enable</span> <span class="n">WPS</span>
<span class="hll">      <span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Enable</span> <span class="n">CSI</span>
</span>      <span class="p">[</span> <span class="p">]</span>    <span class="n">Enable</span> <span class="n">ANTDIV</span>
      <span class="o">---</span>
    <span class="n">CONFIG</span> <span class="n">BT</span> <span class="o">---&gt;</span>
    <span class="o">...</span> <span class="o">---&gt;</span>
</pre></div>
</div>
</li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">{SDK}/amebaxxx_gcc_project</span></code> again and run the following command:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="n">wifi_csi</span><span class="w">     </span><span class="cm">/* compile image with Wi-Fi CSI example */</span>
<span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">py</span><span class="w">                 </span><span class="cm">/* compile image without Wi-Fi CSI example */</span>
</pre></div>
</div>
</li>
</ol>
<p>The image bin files (<strong>xxx_app.bin</strong> &amp; <strong>xxx_boot_all.bin</strong>) can be found in <code class="docutils literal notranslate"><span class="pre">{SDK}/amebaxxx_gcc_project</span></code> after compile done.</p>
</section>
</section>
<section id="wi-fi-csi-example">
<h1>Wi-Fi CSI Example<a class="headerlink" href="#wi-fi-csi-example" title="Link to this heading"></a></h1>
<p>This section describes the framework and implementation details of the Wi-Fi CSI example. The file path is <code class="docutils literal notranslate"><span class="pre">{SDK}\component\example\wifi\wifi_csi</span></code>.</p>
<section id="overview-of-wi-fi-csi-example">
<h2>Overview of Wi-Fi CSI Example<a class="headerlink" href="#overview-of-wi-fi-csi-example" title="Link to this heading"></a></h2>
<figure class="align-center" id="id24">
<a class="reference internal image-reference" href="../../_images/csi_example_flowchart.svg"><img alt="../../_images/csi_example_flowchart.svg" height="537" src="../../_images/csi_example_flowchart.svg" width="728" /></a>
<figcaption>
<p><span class="caption-text">Wi-Fi CSI example implementation block diagram</span><a class="headerlink" href="#id24" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="details-of-wi-fi-csi-example">
<h2>Details of Wi-Fi CSI Example<a class="headerlink" href="#details-of-wi-fi-csi-example" title="Link to this heading"></a></h2>
<p>For guidance on integrating the Ameba SDK and compiling examples, refer to <a class="reference internal" href="../0_sdk_example/1_sdk_example_toprst.html#application-example"><span class="std std-ref">Application Example</span></a>. The following section details the implementation specifics of the Wi-Fi CSI example.</p>
<section id="example-initialization">
<h3>Example Initialization<a class="headerlink" href="#example-initialization" title="Link to this heading"></a></h3>
<p>The entry function for the Wi-Fi CSI example is defined in <code class="xref py py-func docutils literal notranslate"><span class="pre">app_example()</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">app_example</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">example_wifi_csi</span><span class="p">();</span><span class="w">  </span><span class="cm">/* calling the entry function of wifi CSI example */</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="wi-fi-csi-entry-function">
<h3>Wi-Fi CSI Entry Function<a class="headerlink" href="#wi-fi-csi-entry-function" title="Link to this heading"></a></h3>
<p>After executing Wi-Fi CSI example entry function: <code class="xref py py-func docutils literal notranslate"><span class="pre">example_wifi_csi()</span></code>，a CSI processing thread is created.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_wifi_csi</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rtos_task_create</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="p">((</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="s">&quot;wifi_csi_thread&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">wifi_csi_thread</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">RTK_LOGA</span><span class="p">(</span><span class="n">NOTAG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n\r</span><span class="s">%s rtos_task_create(wifi_csi_thread) failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">__FUNCTION__</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="wi-fi-csi-thread">
<h3>Wi-Fi CSI Thread<a class="headerlink" href="#wi-fi-csi-thread" title="Link to this heading"></a></h3>
<ol class="arabic">
<li><p>Waiting for Wi-Fi power-up and connection success.</p>
<ol class="loweralpha">
<li><p>If the SoftAP role is enabled, Wi-Fi CSI function will only be initiated by the SoftAP, regardless of whether STA role is in an associated state. Once other devices connect to the SoftAP role, the first connected device will be selected to enable the Wi-Fi CSI function.</p>
<p>If  no other devices connect to the SoftAP role, execute <code class="docutils literal notranslate"><span class="pre">rtos_time_delay_ms(2000)</span></code>.</p>
</li>
<li><p>If the SoftAP role is not enabled, the Wi-Fi CSI function will be enabled after the STA role connects to a realAP.</p>
<p>If STA role is not connected, execute <code class="docutils literal notranslate"><span class="pre">rtos_time_delay_ms(2000)</span></code>.</p>
</li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="nl">NEXT</span><span class="p">:</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wifi_is_running</span><span class="p">(</span><span class="n">SOFTAP_WLAN_INDEX</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="n">wifi_get_associated_client_list</span><span class="p">(</span><span class="o">&amp;</span><span class="n">client_info</span><span class="p">);</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">client_info</span><span class="p">.</span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">memcpy</span><span class="p">(</span><span class="n">act_param</span><span class="p">.</span><span class="n">mac_addr</span><span class="p">,</span><span class="w"> </span><span class="n">client_info</span><span class="p">.</span><span class="n">mac_list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">octet</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="w">            </span><span class="n">RTK_LOGA</span><span class="p">(</span><span class="n">NOTAG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;### SOFTAP Break ###</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="n">rtos_time_delay_ms</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span><span class="w">  </span><span class="cm">/* 2s */</span>
<span class="w">         </span><span class="k">goto</span><span class="w"> </span><span class="n">NEXT</span><span class="p">;</span>

<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wifi_is_running</span><span class="p">(</span><span class="n">STA_WLAN_INDEX</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">wifi_get_join_status</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">RTW_JOINSTATUS_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">u32</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">LwIP_GetIP</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">IP_ADDR_INVALID</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="n">rtos_time_delay_ms</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span><span class="w">  </span><span class="cm">/* 2s */</span>
<span class="w">         </span><span class="n">RTK_LOGA</span><span class="p">(</span><span class="n">NOTAG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;### STA Break ###</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">         </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">rtos_time_delay_ms</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span><span class="w">  </span><span class="cm">/* 2s */</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Registering a Wi-Fi CSI callback function <code class="xref py py-func docutils literal notranslate"><span class="pre">example_wifi_csi_report_cb()</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* register wifi event callback function */</span>
<span class="n">wifi_reg_event_handler</span><span class="p">(</span><span class="n">RTW_EVENT_CSI_DONE</span><span class="p">,</span><span class="w"> </span><span class="n">example_wifi_csi_report_cb</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Initializing a semephore <code class="docutils literal notranslate"><span class="pre">wc_ready_sema</span></code>, and you should use semaphore to signal that a Wi-Fi CSI report is ready.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* should use semaphore to indicate the occurrence of a Wi-Fi event</span>
<span class="cm">* This example uses the semaphore `wc_ready_sema` to signal that a Wi-Fi CSI report is ready.</span>
<span class="cm">*/</span>
<span class="n">rtos_sema_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wc_ready_sema</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">wc_ready_sema</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">RTK_LOGE</span><span class="p">(</span><span class="n">NOTAG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">Init wc_ready_sema failed</span><span class="se">\r\n\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Wi-Fi CSI parameters assignment (example configuration for <strong>METHOD1</strong>/ <strong>METHOD2</strong>).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* config csi parameters */</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">group_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSI_GROUP_NUM_1</span><span class="p">;</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSI_MODE_RX_RESP</span><span class="p">;</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSI_ACCU_1BYTE</span><span class="p">;</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">trig_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w">     </span><span class="cm">/* units: 320us */</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">data_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MGN_6M</span><span class="p">;</span><span class="w">    </span><span class="cm">/* ofdm 6 mpbs*/</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">trig_frame_mgnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span><span class="cm">/* no need for rx resp mode, default 0*/</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">trig_frame_ctrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span><span class="cm">/* no need for rx resp mode, default 0*/</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">trig_frame_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span><span class="cm">/* no need for rx resp mode, default 0*/</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">csi_role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSI_OP_ROLE_TRX</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>Configuring Wi-Fi CSI parameters and enabling Wi-Fi CSI.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* cis cfg and csi en */</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSI_ACT_CFG</span><span class="p">;</span><span class="w">  </span><span class="cm">/* csi cfg */</span>
<span class="n">wifi_csi_config</span><span class="p">(</span><span class="o">&amp;</span><span class="n">act_param</span><span class="p">);</span>

<span class="n">act_param</span><span class="p">.</span><span class="n">act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSI_ACT_EN</span><span class="p">;</span><span class="w">  </span><span class="cm">/* csi en */</span>
<span class="n">act_param</span><span class="p">.</span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">wifi_csi_config</span><span class="p">(</span><span class="o">&amp;</span><span class="n">act_param</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Waiting for the semaphore <code class="docutils literal notranslate"><span class="pre">wc_ready_sema</span></code> to be ready and calling API <code class="xref py py-func docutils literal notranslate"><span class="pre">wifi_csi_report()</span></code> to fetch the Wi-Fi CSI packet.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="cm">/* example: when wifi csi rx done, call csi report handle function. */</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rtos_sema_take</span><span class="p">(</span><span class="n">wc_ready_sema</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">rtos_sema_delete</span><span class="p">(</span><span class="n">wc_ready_sema</span><span class="p">);</span>

<span class="w">      </span><span class="n">act_param</span><span class="p">.</span><span class="n">act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSI_ACT_EN</span><span class="p">;</span><span class="w">  </span><span class="cm">/* csi dis */</span>
<span class="w">      </span><span class="n">act_param</span><span class="p">.</span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="n">wifi_csi_config</span><span class="p">(</span><span class="o">&amp;</span><span class="n">act_param</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="n">csi_buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtos_mem_malloc</span><span class="p">(</span><span class="n">csi_data_len</span><span class="p">);</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">csi_buf</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">wifi_csi_report</span><span class="p">(</span><span class="n">csi_data_len</span><span class="p">,</span><span class="w"> </span><span class="n">csi_buf</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">len</span><span class="p">);</span>

<span class="w">      </span><span class="cm">/*do something for handing csi info: like show csi data */</span>
<span class="w">      </span><span class="n">wifi_csi_show</span><span class="p">(</span><span class="n">csi_buf</span><span class="p">);</span>

<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">RTK_LOGE</span><span class="p">(</span><span class="n">NOTAG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s"> csi_buf malloc fail</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">csi_buf</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">rtos_mem_free</span><span class="p">(</span><span class="n">csi_buf</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Exit</p>
<ol class="loweralpha simple">
<li><p>Disable Wi-Fi CSI function and release the Wi-Fi CSI callback function.</p></li>
<li><p>Free the semaphore <code class="docutils literal notranslate"><span class="pre">wc_ready_sema</span></code>.</p></li>
<li><p>Delete the task.</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* unregister wifi event callback function */</span>
<span class="n">wifi_unreg_event_handler</span><span class="p">(</span><span class="n">RTW_EVENT_CSI_DONE</span><span class="p">,</span><span class="w"> </span><span class="n">example_wifi_csi_report_cb</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wc_ready_sema</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">rtos_sema_delete</span><span class="p">(</span><span class="n">wc_ready_sema</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">rtos_task_delete</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="wi-fi-csi-callback-function">
<h3>Wi-Fi CSI Callback Function<a class="headerlink" href="#wi-fi-csi-callback-function" title="Link to this heading"></a></h3>
<p>When the Wi-Fi driver is ready with a CSI report, it will utilize the Wi-Fi CSI callback function to send a signal to the APP.
For instance, the APP can up the semaphore within the callback function to trigger the execution of <code class="xref py py-func docutils literal notranslate"><span class="pre">wifi_csi_thread()</span></code> for fetching a CSI report.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Avoid performing heavy operations in the callback function to prevent impacting reception performance.</p></li>
<li><p>The APP can can use the parameter <code class="docutils literal notranslate"><span class="pre">flags</span></code>, which indicates the size of the current Wi-Fi CSI packet.</p></li>
</ul>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_wifi_csi_report_cb</span><span class="p">(</span><span class="n">s8</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">buf_len</span><span class="p">,</span><span class="w"> </span><span class="n">s32</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userdata</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
<span class="w">   </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">buf_len</span><span class="p">;</span>
<span class="w">   </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">userdata</span><span class="p">;</span>
<span class="w">   </span><span class="n">rtos_sema_give</span><span class="p">(</span><span class="n">wc_ready_sema</span><span class="p">);</span><span class="w">  </span><span class="cm">/* trigger thread */</span>
<span class="w">   </span><span class="n">csi_data_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flags</span><span class="p">;</span><span class="w">           </span><span class="cm">/* APP can use for malloc csi_buf */</span>
<span class="w">   </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="0_wifi_csi_index.html" class="btn btn-neutral float-left" title="Wi-Fi CSI" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../2_wifi_adaptivity_test/0_wifi_adaptivity_index.html" class="btn btn-neutral float-right" title="Wi-Fi Adaptivity Test" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Realsil.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>

    <!-- 问题反馈按钮和对话框 -->
    

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
     

    <!-- templates/sidebar_toggle.html -->

<button id="sidebar-toggle-button" aria-label="Toggle sidebar"></button>

<script>
    function sidebarToggleButton() {
        const sidebar = document.querySelector('.wy-nav-side');
        const contentArea = document.querySelector('.wy-nav-content');
        const contentAreaWrap = document.querySelector('.wy-nav-content-wrap');
        const sidebarToggleButton = document.getElementById('sidebar-toggle-button');

        console.log('Sidebar:', sidebar);
        console.log('Content Area:', contentArea);
        console.log('Toggle Button:', sidebarToggleButton);

        if (!sidebar || !contentArea || !sidebarToggleButton) {
            console.error('One or more elements not found');
            return;
        }

        let isSidebarCollapsed = false;

        sidebarToggleButton.addEventListener('click', function() {
            document.documentElement.classList.add('sidebar-transitioning');// 添加过渡类

            if (isSidebarCollapsed) {
                document.documentElement.classList.remove('sidebar-collapsed'); // 改为使用CSS类控制

                sidebar.style.marginLeft = '0px';
                contentAreaWrap.style.marginLeft = '300px';
                contentArea.classList.remove('expanded');

                sidebarToggleButton.style.left = '300px';
            } else {
                document.documentElement.classList.add('sidebar-collapsed');

                sidebar.style.marginLeft = '-300px';
                contentAreaWrap.style.marginLeft = '0px';
                contentArea.classList.add('expanded');

                sidebarToggleButton.style.left = '0px';
            }

            // 同步状态
            isSidebarCollapsed = !isSidebarCollapsed;

            // 过渡结束后移除标记
            setTimeout(() => {
                document.documentElement.classList.remove('sidebar-transitioning');
            }, 300); // 必须与过渡时间匹配
        });
    }
</script>

<style>
    #sidebar-toggle-button {
        position: fixed;
        left: 300px;
        top: 0;
        z-index: 1002;

        width: 4px;  /* 竖线宽度 */
        /* 增加热区 */
        padding: 0 15px; /* 左右各扩展12px点击区域 */
        margin: 0 -15px; /* 抵消padding带来的位置偏移 */
        clip-path: inset(0 -15px); /* 保持视觉宽度4px */

        height: 100vh; /* 竖线高度 */
        background: #2d2d2d;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: none;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);

        /* 隐藏原始文字 */
        color: transparent;
        font-size: 0;

        /* 修正交互区域 */
        padding: 0;
        margin: 0;

        /* 新增：防止内容溢出 */
        overflow: visible;

        /* 调整箭头定位 */
        &::before {
            top: 50vh; /* 改为视口中点定位 */
            transform: translateY(-50%);
        }

        &::after {
            top: 50vh;
            transform: translateY(-50%) rotate(45deg);
        }
    }

    /* 动态箭头指示器 */
    #sidebar-toggle-button::before {
        content: '‹';
        position: absolute;
        left: 6px;
        top: 50%;
        width: 24px;
        height: 24px;
        background: #3498db;
        color: white;
        font-size: 18px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transform: translateY(-50%);
        opacity: 0;
        transition: all 0.3s ease;
        pointer-events: none;
    }

    #sidebar-toggle-button::after {
        content: '';
        position: absolute;

        left: -15px;  /* 向左扩展12px */
        right: -15px; /* 向右扩展12px */

        top: 50%;
        width: 8px;
        height: 8px;
        border: 2px solid white;
        border-width: 2px 2px 0 0;
        transform: translateY(-50%) rotate(45deg);
        opacity: 0;
        transition: all 0.3s ease;
    }

    /* 悬停效果 */
    #sidebar-toggle-button:hover {
        width: 10px;
        background: #2980b9;
    }

    /* 点击动画 */
    #sidebar-toggle-button:active {
        transform: translateY(-50%) scale(0.9);
    }
</style>

<!-- 统一移动速度 -->
<style>
    /* 统一过渡参数 */
    :root {
        --sidebar-transition: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .wy-nav-side,
    .wy-nav-content-wrap,
    #sidebar-toggle-button {
        transition: all var(--sidebar-transition) !important;
    }

    /* 按钮样式调整 */
    #sidebar-toggle-button {
        left: 300px;
        transition: left var(--sidebar-transition),
                    width 150ms ease, /* 悬停效果保持独立 */
                    background 150ms ease;
    }

    /* 折叠状态 */
    .sidebar-collapsed {
        .wy-nav-side {
            margin-left: -300px !important;
        }

        .wy-nav-content-wrap {
            margin-left: 0 !important;
        }

        #sidebar-toggle-button {
            left: 0 !important;
        }
    }

    /* 禁用点击时的过渡 */
    .sidebar-transitioning {
        .wy-nav-side,
        .wy-nav-content-wrap,
        #sidebar-toggle-button {
            transition: none !important;
        }
    }
</style>

    

    <script>
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            

            sidebarToggleButton();
        });


    </script>



</body>
</html>