

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MP Image &mdash; Ameba IoT Docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dcc6a489" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dcc6a489" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="http://172.29.57.206:5000/docs/rst_rtos/6_mass_production/1_mp_toprst.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../../_static/tabs.js?v=3030b3cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1-N MP Tool" href="../6_mptools/0_mptools_index.html" />
    <link rel="prev" title="Mass Production" href="0_mp_index.html" />
     

    

    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- 样式模板 -->
    <style>
        .wy-nav-content {
            max-width: 1100px;
             
        }

        .wy-nav-content {
            transition: margin 0.3s ease; /* 添加过渡效果 */
            margin-left: 0px !important; /* 侧边栏展开时的偏移 */
            max-width: calc(100% - 0px) !important; /* 调整最大宽度，使其与侧边栏宽度相关 */
        }

        .wy-nav-content.expanded {
            margin-left: 0 !important; /* 侧边栏收缩时内容区域回归左边 */
            max-width: 100% !important; /* 内容区域最大宽度调整 */
        }
    </style>

    <!-- 注入 TOC 映射和当前页面信息 -->
    

<!-- TOC 映射和当前文档信息 -->
<script>
// 将 Python 字典转换为 JS 对象
const TOC_TITLE_MAP = {"rst_rtos/0_ameba_product": "Products Center", "rst_rtos/0_ameba_product/0_ameba_product_center_index": "Products Center", "rst_rtos/0_ameba_sdk": "Ameba SDK", "rst_rtos/0_ameba_sdk/0_ameba_sdks_index": "Ameba SDK", "rst_rtos/0_ameba_solutions": "Ameba Solutions", "rst_rtos/0_ameba_solutions/0_ameba_solutions_index": "Ameba Solutions", "rst_rtos/0_at_command": "0.8 AT Commands", "rst_rtos/0_at_command/0_at_command_index": "0.8 AT Commands", "rst_rtos/0_build_system": "0.3 Build System", "rst_rtos/0_build_system/0_build_system_index": "0.3 Build System", "rst_rtos/0_file_system": "0.9 Virtual File System", "rst_rtos/0_file_system/0_vfs_index": "0.9 Virtual File System", "rst_rtos/0_ftl": "0.a Flash Translation Layer", "rst_rtos/0_ftl/0_ftl_index": "0.a Flash Translation Layer", "rst_rtos/0_gcc_build_environment": "0.1 GCC Build Environment", "rst_rtos/0_gcc_build_environment/0_gcc_build_index": "0.1 GCC Build Environment", "rst_rtos/0_gdb_debug": "0.2 GDB Debug", "rst_rtos/0_gdb_debug/0_gdb_debug_index": "0.2 GDB Debug", "rst_rtos/0_memory_layout": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_memory_layout/0_layout_index": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_sdk_example": "0.4 SDK Example", "rst_rtos/0_sdk_example/0_sdk_example_index": "0.4 SDK Example", "rst_rtos/0_tools": "0.7 Tools", "rst_rtos/0_tools/0_tools_index": "0.7 Tools", "rst_rtos/0_user_config": "0.6 User Config", "rst_rtos/0_user_config/0_usrcfg_index": "0.6 User Config", "rst_rtos/10_api_docs": "2.6 Wi-Fi API Reference", "rst_rtos/10_api_docs/0_api_index": "2.6 Wi-Fi API Reference", "rst_rtos/1_boot_process": "1.1 Boot Process", "rst_rtos/1_boot_process/0_boot_index": "1.1 Boot Process", "rst_rtos/1_chipen": "1.4 Chip Enable", "rst_rtos/1_chipen/0_chipen_index": "1.4 Chip Enable", "rst_rtos/1_gpio": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_gpio/0_gpio_index": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_ipc": "1.5 Inter Processor Communication", "rst_rtos/1_ipc/0_ipc_index": "1.5 Inter Processor Communication", "rst_rtos/1_mpu_cache": "1.0 Memory Management \u0026 Cache", "rst_rtos/1_mpu_cache/0_mpu_cache_index": "1.0 Memory Management \u0026 Cache", "rst_rtos/1_ota": "1.2 OTA", "rst_rtos/1_ota/0_ota_index": "1.2 OTA", "rst_rtos/1_otpc": "1.3 OTPC", "rst_rtos/1_otpc/0_otpc_index": "1.3 OTPC", "rst_rtos/1_pinmux": "1.6 Pin Multiplexing", "rst_rtos/1_pinmux/0_pinmux_index": "1.6 Pin Multiplexing", "rst_rtos/1_power_save": "1.9 Power Saving", "rst_rtos/1_power_save/0_ps_index": "1.9 Power Saving", "rst_rtos/2_whc_fullmac": "2.2 WHC FullMAC", "rst_rtos/2_whc_fullmac/0_fullmac_index": "2.2 WHC FullMAC", "rst_rtos/2_whc_wifi_bridge": "2.1 WHC Bridge", "rst_rtos/2_whc_wifi_bridge/0_wifi_bridge_index": "2.1 WHC Bridge", "rst_rtos/2_wifi_adaptivity_test": "2.5 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_adaptivity_test/0_wifi_adaptivity_index": "2.5 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_basic": "2.0 Wi-Fi Basic Mode", "rst_rtos/2_wifi_basic/0_wifi_basic_index": "2.0 Wi-Fi Basic Mode", "rst_rtos/2_wifi_csi": "2.4 Wi-Fi CSI", "rst_rtos/2_wifi_csi/0_wifi_csi_index": "2.4 Wi-Fi CSI", "rst_rtos/2_wifi_tunnel": "2.3 Wi-Fi R-Mesh", "rst_rtos/2_wifi_tunnel/0_wifi_tunnel_index": "2.3 Wi-Fi R-Mesh", "rst_rtos/3_ap_trustzone": "3.d AP Secure Service", "rst_rtos/3_ap_trustzone/0_ap_tz_index": "3.d AP Secure Service", "rst_rtos/3_crypto_engine": "3.9 Crypto Engine", "rst_rtos/3_crypto_engine/0_crypto_engine_index": "3.9 Crypto Engine", "rst_rtos/3_ecdsa_engine": "3.a ECDSA Engine", "rst_rtos/3_ecdsa_engine/0_ecdsa_index": "3.a ECDSA Engine", "rst_rtos/3_eddsa_engine": "3.b EDDSA Engine", "rst_rtos/3_eddsa_engine/0_eddsa_index": "3.b EDDSA Engine", "rst_rtos/3_rsa_engine": "3.c RSA Engine", "rst_rtos/3_rsa_engine/0_rsa_index": "3.c RSA Engine", "rst_rtos/3_security": "3.1 Security \u0026 Encryption", "rst_rtos/3_security/0_security_index": "3.1 Security \u0026 Encryption", "rst_rtos/3_trng": "3.2 True Random Number Generator", "rst_rtos/3_trng/0_trng_index": "3.2 True Random Number Generator", "rst_rtos/4_ai": "4.1 AI", "rst_rtos/4_ai/0_ai_index": "4.1 AI", "rst_rtos/4_ai_voice": "4.2 AIVoice", "rst_rtos/4_ai_voice/0_ai_voice_index": "4.2 AIVoice", "rst_rtos/4_dsp": "4.4 DSP", "rst_rtos/4_dsp/0_dsp_index": "4.4 DSP", "rst_rtos/4_multimedia": "4.3 Multimedia", "rst_rtos/4_multimedia/0_multimedia_index": "4.3 Multimedia", "rst_rtos/6_mass_production": "6.1 Mass Production", "rst_rtos/6_mass_production/0_mp_index": "6.1 Mass Production", "rst_rtos/6_mptools": "6.2 MP Tools", "rst_rtos/6_mptools/0_mptools_index": "6.2 MP Tools", "rst_rtos/7_usb": "7.1 USB Host \u0026 Device", "rst_rtos/7_usb/0_usb_index": "7.1 USB Host \u0026 Device", "rst_rtos/8_adc": "8.4 ADC", "rst_rtos/8_adc/0_adc_index": "8.4 ADC", "rst_rtos/8_cap_touch": "8.7 Cap-Touch", "rst_rtos/8_cap_touch/0_cap_touch_index": "8.7 Cap-Touch", "rst_rtos/8_dmac": "8.1 DMA Controller", "rst_rtos/8_dmac/0_dmac_index": "8.1 DMA Controller", "rst_rtos/8_ir": "8.5 IR", "rst_rtos/8_ir/0_ir_index": "8.5 IR", "rst_rtos/8_key_scan": "8.8 Key-Scan", "rst_rtos/8_key_scan/0_key_scan_index": "8.8 Key-Scan", "rst_rtos/8_lcdc": "8.a LCD Controller", "rst_rtos/8_lcdc/0_lcdc_index": "8.a LCD Controller", "rst_rtos/8_ledc": "8.6 LED Controller", "rst_rtos/8_ledc/0_ledc_index": "8.6 LED Controller", "rst_rtos/8_psram": "8.2 PSRAM", "rst_rtos/8_psram/0_psram_index": "8.2 PSRAM", "rst_rtos/8_rtc_io": "8.9 RTC-IO", "rst_rtos/8_rtc_io/0_rtc_io_index": "8.9 RTC-IO", "rst_rtos/8_thermal": "8.3 Thermal Meter", "rst_rtos/8_thermal/0_thermal_index": "8.3 Thermal Meter"};
console.log("TOC_TITLE_MAP:", TOC_TITLE_MAP);

// 获取当前页面的文档名 (例如 'rst_rtos/3_nda_secure_boot/0_secure_boot_index_nda')
const CURRENT_DOCNAME = 'rst_rtos/6_mass_production/1_mp_toprst';

// 动态查找顶级分类函数（定义为全局函数）
window.findTopLevelChapter = function(docname) {
    console.log("Attempting to find top-level chapter for:", docname);
    let bestMatch = "";
    let bestTitle = "Unknown Chapter";

    // 按路径长度降序排序以确保最长匹配
    const sortedPaths = Object.keys(TOC_TITLE_MAP).sort((a, b) => b.length - a.length);

    for (const path of sortedPaths) {
        console.log("Checking path:", path);
        if (docname === path || docname.startsWith(path + '/')) { // 子页面
            bestMatch = path;
            bestTitle = TOC_TITLE_MAP[path];
            console.log("Matched path:", path, "with title:", bestTitle);
            break;
        }
    }

    // 如果没有找到任何匹配项，则尝试更短的路径
    if (bestMatch === "") {
        const pathSegments = docname.split('/');
        while (pathSegments.length > 1) { // 至少保留根路径
            const candidate = pathSegments.join('/');
            console.log("Checking shorter path:", candidate);
            if (TOC_TITLE_MAP[candidate]) {
                bestTitle = TOC_TITLE_MAP[candidate];
                console.log("Matched shorter path:", candidate, "with title:", bestTitle);
                break;
            }
            pathSegments.pop();
        }
    }

    console.log("Final top-level chapter:", bestTitle);
    return bestTitle;
}

// 初始化时调用
document.addEventListener('DOMContentLoaded', function() {
    const topLevelChapter = findTopLevelChapter(CURRENT_DOCNAME);
    console.log("Top Level Chapter:", topLevelChapter);

    // 将顶级分类插入到DOM中（根据需要）
    const chapterElement = document.createElement('div');
    chapterElement.className = 'top-level-chapter';
    chapterElement.innerHTML = `<strong>Top Level Chapter: </strong>${topLevelChapter}`;
    document.body.appendChild(chapterElement);
});
</script>

    

    <!-- 左上角标题距离控制：Ameba IoT Docs -->
    <style>
        /* 新增的标题间距调整样式（添加在此处） */
        div[role="navigation"] > div[role="search"] {
            margin-bottom: 4px !important;
        }

        a.icon.icon-home {
            display: inline-block;
            margin-bottom: 2px !important;
        }
    </style>

    <!-- 引入功能模块 -->
    
    
<script>
    /* ====================== 嵌入式配置开始 ====================== */
    const embeddedConfig = {
        "freertos": {
            "name": "FreeRTOS",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        },
        "linux": {
            "name": "Linux",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        }
    };
    /* ====================== 嵌入式配置结束 ====================== */
</script>

<script>
    // 获取OS显示名称列表
    function getOSNames(data) {
        return Object.keys(data).map(key => data[key].name);
    }

    // 获取指定OS的语言列表
    function getLanguages(data, osKey) {
        return Object.keys(data[osKey]?.languages || {});
    }

    // 获取指定OS和语言的版本列表
    function getVersions(data, osKey, language) {
        return data[osKey]?.languages?.[language] || ['latest'];
    }

    // 根据显示名称查找OS键
    function findOSKey(data, displayName) {
        return Object.keys(data).find(key => data[key].name === displayName);
    }

    // 获取基础URL路径
    function getBaseURL() {
        const url = new URL(window.location.href);
        console.log('[DEBUG] getBaseURL:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const pathParts = url.pathname.split('/').filter(part => part !== '');
            const index = pathParts.indexOf('build');
            console.log('[DEBUG] getBaseURL0:', pathParts.slice(0, index + 1).join('/'));
            return `file://${pathParts.slice(0, index + 1).join('/')}/`;
        } else {
            // 网络路径处理
            const basePath = url.pathname.split('/')[1]; // 直接取第一个有效路径段
            console.log('[DEBUG] getBaseURL:', url.origin, basePath);
            return `${url.origin}/${basePath}/`;
        }
    }

    // 获取当前URL路径分段
    function getCurrentSegments() {
        const url = new URL(window.location.href);
        let segments = url.pathname.split('/').filter(segment => segment);


        console.log('[DEBUG] getCurrentSegments:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const index = segments.indexOf('build');
            segments = segments.slice(index + 1); // 去掉 build 及之前的路径
            console.log('[DEBUG] getCurrentSegments0:', segments);
        } else {
            // 网络路径处理
            segments = segments.slice(1); // 去掉 ameba-iot-docs/
            console.log('[DEBUG] getCurrentSegments:', segments);
        }

        return {
            osKey: segments[0] || 'freertos', // 默认为 freertos
            language: segments[1] || 'en',   // 默认为 en
            version: segments[2] || 'latest' // 默认为 latest
        };
    }

    // 绑定事件监听
    function bindEvents(baseURL, segments) {
        document.getElementById('os-selector').addEventListener('change', () => {
            const newOSKey = document.getElementById('os-selector').value;
            const availableLangs = getLanguages(embeddedConfig, newOSKey);
            const defaultLang = availableLangs[0] || 'en';
            const defaultVersion = getVersions(embeddedConfig, newOSKey, defaultLang)[0] || 'latest';
            console.log('OS Changed:', {newOSKey, defaultLang, defaultVersion});
            redirectTo(`${baseURL}${newOSKey}/${defaultLang}/${defaultVersion}/`);
        });

        document.getElementById('language-selector').addEventListener('change', () => {
            const newLang = document.getElementById('language-selector').value;
            const defaultVersion = getVersions(embeddedConfig, segments.osKey, newLang)[0] || 'latest';
            console.log('Language Changed:', {newLang, defaultVersion});
            redirectTo(`${baseURL}${segments.osKey}/${newLang}/${defaultVersion}/`);
        });

        document.getElementById('version-selector').addEventListener('change', () => {
            const newVer = document.getElementById('version-selector').value;
            console.log('Version Changed:', {newVer});
            redirectTo(`${baseURL}${segments.osKey}/${segments.language}/${newVer}/`);
        });
    }

    // 跳转函数
    function redirectTo(path) {
        const url = new URL(path, window.location.href);
        if (url.protocol === 'file:') {
            url.pathname += 'index.html';
        }
        console.log('Redirecting to:', url.href);
        window.location.href = url.href;
    }
</script>

<script>
    // 验证并修正路径参数
    function validateSegments(segments) {
        const currentOSName = embeddedConfig[segments.osKey]?.name;

        // 如果 OS 无效，默认设置为 FreeRTOS
        if (!currentOSName) {
            console.warn("Invalid OS key, defaulting to FreeRTOS");
            segments.osKey = 'freertos';
        }

        // 如果语言无效，默认设置为 en
        if (!getLanguages(embeddedConfig, segments.osKey).includes(segments.language)) {
            console.warn("Invalid language, defaulting to en");
            segments.language = 'en';
        }

        return segments;
    }

    // 设置初始选中值
    function setInitialValues(segments) {
        document.getElementById('os-selector').value = segments.osKey;
        document.getElementById('language-selector').value = segments.language;

        const versionSelector = document.getElementById('version-selector');
        const availableVersions = getVersions(embeddedConfig, segments.osKey, segments.language);
        versionSelector.value = availableVersions.includes(segments.version) ? segments.version : availableVersions[0] || 'latest';
    }
</script>

<style>
    .selectors-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr); /* 三列等宽 */
        gap: 4px;
        padding: 1px 1px;

        margin-top: var(--root-margin-top, 4px);
        margin-bottom: var(--root-margin-bottom, 0px);
    }

    .dual-selector-group {
        display: grid;
        grid-template-columns: 1fr 1fr; /* 两列等宽 */
        gap: 4px; /* 列间距 */
    }

    .selector-group {
        position: relative;
        width: 100%; /* 确保填满网格列 */
    }

    .selector-label {
        display: block;
        color: #a0b3c6;
        font-size: 0.85em;
        margin-bottom: 4px;
        padding-left: 4px;
    }

    .selector-dropdown {
        width: 100%;
        margin-top: var(--root-margin-top, 4px);
        margin-bottom: var(--root-margin-bottom, 0px);
        padding: 2px 2px;
        border: 2px white !important;
        border-radius: 6px !important;
        background: #627078 !important;
        color: white;
        font-size: 0.95em;
        transition: all 0.3s ease;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23a0b3c6'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
        display: flex;
        height: 30px;

        box-shadow: none !important; /* 不要边框阴影 */
        outline: none !important; /* 不要边框阴影 */
    }

    .selector-dropdown:hover {
        border-color: #4a6a8b;
        background-color: rgba(44, 62, 80, 1);
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .selector-dropdown:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
    }

    /* 移动端优化 */
    @media (max-width: 768px) {
        .selectors-grid {
            grid-template-columns: 1fr; /* 小屏幕下堆叠显示 */
            gap: 10px;
        }

        .selector-dropdown {
            padding: 10px 12px;
        }

        .dual-selector-group {
            grid-template-columns: 1fr; /* 小屏幕下堆叠显示 */
        }
    }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

    <!-- templates/sidebar_toggle.html -->


<div id="topleft-panel" style="display: block !important; padding: 0; background: none; border: none;"></div>


<div class="bottomleft-panel"></div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        try {
            const segments = validateSegments(getCurrentSegments());
            const baseURL = getBaseURL();

            // 渲染HTML
            document.getElementById('topleft-panel').innerHTML = `
<!-- templates/sidebar_user_panel_div.html -->


<!-- templates/sidebar_user_panel_div_docselect.html -->

<div class="selectors-grid">
    <!-- 系统选择器 -->
    <div class="selector-group">
        <select id="os-selector" class="selector-dropdown">
            ${Object.keys(embeddedConfig).map(key => `
                <option value="${key}">${embeddedConfig[key].name}</option>
            `).join('')}
        </select>
    </div>

    <!-- 语言选择器 -->
    <div class="selector-group">
        <select id="language-selector" class="selector-dropdown">
            ${getLanguages(embeddedConfig, segments.osKey).map(lang => `
                <option value="${lang}">${lang === 'en' ? 'en' : 'cn'}</option>
            `).join('')}
        </select>
    </div>

    <!-- 版本选择器 -->
    <div class="selector-group">
        <select id="version-selector" class="selector-dropdown">
            ${getVersions(embeddedConfig, segments.osKey, segments.language).map(ver => `
                <option value="${ver}">${ver}</option>
            `).join('')}
        </select>
    </div>
</div>

<div class="user-panel-container">
    <div class="user-panel">
        

    </div>
</div>`;

            // 设置初始值
            setInitialValues(segments);

            // 绑定事件
            bindEvents(baseURL, segments);

            // 将 user-panel 移动到 bottomleft-panel 内
            const userPanel = document.querySelector('.user-panel');
            const bottomleftPanel = document.querySelector('.bottomleft-panel');
            if (userPanel && bottomleftPanel) {
                bottomleftPanel.appendChild(userPanel); // 直接添加为子元素
            }
        } catch (error) {
            console.error("Error initializing selectors:", error);
        }
    });
</script>

<style>
    #topleft-panel {
        background: rgba(40, 58, 73, 0.9);
        border-radius: 4px;
        padding: 4px;
        margin: 4px 0;
        box-shadow: 0 4px 4px rgba(0,0,0,0.15);
        backdrop-filter: blur(4px);
    }

    /* 移动端优化 */
    @media (max-width: 768px) {
        #topleft-panel {
            margin: 8px 0;
            padding: 10px;
        }
    }
</style>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_product/0_ameba_product_center_index.html">Products Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_sdk/0_ameba_sdks_index.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_solutions/0_ameba_solutions_index.html">Ameba Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index.html">0.1 GCC Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gdb_debug/0_gdb_debug_index.html">0.2 GDB Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_build_system/0_build_system_index.html">0.3 Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_example/0_sdk_example_index.html">0.4 SDK Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_memory_layout/0_layout_index.html">0.5 Flash &amp; RAM Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_user_config/0_usrcfg_index.html">0.6 User Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_tools/0_tools_index.html">0.7 Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_at_command/0_at_command_index.html">0.8 AT Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_file_system/0_vfs_index.html">0.9 Virtual File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ftl/0_ftl_index.html">0.a Flash Translation Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_mpu_cache/0_mpu_cache_index.html">1.0 Memory Management &amp; Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index.html">1.1 Boot Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index.html">1.2 OTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_otpc/0_otpc_index.html">1.3 OTPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_chipen/0_chipen_index.html">1.4 Chip Enable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ipc/0_ipc_index.html">1.5 Inter Processor Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_pinmux/0_pinmux_index.html">1.6 Pin Multiplexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index.html">1.7 GPIO &amp; Pin Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index.html">1.9 Power Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_basic/0_wifi_basic_index.html">2.0 Wi-Fi Basic Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_wifi_bridge/0_wifi_bridge_index.html">2.1 WHC Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_fullmac/0_fullmac_index.html">2.2 WHC FullMAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_tunnel/0_wifi_tunnel_index.html">2.3 Wi-Fi R-Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_csi/0_wifi_csi_index.html">2.4 Wi-Fi CSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_adaptivity_test/0_wifi_adaptivity_index.html">2.5 Wi-Fi Adaptivity Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_api_docs/0_api_index.html">2.6 Wi-Fi API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_security/0_security_index.html">3.1 Security &amp; Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_trng/0_trng_index.html">3.2 True Random Number Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_crypto_engine/0_crypto_engine_index.html">3.9 Crypto Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ecdsa_engine/0_ecdsa_index.html">3.a ECDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_eddsa_engine/0_eddsa_index.html">3.b EDDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_rsa_engine/0_rsa_index.html">3.c RSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ap_trustzone/0_ap_tz_index.html">3.d AP Secure Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai/0_ai_index.html">4.1 AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai_voice/0_ai_voice_index.html">4.2 AIVoice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index.html">4.3 Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_dsp/0_dsp_index.html">4.4 DSP</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_mp_index.html">6.1 Mass Production</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">MP Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generate-image">Generate Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combine-and-download-image">Combine and Download Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-and-switch-image">Boot and Switch Image</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#calibration-and-test">Calibration and Test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wi-fi-and-bluetooth-calibration">Wi-Fi and Bluetooth Calibration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#standard-calibration">Standard Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fast-calibration">Fast Calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#custom-test">Custom Test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#user-data">User Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../6_mptools/0_mptools_index.html">6.2 MP Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index.html">7.1 USB Host &amp; Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index.html">8.1 DMA Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_psram/0_psram_index.html">8.2 PSRAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index.html">8.3 Thermal Meter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index.html">8.4 ADC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index.html">8.5 IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ledc/0_ledc_index.html">8.6 LED Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_cap_touch/0_cap_touch_index.html">8.7 Cap-Touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_key_scan/0_key_scan_index.html">8.8 Key-Scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc_io/0_rtc_io_index.html">8.9 RTC-IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index.html">8.a LCD Controller</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">
    
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_mp_index.html">Mass Production</a></li>
      <li class="breadcrumb-item active">MP Image</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mp-image">
<span id="mass-production"></span><h1>MP Image<a class="headerlink" href="#mp-image" title="Link to this heading"></a></h1>
<p>MP image is used for chip <a class="reference internal" href="#mp-test"><span class="std std-ref">Calibration and Test</span></a> during mass production.</p>
<p>To meet diverse user requirements, the SDK provides two types of MP image: Shrink MP Image and Expand MP Image. Their differences are as follows:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-0-0-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-3" name="0-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Image Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Download Area</p></th>
<th class="head"><p>Lifetime</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="2"><p>Shrink</p></td>
<td rowspan="2"><p>Small</p></td>
<td><p>Flash</p></td>
<td><p>Retained after
power-off</p></td>
<td><ul class="simple">
<li><p>Only includes calibration-related code and peripheral driver.</p></li>
<li><p>Combined with application image for download.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>RAM</p></td>
<td><p>Lost after
power-off</p></td>
<td><ul class="simple">
<li><p>Only includes calibration-related code and peripheral driver.</p></li>
<li><p>No bootloader required.</p></li>
<li><p>Downloaded separately, not combined with application.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Expand</p></td>
<td><p>Large</p></td>
<td><p>Flash</p></td>
<td><p>Retained after
power-off</p></td>
<td><ul class="simple">
<li><p>Includes full SDK code for complex testing.</p></li>
<li><p>Combined with application image for download.</p></li>
<li><p>Supports embedding application code to run both calibraction
test and customer application in a single image (optional).</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Image Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Download Area</p></th>
<th class="head"><p>Lifetime</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Expand</p></td>
<td><p>Large</p></td>
<td><p>Flash</p></td>
<td><p>Retained after
power-off</p></td>
<td><ul class="simple">
<li><p>Includes full SDK code for complex testing.</p></li>
<li><p>Combined with application image for download.</p></li>
<li><p>Supports embedding application code to run both calibraction
test and customer application in a single image (optional).</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Image Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Download Area</p></th>
<th class="head"><p>Lifetime</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Expand</p></td>
<td><p>Large</p></td>
<td><p>Flash</p></td>
<td><p>Retained after
power-off</p></td>
<td><ul class="simple">
<li><p>Includes full SDK code for complex testing.</p></li>
<li><p>Combined with application image for download.</p></li>
<li><p>Supports embedding application code to run both calibraction
test and customer application in a single image (optional).</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-3" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-3" name="0-3" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Image Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Download Area</p></th>
<th class="head"><p>Lifetime</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shrink</p></td>
<td><p>Small</p></td>
<td><p>Flash</p></td>
<td><p>Retained after
power-off</p></td>
<td><ul class="simple">
<li><p>Only includes calibration-related code and peripheral driver.</p></li>
<li><p>Combined with application image for download.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Expand</p></td>
<td><p>Large</p></td>
<td><p>Flash</p></td>
<td><p>Retained after
power-off</p></td>
<td><ul class="simple">
<li><p>Includes full SDK code for complex testing.</p></li>
<li><p>Combined with application image for download.</p></li>
<li><p>Supports embedding application code to run both calibraction
test and customer application in a single image (optional).</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div></div>
<section id="generate-image">
<h2>Generate Image<a class="headerlink" href="#generate-image" title="Link to this heading"></a></h2>
<p>Below are the steps to generate MP image:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">Shrink MP</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Expand MP</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><ol class="arabic simple">
<li><p>Refer to <a class="reference internal" href="../0_gcc_build_environment/1_gcc_build_environment_toprst.html#configuring-sdk"><span class="std std-ref">Configuring SDK (menuconfig)</span></a> to modify the project configuration.</p>
<ol class="loweralpha simple">
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">CONFIG</span> <span class="pre">Mass</span> <span class="pre">Production</span></code>, check <code class="docutils literal notranslate"><span class="pre">Enable</span> <span class="pre">MP</span> <span class="pre">&gt;</span> <span class="pre">MP</span> <span class="pre">Mode</span> <span class="pre">&gt;</span> <span class="pre">shrink</span></code> to set the MP type to shrink.</p></li>
<li><p>Return to the <code class="docutils literal notranslate"><span class="pre">MENUCONFIG</span> <span class="pre">FOR</span> <span class="pre">General</span></code> page, check <code class="docutils literal notranslate"><span class="pre">CONFIG</span> <span class="pre">WIFI</span> <span class="pre">&gt;</span> <span class="pre">Enable</span> <span class="pre">Wifi</span></code> to enable Wi-Fi.</p></li>
<li><p>Return to the <code class="docutils literal notranslate"><span class="pre">MENUCONFIG</span> <span class="pre">FOR</span> <span class="pre">General</span></code> page, check <code class="docutils literal notranslate"><span class="pre">CONFIG</span> <span class="pre">BT</span> <span class="pre">&gt;</span> <span class="pre">Enable</span> <span class="pre">BT</span></code> to enable Bluetooth.</p></li>
<li><p>Save and exit.</p></li>
</ol>
</li>
<li><p>Refer to <a class="reference internal" href="../0_gcc_build_environment/1_gcc_build_environment_toprst.html#building-code"><span class="std std-ref">Building Code</span></a> to build the project.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The generated MP image <code class="file docutils literal notranslate"><span class="pre">xxx_app_mp.bin</span></code> is located in <code class="docutils literal notranslate"><span class="pre">{SDK}\amebaxxx_gcc_project</span></code>.</p>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><ol class="arabic simple">
<li><p>Refer to <a class="reference internal" href="../0_gcc_build_environment/1_gcc_build_environment_toprst.html#configuring-sdk"><span class="std std-ref">Configuring SDK (menuconfig)</span></a> to modify the project configuration.</p>
<ol class="loweralpha simple">
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">CONFIG</span> <span class="pre">Mass</span> <span class="pre">Production</span></code>, check <code class="docutils literal notranslate"><span class="pre">Enable</span> <span class="pre">MP</span> <span class="pre">&gt;</span> <span class="pre">MP</span> <span class="pre">Mode</span> <span class="pre">&gt;</span> <span class="pre">expand</span></code> to set the MP type to expand.</p></li>
<li><p>Return to the <code class="docutils literal notranslate"><span class="pre">MENUCONFIG</span> <span class="pre">FOR</span> <span class="pre">General</span></code> page, check <code class="docutils literal notranslate"><span class="pre">CONFIG</span> <span class="pre">WIFI</span> <span class="pre">&gt;</span> <span class="pre">Enable</span> <span class="pre">Wifi</span></code> to enable Wi-Fi.</p></li>
<li><p>Return to the <code class="docutils literal notranslate"><span class="pre">MENUCONFIG</span> <span class="pre">FOR</span> <span class="pre">General</span></code> page, check <code class="docutils literal notranslate"><span class="pre">CONFIG</span> <span class="pre">BT</span> <span class="pre">&gt;</span> <span class="pre">Enable</span> <span class="pre">BT</span></code> to enable Bluetooth.</p></li>
<li><p>Save and exit.</p></li>
</ol>
</li>
<li><p>Refer to <a class="reference internal" href="../0_gcc_build_environment/1_gcc_build_environment_toprst.html#building-code"><span class="std std-ref">Building Code</span></a> to build the project.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The generated MP image <code class="file docutils literal notranslate"><span class="pre">xxx_app_mp.bin</span></code> is located in <code class="docutils literal notranslate"><span class="pre">{SDK}\amebaxxx_gcc_project</span></code>.</p>
</div>
</div></div>
</section>
<section id="combine-and-download-image">
<span id="mp-image-combine"></span><h2>Combine and Download Image<a class="headerlink" href="#combine-and-download-image" title="Link to this heading"></a></h2>
<p>Typically, MP image does not include application code, it needs to be combined with the application image to switch to the customer application after completing <a class="reference internal" href="#mp-test"><span class="std std-ref">Calibration and Test</span></a> .</p>
<p>Below are the steps to combine image:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-2-2-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-2" name="2-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-2-2-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-3" name="2-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><ol class="arabic">
<li><p>Prepare <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code>, <code class="file docutils literal notranslate"><span class="pre">km0_km4_app_mp.bin</span></code>, and <code class="file docutils literal notranslate"><span class="pre">km0_km4_app.bin</span></code>.</p></li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> to combine the images.</p>
<blockquote>
<div><ol class="loweralpha">
<li><p>Open the <span class="guilabel">Generate</span> tab and input the paths of the three files mentioned above.</p></li>
<li><p>Set the Offset according to the Flash Layout in <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\usrcfg\amebadplus\ameba_flashcfg.c</span></code>.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">const</span><span class="w"> </span><span class="n">FlashLayoutInfo_TypeDef</span><span class="w"> </span><span class="n">Flash_Layout</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*Region_Type,      [StartAddr,     EndAddr]                */</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT</span><span class="p">,</span><span class="w">          </span><span class="mh">0x08000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08013FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(76K)</span>
</span><span class="w">    </span><span class="c1">//Users should modify below according to their own memory</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08014000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x081F3FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KM4 Application OTA1 + Manifest(4K) + RDP IMG OTA1</span>
</span>
<span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT_OTA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08200000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08213FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(76K) OTA</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08214000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083DCFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KM4 Application OTA2 + Manifest(4K) + RDP IMG OTA2</span>
</span>
<span class="w">    </span><span class="p">{</span><span class="n">FTL</span><span class="p">,</span><span class="w">                       </span><span class="mh">0x083DD000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083DFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//FTL for BT(&gt;=12K), The start offset of flash pages which is allocated to FTL physical map.</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS1</span><span class="p">,</span><span class="w">                      </span><span class="mh">0x083E0000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083FFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 1 (128K)</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS2</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 2</span>
<span class="w">    </span><span class="p">{</span><span class="n">USER</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//reserve for user</span>

<span class="w">    </span><span class="cm">/* End */</span>
<span class="w">    </span><span class="p">{</span><span class="mh">0xFF</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span>
<span class="p">};</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Click the <span class="guilabel">Generate</span> button at the bottom to generate the combined image <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code>.</p>
<blockquote>
<div><figure class="align-center">
<a class="reference internal image-reference" href="../../_images/mp_image_combine_dplus.png"><img alt="../../_images/mp_image_combine_dplus.png" src="../../_images/mp_image_combine_dplus.png" style="width: 589.6px; height: 672.0px;" /></a>
</figure>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> or <a class="reference internal" href="../6_mptools/1_mp_tool_1_n_toprst.html#mp-tool-1-n"><span class="std std-ref">1-N MP Tool</span></a> to download <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code> to the chip.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="file docutils literal notranslate"><span class="pre">km0_km4_app.bin</span></code> is the customer application image, and <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code> is the bootloader image, both located in <code class="docutils literal notranslate"><span class="pre">{SDK}\amebadplus_gcc_project</span></code>. Typically, the MP image shares the same bootloader with the application image.</p>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><ol class="arabic">
<li><p>Prepare <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code>, <code class="file docutils literal notranslate"><span class="pre">kr4_km4_app_mp.bin</span></code>, and <code class="file docutils literal notranslate"><span class="pre">kr4_km4_app.bin</span></code>.</p></li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> to combine the images.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Open the <span class="guilabel">Generate</span> tab and input the paths of the three files mentioned above.</p></li>
<li><p>Set the Offset according to the Flash Layout in <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\usrcfg\amebalite\ameba_flashcfg.c</span></code>.</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">FlashLayoutInfo_TypeDef</span><span class="w"> </span><span class="n">Flash_Layout</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*Region_Type,      [StartAddr,     EndAddr]                */</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT</span><span class="p">,</span><span class="w">          </span><span class="mh">0x08000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08013FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(76K)</span>
</span><span class="w">    </span><span class="c1">//Users should modify below according to their own memory</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08014000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x081F3FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KR4 &amp; KM4 Application OTA1 + Manifest(4K) + RDP IMG OTA1</span>
</span>
<span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT_OTA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08200000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08213FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(76K) OTA</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08214000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083DCFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KR4 &amp; KM4 Application OTA2 + Manifest(4K) + RDP IMG OTA2</span>
</span><span class="w">    </span><span class="p">{</span><span class="n">FTL</span><span class="p">,</span><span class="w">                       </span><span class="mh">0x083DD000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083DFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//FTL for BT(&gt;=12K), The start offset of flash pages which is allocated to FTL physical map.</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS1</span><span class="p">,</span><span class="w">                      </span><span class="mh">0x083E0000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083FFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 1 (128K)</span>
<span class="w">    </span><span class="p">{</span><span class="n">IMG_DSP</span><span class="p">,</span><span class="w">           </span><span class="mh">0x08400000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x086FFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Manifest(4K) + DSP IMG, only one DSP region in layout</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS2</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 2</span>
<span class="w">    </span><span class="p">{</span><span class="n">USER</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//reserve for user</span>

<span class="w">    </span><span class="cm">/* End */</span>
<span class="w">    </span><span class="p">{</span><span class="mh">0xFF</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span>
<span class="p">};</span>
</pre></div>
</div>
<ol class="loweralpha" start="3">
<li><p>Click the <span class="guilabel">Generate</span> button at the bottom to generate the combined image <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code>.</p>
<blockquote>
<div><figure class="align-center">
<a class="reference internal image-reference" href="../../_images/mp_image_combine_lite.png"><img alt="../../_images/mp_image_combine_lite.png" src="../../_images/mp_image_combine_lite.png" style="width: 565.6px; height: 669.6px;" /></a>
</figure>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> or <a class="reference internal" href="../6_mptools/1_mp_tool_1_n_toprst.html#mp-tool-1-n"><span class="std std-ref">1-N MP Tool</span></a> to download <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code> to the chip.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="file docutils literal notranslate"><span class="pre">kr4_km4_app.bin</span></code> is the customer application image, and <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code> is the bootloader image, both located in <code class="docutils literal notranslate"><span class="pre">{SDK}\amebalite_gcc_project</span></code>. Typically, the MP image shares the same bootloader with the application image.</p>
</div>
</div><div aria-labelledby="tab-2-2-2" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-2" name="2-2" role="tabpanel" tabindex="0"><ol class="arabic">
<li><p>Prepare <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code>, <code class="file docutils literal notranslate"><span class="pre">kr4_km4_app_mp.bin</span></code>, and <code class="file docutils literal notranslate"><span class="pre">kr4_km4_app.bin</span></code>.</p></li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> to combine the images.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Open the <span class="guilabel">Generate</span> tab and input the paths of the three files mentioned above.</p></li>
<li><p>Set the Offset according to the Flash Layout in <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\usrcfg\amebalite\ameba_flashcfg.c</span></code>.</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">FlashLayoutInfo_TypeDef</span><span class="w"> </span><span class="n">Flash_Layout</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*Region_Type,      [StartAddr,     EndAddr]                */</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT</span><span class="p">,</span><span class="w">          </span><span class="mh">0x08000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08013FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(76K)</span>
</span><span class="w">    </span><span class="c1">//Users should modify below according to their own memory</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08014000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x081F3FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KR4 &amp; KM4 Application OTA1 + Manifest(4K) + RDP IMG OTA1</span>
</span>
<span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT_OTA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08200000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08213FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(76K) OTA</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08214000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083DCFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KR4 &amp; KM4 Application OTA2 + Manifest(4K) + RDP IMG OTA2</span>
</span><span class="w">    </span><span class="p">{</span><span class="n">FTL</span><span class="p">,</span><span class="w">                       </span><span class="mh">0x083DD000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083DFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//FTL for BT(&gt;=12K), The start offset of flash pages which is allocated to FTL physical map.</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS1</span><span class="p">,</span><span class="w">                      </span><span class="mh">0x083E0000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x083FFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 1 (128K)</span>
<span class="w">    </span><span class="p">{</span><span class="n">IMG_DSP</span><span class="p">,</span><span class="w">           </span><span class="mh">0x08400000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x086FFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Manifest(4K) + DSP IMG, only one DSP region in layout</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS2</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 2</span>
<span class="w">    </span><span class="p">{</span><span class="n">USER</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//reserve for user</span>

<span class="w">    </span><span class="cm">/* End */</span>
<span class="w">    </span><span class="p">{</span><span class="mh">0xFF</span><span class="p">,</span><span class="w">                      </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span>
<span class="p">};</span>
</pre></div>
</div>
<ol class="loweralpha" start="3">
<li><p>Click the <span class="guilabel">Generate</span> button at the bottom to generate the combined image <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code>.</p>
<blockquote>
<div><figure class="align-center">
<a class="reference internal image-reference" href="../../_images/mp_image_combine_lite.png"><img alt="../../_images/mp_image_combine_lite.png" src="../../_images/mp_image_combine_lite.png" style="width: 565.6px; height: 669.6px;" /></a>
</figure>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> or <a class="reference internal" href="../6_mptools/1_mp_tool_1_n_toprst.html#mp-tool-1-n"><span class="std std-ref">1-N MP Tool</span></a> to download <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code> to the chip.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="file docutils literal notranslate"><span class="pre">kr4_km4_app.bin</span></code> is the customer application image, and <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code> is the bootloader image, both located in <code class="docutils literal notranslate"><span class="pre">{SDK}\amebalite_gcc_project</span></code>. Typically, the MP image shares the same bootloader with the application image.</p>
</div>
</div><div aria-labelledby="tab-2-2-3" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-3" name="2-3" role="tabpanel" tabindex="0"><ol class="arabic">
<li><p>Prepare <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code>, <code class="file docutils literal notranslate"><span class="pre">km0_km4_ca32_app_mp.bin</span></code>, and <code class="file docutils literal notranslate"><span class="pre">km0_km4_ca32_app.bin</span></code>.</p></li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> to combine the images.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Open the <span class="guilabel">Generate</span> tab and input the paths of the three files mentioned above.</p></li>
<li><p>Set the Offset according to the Flash Layout in <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\usrcfg\amebasmart\ameba_flashcfg.c</span></code>.</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm">* @brif     Nor Flash layout is set according to Nor Flash Layout in User Manual</span>
<span class="cm">*  In each entry, the first item is flash regoin type, the second item is start address, the second item is end address */</span>
<span class="n">FlashLayoutInfo_TypeDef</span><span class="w"> </span><span class="n">Flash_Layout_Nor</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*Region_Type,          [StartAddr,     EndAddr]                */</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT</span><span class="p">,</span><span class="w">                      </span><span class="mh">0x08000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0801FFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(124K)</span>
</span><span class="w">    </span><span class="c1">//Users should modify below according to their own memory</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA1</span><span class="p">,</span><span class="w">          </span><span class="mh">0x08020000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x082FFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KR4 &amp; KM4 Application OTA1 + Manifest(4K) + RDP IMG OTA1</span>
</span><span class="w">    </span><span class="c1">// + AP IMG OTA1</span>
<span class="w">    </span><span class="p">{</span><span class="n">IMG_BOOT_OTA2</span><span class="p">,</span><span class="w">         </span><span class="mh">0x08300000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0833FFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Boot Manifest(4K) + KM4 Bootloader(252K) OTA</span>
<span class="hll"><span class="w">    </span><span class="p">{</span><span class="n">IMG_APP_OTA2</span><span class="p">,</span><span class="w">          </span><span class="mh">0x08340000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0861FFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//Certificate(4K) + Manifest(4K) + KR4 &amp; KM4 Application OTA2 + Manifest(4K) + RDP IMG OTA2</span>
</span><span class="w">    </span><span class="c1">// + AP IMG OTA2</span>
<span class="w">    </span><span class="p">{</span><span class="n">FTL</span><span class="p">,</span><span class="w">                           </span><span class="mh">0x08620000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08622FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//FTL for BT(&gt;=12K), The start offset of flash pages which is allocated to FTL physical map.</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS1</span><span class="p">,</span><span class="w">                          </span><span class="mh">0x08623000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08642FFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 1 (128K)</span>
<span class="w">    </span><span class="p">{</span><span class="n">VFS2</span><span class="p">,</span><span class="w">                          </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//VFS region 2</span>
<span class="w">    </span><span class="p">{</span><span class="n">USER</span><span class="p">,</span><span class="w">                          </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span><span class="w"> </span><span class="c1">//reserve for user</span>
<span class="w">    </span><span class="cm">/* End */</span>
<span class="w">    </span><span class="p">{</span><span class="mh">0xFF</span><span class="p">,</span><span class="w">                          </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">},</span>
<span class="p">};</span>
</pre></div>
</div>
<ol class="loweralpha" start="3">
<li><p>Click the <span class="guilabel">Generate</span> button at the bottom to generate the combined image <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code>.</p>
<blockquote>
<div><figure class="align-center">
<a class="reference internal image-reference" href="../../_images/mp_image_combine_smart.png"><img alt="../../_images/mp_image_combine_smart.png" src="../../_images/mp_image_combine_smart.png" style="width: 565.6px; height: 675.2px;" /></a>
</figure>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
<li><p>Use <a class="reference internal" href="../0_tools/1_image_tool_toprst.html#image-tool"><span class="std std-ref">Image Tool</span></a> or <a class="reference internal" href="../6_mptools/1_mp_tool_1_n_toprst.html#mp-tool-1-n"><span class="std std-ref">1-N MP Tool</span></a> to download <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code> to the chip.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="file docutils literal notranslate"><span class="pre">km0_km4_ca32_app.bin</span></code> is the customer application image, and <code class="file docutils literal notranslate"><span class="pre">km4_boot_all.bin</span></code> is the bootloader image, both located in <code class="docutils literal notranslate"><span class="pre">{SDK}\amebasmart_gcc_project</span></code>. Typically, the MP image shares the same bootloader with the application image.</p>
</div>
</div></div>
</section>
<section id="boot-and-switch-image">
<h2>Boot and Switch Image<a class="headerlink" href="#boot-and-switch-image" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>After downloading <code class="file docutils literal notranslate"><span class="pre">Image_All.bin</span></code> to the chip, reboot the chip. By default, it will run OTA1 (MP image).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="p">[</span><span class="n">BOOT</span><span class="o">-</span><span class="n">I</span><span class="p">]</span> <span class="n">IMG2</span> <span class="n">BOOT</span> <span class="kn">from</span> <span class="nn">OTA</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">1.1</span>
</span><span class="o">...</span>
<span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="n">Init</span> <span class="n">WIFI</span>
<span class="hll"><span class="p">[</span><span class="n">WLAN</span><span class="o">-</span><span class="n">A</span><span class="p">]</span> <span class="n">MP</span> <span class="n">driver</span>
</span></pre></div>
</div>
</li>
<li><p>Execute <a class="reference internal" href="#mp-test"><span class="std std-ref">Calibration and Test</span></a> . After completion, enter <a class="reference internal" href="../0_at_command/at_command_common.html#common-at-otaclear"><span class="std std-ref">AT+OTACLEAR</span></a> to clear the signature of the current image to invalidate the MP image.</p></li>
<li><p>Reboot the chip. It will run OTA2 (customer application image).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="p">[</span><span class="n">BOOT</span><span class="o">-</span><span class="n">I</span><span class="p">]</span> <span class="n">IMG2</span> <span class="n">BOOT</span> <span class="kn">from</span> <span class="nn">OTA</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">1.1</span>
</span></pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="calibration-and-test">
<span id="mp-test"></span><h1>Calibration and Test<a class="headerlink" href="#calibration-and-test" title="Link to this heading"></a></h1>
<section id="wi-fi-and-bluetooth-calibration">
<h2>Wi-Fi and Bluetooth Calibration<a class="headerlink" href="#wi-fi-and-bluetooth-calibration" title="Link to this heading"></a></h2>
<p>There are two methods for calibrating chip’s Wi-Fi and Bluetooth: Standard Calibration and Fast Calibration. Both methods apply to different test conditions and are included in Shrink MP Image and Expand MP Image.</p>
<table class="docutils align-default" id="id1" style="width: 100%">
<caption><span class="caption-text">Calibration Method Comparison</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Calibration Method</p></th>
<th class="head"><p>Cost</p></th>
<th class="head"><p>Test Duration</p></th>
<th class="head"><p>Accuracy</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Standard Calibration</p></td>
<td><p>High</p></td>
<td><p>Long</p></td>
<td><p>High</p></td>
<td><p>Uses professional test equipment for wired tests.</p></td>
</tr>
<tr class="row-odd"><td><p>Fast Calibration</p></td>
<td><p>Low</p></td>
<td><p>Short</p></td>
<td><p>Low</p></td>
<td><p>Uses Realtek-provided signal board for wireless tests.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Only RTL8721Dx supports Fast Calibration.</p></li>
</ul>
</div>
<section id="standard-calibration">
<h3>Standard Calibration<a class="headerlink" href="#standard-calibration" title="Link to this heading"></a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-3-3-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-2" name="3-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-3-3-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-3" name="3-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><p>Refer to <em>WS_RTL8721DA_RTL8721DC_RTL8721DG_MP_FLOW.pdf</em> for details.</p>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><p>Refer to <em>WS_RTL8720E_RTL8726E_MP_FLOW.pdf</em> for details.</p>
</div><div aria-labelledby="tab-3-3-2" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-2" name="3-2" role="tabpanel" tabindex="0"><p>Refer to <em>WS_RTL8720E_RTL8726E_MP_FLOW.pdf</em> for details.</p>
</div><div aria-labelledby="tab-3-3-3" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-3" name="3-3" role="tabpanel" tabindex="0"><p>Refer to <em>WS_RTL8730E_MP_FLOW.pdf</em> for details.</p>
</div></div>
</section>
<section id="fast-calibration">
<h3>Fast Calibration<a class="headerlink" href="#fast-calibration" title="Link to this heading"></a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">RTL8721Dx</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><p>Refer to <em>WS_RTL8721DA_RTL8721DC_RTL8721DG_Fast_MP_FLOW.pdf</em> for details.</p>
</div></div>
</section>
</section>
<section id="custom-test">
<h2>Custom Test<a class="headerlink" href="#custom-test" title="Link to this heading"></a></h2>
<p>Besides Wi-Fi and Bluetooth calibration, MP image supports adding custom tests.</p>
<p>For example, to test GPIO functions of specific pins, implement using APIs defined in <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\amebaxxx\hal\src\gpio_api.c</span></code>. Others like <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\amebaxxx\hal\src\serial_api.c</span></code> and <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\amebaxxx\hal\src\spi_api.c</span></code> apply to UART and SPI function test.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For adding custom AT commands in SDK, refer to <a class="reference internal" href="../0_at_command/at_command_introduction.html#at-commands"><span class="std std-ref">AT Commands</span></a>.</p>
</div>
</section>
</section>
<section id="user-data">
<h1>User Data<a class="headerlink" href="#user-data" title="Link to this heading"></a></h1>
<p>Besides image, user data can be optionally downloaded to chips during mass production.</p>
<p>Different download methods exist based on data type:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">Common Data</button><button aria-controls="panel-5-5-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-1" name="5-1" role="tab" tabindex="-1">Special Data</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"><p>For common data such as audio files, it is recommended to refer to <a class="reference internal" href="#mp-image-combine"><span class="std std-ref">Combine and Download Image</span></a> to combine it with image into a single file and download to the chip.</p>
</div><div aria-labelledby="tab-5-5-1" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-1" name="5-1" role="tabpanel" tabindex="0"><p>If each chip’s data is different (e.g., product license), it’s unsuitable to combine with image.</p>
<p>It is recommended to customize AT commands in the MP image to receive data files via LOGUART and write to Flash. After the MP image runs, the host computer transfers the special data to the chip.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The APIs defined in <code class="docutils literal notranslate"><span class="pre">{SDK}\component\soc\amebaxxx\hal\src\flash_api.c</span></code> support this functionality.</p>
</div>
</div></div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="0_mp_index.html" class="btn btn-neutral float-left" title="Mass Production" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../6_mptools/0_mptools_index.html" class="btn btn-neutral float-right" title="1-N MP Tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Realsil.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>

    <!-- 问题反馈按钮和对话框 -->
    

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
     

    <!-- templates/sidebar_toggle.html -->

<button id="sidebar-toggle-button" aria-label="Toggle sidebar"></button>

<script>
    function sidebarToggleButton() {
        const sidebar = document.querySelector('.wy-nav-side');
        const contentArea = document.querySelector('.wy-nav-content');
        const contentAreaWrap = document.querySelector('.wy-nav-content-wrap');
        const sidebarToggleButton = document.getElementById('sidebar-toggle-button');

        console.log('Sidebar:', sidebar);
        console.log('Content Area:', contentArea);
        console.log('Toggle Button:', sidebarToggleButton);

        if (!sidebar || !contentArea || !sidebarToggleButton) {
            console.error('One or more elements not found');
            return;
        }

        let isSidebarCollapsed = false;

        sidebarToggleButton.addEventListener('click', function() {
            document.documentElement.classList.add('sidebar-transitioning');// 添加过渡类

            if (isSidebarCollapsed) {
                document.documentElement.classList.remove('sidebar-collapsed'); // 改为使用CSS类控制

                sidebar.style.marginLeft = '0px';
                contentAreaWrap.style.marginLeft = '300px';
                contentArea.classList.remove('expanded');

                sidebarToggleButton.style.left = '300px';
            } else {
                document.documentElement.classList.add('sidebar-collapsed');

                sidebar.style.marginLeft = '-300px';
                contentAreaWrap.style.marginLeft = '0px';
                contentArea.classList.add('expanded');

                sidebarToggleButton.style.left = '0px';
            }

            // 同步状态
            isSidebarCollapsed = !isSidebarCollapsed;

            // 过渡结束后移除标记
            setTimeout(() => {
                document.documentElement.classList.remove('sidebar-transitioning');
            }, 300); // 必须与过渡时间匹配
        });
    }
</script>

<style>
    #sidebar-toggle-button {
        position: fixed;
        left: 300px;
        top: 0;
        z-index: 1002;

        width: 4px;  /* 竖线宽度 */
        /* 增加热区 */
        padding: 0 15px; /* 左右各扩展12px点击区域 */
        margin: 0 -15px; /* 抵消padding带来的位置偏移 */
        clip-path: inset(0 -15px); /* 保持视觉宽度4px */

        height: 100vh; /* 竖线高度 */
        background: #2d2d2d;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: none;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);

        /* 隐藏原始文字 */
        color: transparent;
        font-size: 0;

        /* 修正交互区域 */
        padding: 0;
        margin: 0;

        /* 新增：防止内容溢出 */
        overflow: visible;

        /* 调整箭头定位 */
        &::before {
            top: 50vh; /* 改为视口中点定位 */
            transform: translateY(-50%);
        }

        &::after {
            top: 50vh;
            transform: translateY(-50%) rotate(45deg);
        }
    }

    /* 动态箭头指示器 */
    #sidebar-toggle-button::before {
        content: '‹';
        position: absolute;
        left: 6px;
        top: 50%;
        width: 24px;
        height: 24px;
        background: #3498db;
        color: white;
        font-size: 18px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transform: translateY(-50%);
        opacity: 0;
        transition: all 0.3s ease;
        pointer-events: none;
    }

    #sidebar-toggle-button::after {
        content: '';
        position: absolute;

        left: -15px;  /* 向左扩展12px */
        right: -15px; /* 向右扩展12px */

        top: 50%;
        width: 8px;
        height: 8px;
        border: 2px solid white;
        border-width: 2px 2px 0 0;
        transform: translateY(-50%) rotate(45deg);
        opacity: 0;
        transition: all 0.3s ease;
    }

    /* 悬停效果 */
    #sidebar-toggle-button:hover {
        width: 10px;
        background: #2980b9;
    }

    /* 点击动画 */
    #sidebar-toggle-button:active {
        transform: translateY(-50%) scale(0.9);
    }
</style>

<!-- 统一移动速度 -->
<style>
    /* 统一过渡参数 */
    :root {
        --sidebar-transition: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .wy-nav-side,
    .wy-nav-content-wrap,
    #sidebar-toggle-button {
        transition: all var(--sidebar-transition) !important;
    }

    /* 按钮样式调整 */
    #sidebar-toggle-button {
        left: 300px;
        transition: left var(--sidebar-transition),
                    width 150ms ease, /* 悬停效果保持独立 */
                    background 150ms ease;
    }

    /* 折叠状态 */
    .sidebar-collapsed {
        .wy-nav-side {
            margin-left: -300px !important;
        }

        .wy-nav-content-wrap {
            margin-left: 0 !important;
        }

        #sidebar-toggle-button {
            left: 0 !important;
        }
    }

    /* 禁用点击时的过渡 */
    .sidebar-transitioning {
        .wy-nav-side,
        .wy-nav-content-wrap,
        #sidebar-toggle-button {
            transition: none !important;
        }
    }
</style>

    

    <script>
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            

            sidebarToggleButton();
        });


    </script>



</body>
</html>