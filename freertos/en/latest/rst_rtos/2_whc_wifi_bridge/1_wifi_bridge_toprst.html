

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WiFi Bridge Introduction &mdash; Ameba IoT Docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=536412e7" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=536412e7" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script src="../../_static/tabs.js?v=3030b3cb"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FullMAC" href="../2_whc_fullmac/0_fullmac_index.html" />
    <link rel="prev" title="WHC Bridge" href="0_wifi_bridge_index.html" />
     

    <!-- NDA文档输入密码的框 -->
    
<script>
// ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼ 多语言配置 ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼
const lang = 'en';  // 使用 Python 字符串切片
const i18n = {
    zh: {
        title: '访问授权',
        username: '用户名',
        password: '密码',
        confirm: '确认',
        cancel: '取消',
        usernameError: '用户名错误',
        userNotExist: '该用户不存在',
        passwordError: '密码错误',
        wrongPassword: '请输入正确的密码',
        accessDenied: '无访问权限',
        noPermission: '您无权查看此内容',
        expiredTitle: '访问已过期',
        expiredMsg: '您的权限已失效<br>有效期：%s 至 %s',
        deniedTitle: '⚠️ 无访问权限',
        contact: '请联系 claire_wang@realsil.com.cn 获取权限'
    },
    en: {
        title: 'Access Required',
        username: 'Username',
        password: 'Password',
        confirm: 'Confirm',
        cancel: 'Cancel',
        usernameError: 'Invalid Username',
        userNotExist: 'User does not exist',
        passwordError: 'Wrong Password',
        wrongPassword: 'Please enter correct password',
        accessDenied: 'Access Denied',
        noPermission: 'You have no permission to view this content',
        expiredTitle: 'Authorization Expired',
        expiredMsg: 'Your access has expired<br>Valid period: %s to %s',
        deniedTitle: '⚠️ Access Denied',
        contact: 'Please contact claire_wang@realsil.com.cn for access'
    }
};
// ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲ 多语言配置结束 ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲
</script>

    <!-- 样式模板 -->
    

<style>
    .wy-nav-content {
        max-width: 1000px;
         
    }
    
    .auth-denied {
        padding: 20px;
        background: #f8f9fa;
        border-radius: 4px;
        border: 1px solid #dee2e6;
        text-align: center;
        color: #721c24;
        margin-top: 20px;
    }
    .auth-denied h3 {
        margin-bottom: 10px;
        color: #dc3545;
    }
    
    #report-button {
        position: fixed;
        top: 10px;
        left: 1120px;
        padding: 10px 20px;
        background-color: #ff00a2;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        z-index: 1000;
    }
    #report-button:hover {
        background-color: #0056b3;
    }
    
    .feedback-dialog {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        z-index: 1001;
        width: 600px;
    }
    .feedback-dialog textarea {
        width: 100%;
        height: 150px;
        margin-top: 10px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        resize: vertical;
    }
    .feedback-dialog button {
        margin-top: 10px;
        padding: 8px 16px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    .feedback-dialog button:hover {
        background-color: #0056b3;
    }

    
    
</style>
    <style>
    /* ====================== 选择器样式 ====================== */
    /* 选择器容器 */
    .selector-container {
        margin: 8px 0;
        display: flex;
        justify-content: flex-start;
        align-items: center;
    }
    
    /* 版本选择器特殊边距 */
    .version-selector-container {
        margin-bottom: 8px !important;
    }
    
    /* 选择器标签 */
    .selector-label {
        color: white;
        margin-right: 10px;
        width: 80px;
        text-align: right;
        font-size: 0.9em;
    }
    
    /* 下拉选择框 */
    .selector-dropdown {
        width: 120px;
        border-radius: 2px;
        padding: 4px 8px;
        border: 1px solid #405261;
        background: #2c3e50;
        color: white;
        font-size: 0.9em;
    }
    
    /* 下拉选择框悬停效果 */
    .selector-dropdown:hover {
        border-color: #3498db;
        transition: border-color 0.3s;
    }
    
    /* 选择器响应式布局 */
    @media (max-width: 768px) {
        .selector-container {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .selector-label {
            width: 100%;
            text-align: left;
            margin-bottom: 4px;
        }
        
        .selector-dropdown {
            width: 100%;
        }
    }
</style>
    <style>
/* =============== 左上角登录区域  =============== */
/* ================= 用户面板 ================= */
.user-panel {
    padding: 15px;
    background: #34495e;
    border-radius: 8px;
    margin-bottom: 20px;
}

.username {
    color: #fff;
    font-weight: 500;
    font-size: 1.1em;
    text-align: center;
    margin: 10px 0;
}

/* ================= 按钮容器 ================= */
.button-row {
    display: flex;
    gap: 8px;
    width: 100%;
    margin: 10px 0;
}

/* 通用按钮样式 */
.auth-btn, .forum-btn, .official-btn {
    flex: 1;
    padding: 8px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: opacity 0.3s;
    text-align: center;
    color: white !important;
}

/* 认证按钮 */
.auth-btn {
    background: #3498db;
}

/* 论坛按钮 */
.forum-btn {
    background: #9b59b6; /* 与参考代码的官方按钮同色 */
}

/* 官网按钮 */
.official-btn {
    background: #2ecc71; /* 与参考代码文档按钮同色 */
}
/* =============== 左上角登录区域  =============== */
</style>

    <!-- 注入 TOC 映射和当前页面信息 -->
    

<!-- TOC 映射和当前文档信息 -->
<script>
// 将 Python 字典转换为 JS 对象
const TOC_TITLE_MAP = {"rst_rtos/0_ameba_product": "Products Center", "rst_rtos/0_ameba_product/0_ameba_product_center_index": "Products Center", "rst_rtos/0_ameba_sdk": "Ameba SDK", "rst_rtos/0_ameba_sdk/0_ameba_sdks_index": "Ameba SDK", "rst_rtos/0_ameba_solutions": "Ameba Solutions", "rst_rtos/0_ameba_solutions/0_ameba_solutions_index": "Ameba Solutions", "rst_rtos/0_at_command": "0.8 AT Commands", "rst_rtos/0_at_command/0_at_command_index": "0.8 AT Commands", "rst_rtos/0_file_system": "0.9 Virtual File System", "rst_rtos/0_file_system/0_vfs_index": "0.9 Virtual File System", "rst_rtos/0_gcc_build_environment": "0.1 GCC Build Environment", "rst_rtos/0_gcc_build_environment/0_gcc_build_index": "0.1 GCC Build Environment", "rst_rtos/0_gcc_build_library": "0.3 GCC Build Library", "rst_rtos/0_gcc_build_library/0_gcc_build_library_index": "0.3 GCC Build Library", "rst_rtos/0_gdb_debug": "0.2 GDB Debug", "rst_rtos/0_gdb_debug/0_gdb_debug_index": "0.2 GDB Debug", "rst_rtos/0_memory_layout": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_memory_layout/0_layout_index": "0.5 Flash \u0026 RAM Layout", "rst_rtos/0_sdk_example": "0.4 SDK Example", "rst_rtos/0_sdk_example/0_sdk_example_index": "0.4 SDK Example", "rst_rtos/0_tools": "0.7 Tools", "rst_rtos/0_tools/0_tools_index": "0.7 Tools", "rst_rtos/0_user_config": "0.6 User Config", "rst_rtos/0_user_config/0_usrcfg_index": "0.6 User Config", "rst_rtos/10_api_docs": "10.0 API Reference", "rst_rtos/10_api_docs/0_api_index": "10.0 API Reference", "rst_rtos/1_boot_process": "1.1 BOOT Process", "rst_rtos/1_boot_process/0_boot_index": "1.1 BOOT Process", "rst_rtos/1_chipen": "1.4 Chip Enable", "rst_rtos/1_chipen/0_chipen_index": "1.4 Chip Enable", "rst_rtos/1_gpio": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_gpio/0_gpio_index": "1.7 GPIO \u0026 Pin Control", "rst_rtos/1_ipc": "1.5 Inter Processor Communication", "rst_rtos/1_ipc/0_ipc_index": "1.5 Inter Processor Communication", "rst_rtos/1_mpu_cache": "1.0 MPU and Cache", "rst_rtos/1_mpu_cache/0_mpu_cache_index": "1.0 MPU and Cache", "rst_rtos/1_ota": "1.2 OTA", "rst_rtos/1_ota/0_ota_index": "1.2 OTA", "rst_rtos/1_otpc": "1.3 OTPC", "rst_rtos/1_otpc/0_otpc_index": "1.3 OTPC", "rst_rtos/1_pinmux": "1.6 Pin Multiplexing", "rst_rtos/1_pinmux/0_pinmux_index": "1.6 Pin Multiplexing", "rst_rtos/1_power_save": "1.9 Power Save", "rst_rtos/1_power_save/0_ps_index": "1.9 Power Save", "rst_rtos/2_whc_fullmac": "2.1 WHC FullMAC", "rst_rtos/2_whc_fullmac/0_fullmac_index": "2.1 WHC FullMAC", "rst_rtos/2_whc_wifi_bridge": "2.0 WHC Bridge", "rst_rtos/2_whc_wifi_bridge/0_wifi_bridge_index": "2.0 WHC Bridge", "rst_rtos/2_wifi_adaptivity_test": "2.4 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_adaptivity_test/0_wifi_adaptivity_index": "2.4 Wi-Fi Adaptivity Test", "rst_rtos/2_wifi_csi": "2.3 Wi-Fi CSI", "rst_rtos/2_wifi_csi/0_wifi_csi_index": "2.3 Wi-Fi CSI", "rst_rtos/2_wifi_tunnel": "2.2 Wi-Fi R-Mesh", "rst_rtos/2_wifi_tunnel/0_wifi_tunnel_index": "2.2 Wi-Fi R-Mesh", "rst_rtos/3_crypto_engine": "3.9 Crypto Engine", "rst_rtos/3_crypto_engine/0_crypto_engine_index": "3.9 Crypto Engine", "rst_rtos/3_ecdsa_engine": "3.a ECDSA Engine", "rst_rtos/3_ecdsa_engine/0_ecdsa_index": "3.a ECDSA Engine", "rst_rtos/3_eddsa_engine": "3.b EDDSA Engine", "rst_rtos/3_eddsa_engine/0_eddsa_index": "3.b EDDSA Engine", "rst_rtos/3_nda_huk_derivation": "3.3 HUK Derivation \ud83d\udd12", "rst_rtos/3_nda_huk_derivation/0_huk_derivation_index_nda": "3.3 HUK Derivation \ud83d\udd12", "rst_rtos/3_nda_rdp": "3.4 RDP \ud83d\udd12", "rst_rtos/3_nda_rdp/0_rdp_index_nda": "3.4 RDP \ud83d\udd12", "rst_rtos/3_nda_rsip": "3.5 RSIP \ud83d\udd12", "rst_rtos/3_nda_rsip/0_rsip_index_nda": "3.5 RSIP \ud83d\udd12", "rst_rtos/3_nda_secure_boot": "3.6 Secure Boot \ud83d\udd12", "rst_rtos/3_nda_secure_boot/0_secure_boot_index_nda": "3.6 Secure Boot \ud83d\udd12", "rst_rtos/3_nda_swd_protection": "3.7 SWD Protection \ud83d\udd12", "rst_rtos/3_nda_swd_protection/0_swd_protection_index_nda": "3.7 SWD Protection \ud83d\udd12", "rst_rtos/3_nda_tfm": "3.8 Trusted Firmware-M (TF-M) \ud83d\udd12", "rst_rtos/3_nda_tfm/0_tfm_index_nda": "3.8 Trusted Firmware-M (TF-M) \ud83d\udd12", "rst_rtos/3_rsa_engine": "3.c RSA Engine", "rst_rtos/3_rsa_engine/0_rsa_index": "3.c RSA Engine", "rst_rtos/3_security": "3.1 Security \u0026 Encryption", "rst_rtos/3_security/0_security_index": "3.1 Security \u0026 Encryption", "rst_rtos/3_trng": "3.2 True Random Number Generator", "rst_rtos/3_trng/0_trng_index": "3.2 True Random Number Generator", "rst_rtos/4_ai": "4.1 AI", "rst_rtos/4_ai/0_ai_index": "4.1 AI", "rst_rtos/4_ai_voice": "4.2 AIVoice", "rst_rtos/4_ai_voice/0_ai_voice_index": "4.2 AIVoice", "rst_rtos/4_dsp": "4.4 DSP", "rst_rtos/4_dsp/0_dsp_index": "4.4 DSP", "rst_rtos/4_multimedia": "4.3 Multimedia", "rst_rtos/4_multimedia/0_multimedia_index": "4.3 Multimedia", "rst_rtos/6_mass_production": "6.1 Mass Production", "rst_rtos/6_mass_production/0_mp_index": "6.1 Mass Production", "rst_rtos/6_mp_image": "6.2 MP Image", "rst_rtos/6_mp_image/0_mp_image_index": "6.2 MP Image", "rst_rtos/6_mptools": "6.3 MP Tools", "rst_rtos/6_mptools/0_mptools_index": "6.3 MP Tools", "rst_rtos/7_usb": "7.1 USB Host \u0026 Device", "rst_rtos/7_usb/0_usb_index": "7.1 USB Host \u0026 Device", "rst_rtos/8_adc": "8.4 ADC", "rst_rtos/8_adc/0_adc_index": "8.4 ADC", "rst_rtos/8_cap_touch": "8.7 Cap-Touch", "rst_rtos/8_cap_touch/0_cap_touch_index": "8.7 Cap-Touch", "rst_rtos/8_dmac": "8.1 DMA Controller", "rst_rtos/8_dmac/0_dmac_index": "8.1 DMA Controller", "rst_rtos/8_ir": "8.5 IR", "rst_rtos/8_ir/0_ir_index": "8.5 IR", "rst_rtos/8_key_scan": "8.8 Key-Scan", "rst_rtos/8_key_scan/0_key_scan_index": "8.8 Key-Scan", "rst_rtos/8_lcdc": "8.A LCD Controller", "rst_rtos/8_lcdc/0_lcdc_index": "8.A LCD Controller", "rst_rtos/8_ledc": "8.6 LED Controller", "rst_rtos/8_ledc/0_ledc_index": "8.6 LED Controller", "rst_rtos/8_psram": "8.2 PSRAM", "rst_rtos/8_psram/0_psram_index": "8.2 PSRAM", "rst_rtos/8_rtc_io": "8.9 RTC-IO", "rst_rtos/8_rtc_io/0_rtc_io_index": "8.9 RTC-IO", "rst_rtos/8_thermal": "8.3 Thermal Meter", "rst_rtos/8_thermal/0_thermal_index": "8.3 Thermal Meter"};
console.log("TOC_TITLE_MAP:", TOC_TITLE_MAP);

// 获取当前页面的文档名 (例如 'rst_rtos/3_nda_secure_boot/0_secure_boot_index_nda')
const CURRENT_DOCNAME = 'rst_rtos/2_whc_wifi_bridge/1_wifi_bridge_toprst';

// 动态查找顶级分类函数（定义为全局函数）
window.findTopLevelChapter = function(docname) {
    console.log("Attempting to find top-level chapter for:", docname);
    let bestMatch = "";
    let bestTitle = "Unknown Chapter";

    // 按路径长度降序排序以确保最长匹配
    const sortedPaths = Object.keys(TOC_TITLE_MAP).sort((a, b) => b.length - a.length);

    for (const path of sortedPaths) {
        console.log("Checking path:", path);
        if (docname === path || docname.startsWith(path + '/')) { // 子页面
            bestMatch = path;
            bestTitle = TOC_TITLE_MAP[path];
            console.log("Matched path:", path, "with title:", bestTitle);
            break;
        }
    }

    // 如果没有找到任何匹配项，则尝试更短的路径
    if (bestMatch === "") {
        const pathSegments = docname.split('/');
        while (pathSegments.length > 1) { // 至少保留根路径
            const candidate = pathSegments.join('/');
            console.log("Checking shorter path:", candidate);
            if (TOC_TITLE_MAP[candidate]) {
                bestTitle = TOC_TITLE_MAP[candidate];
                console.log("Matched shorter path:", candidate, "with title:", bestTitle);
                break;
            }
            pathSegments.pop();
        }
    }

    console.log("Final top-level chapter:", bestTitle);
    return bestTitle;
}

// 初始化时调用
document.addEventListener('DOMContentLoaded', function() {
    const topLevelChapter = findTopLevelChapter(CURRENT_DOCNAME);
    console.log("Top Level Chapter:", topLevelChapter);

    // 将顶级分类插入到DOM中（根据需要）
    const chapterElement = document.createElement('div');
    chapterElement.className = 'top-level-chapter';
    chapterElement.innerHTML = `<strong>Top Level Chapter: </strong>${topLevelChapter}`;
    document.body.appendChild(chapterElement);
});
</script>

    <!-- 问题回报 -->
    <!-- source/_templates/_layout_issue_report.html -->
<div id="prompt-box" style="
    display: none;
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    z-index: 9999;
    text-align: center;
    font-size: 14px;
"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const reportButton = document.getElementById('report-button');
    const feedbackDialog = document.getElementById('feedback-dialog');
    const feedbackText = document.getElementById('feedback-text');
    const submitButton = document.getElementById('submit-feedback');
    const cancelButton = document.getElementById('cancel-feedback');
    const promptBox = document.getElementById('prompt-box');

    let selectedText = '';
    let selectedChapters = '';
    const language = 'en'; // 获取语言变量

    // 定义标题变量（顶格显示）
    const userHeader = 'User:';
    const chaptersHeader = 'Chapters:';
    const paragraphHeader = 'Paragraph:';
    const questionHeader = 'Question:';

    // 定义提示消息
    const saveSuccessMessage = language === 'zh_CN' ? '问题已保存到本地文件 feedback.txt' : 'Issue saved to local file feedback.txt';

    // 检查 findTopLevelChapter 是否已定义
    if (typeof window.findTopLevelChapter !== 'function') {
        console.error("findTopLevelChapter 函数未定义，请检查加载顺序！");
        return;
    }

    reportButton.addEventListener('click', function() {
        const selection = window.getSelection();
        selectedText = selection.toString();
        if (!selectedText) {
            alert('Please select the problematic content first');
            return;
        }

        // 收集章节信息
        let chapters = new Set(); // 使用 Set 来避免重复章节
        if (selection.rangeCount > 0) {
            const range = selection.getRangeAt(0);
            let node = range.commonAncestorContainer;

            // 确保从最近的元素节点开始
            while (node && node.nodeType !== Node.ELEMENT_NODE) {
                node = node.parentElement;
            }

            // 使用递归方法遍历DOM树
            function collectHeadings(node, level = 0) {
                if (!node) return;

                if (node.tagName && node.tagName.match(/^H[1-6]$/)) {
                    chapters.add(`${node.textContent.trim()}`);
                }

                if (node.previousElementSibling) {
                    collectHeadings(node.previousElementSibling, level);
                }

                if (node.parentElement && node.parentElement.tagName !== 'BODY') {
                    collectHeadings(node.parentElement, level + 1);
                }
            }

            collectHeadings(node);

            // 如果没有找到任何章节信息，则添加默认提示
            if (chapters.size === 0) {
                chapters.add('No chapter information found');
            }
        }

        // 获取顶级侧边栏章节
        const topLevelChapter = window.findTopLevelChapter(CURRENT_DOCNAME); // 调用全局函数
        chapters.add(`顶级分类：${topLevelChapter}`); // 插入到章节集合中

        // 添加章节标题
        const chapterHeader = language === 'zh_CN' ? '以下逐级向上追溯：' : 'Trace upwards level by level:';
        selectedChapters = chapterHeader + '\n' + Array.from(chapters).join('\n');

        feedbackDialog.style.display = 'block';
        feedbackText.value = '';
    });

    submitButton.addEventListener('click', function() {
        const userQuestion = feedbackText.value.trim();
        if (!userQuestion) {
            alert('Issue description cannot be empty');
            return;
        }

        // 获取用户信息（关键修改点）
        const username = localStorage.getItem('username') || '匿名'; // 从 localStorage 获取用户名

        // 统一处理内容缩进
        const formatContent = text => text.split('\n').map(line => '    ' + line).join('\n');

        // 生成消息内容（标题顶格，内容缩进）
        const message = `${userHeader}\n` + 
                        `${formatContent(username)}\n\n` +
                        `${chaptersHeader}\n` + 
                        `${formatContent(selectedChapters)}\n\n` +
                        `${paragraphHeader}\n` + 
                        `${formatContent(selectedText)}\n\n` +
                        `${questionHeader}\n` + 
                        `${formatContent(userQuestion)}`;

        // 提交到后端（关键修改点）
        const feedbackData = {
            user: username,  // 使用真实用户名
            chapters: selectedChapters,
            paragraph: selectedText,
            question: userQuestion
        };

        fetch('http://172.29.57.206:5000/submit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(feedbackData)
        })
        .then(response => response.json())
        .then(data => {
            console.log('提交成功:', data);
        })
        .catch(error => {
            console.error('提交失败:', error);
        });

        // 创建Blob对象并保存到本地文件
        const blob = new Blob([message], { type: 'text/plain' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'feedback.txt';
        link.click();

        // 显示提示框
        promptBox.textContent = saveSuccessMessage;
        promptBox.style.display = 'block';
        const promptTimeout = setTimeout(() => {
            promptBox.style.display = 'none';
        }, 10000);

        // 自动关闭反馈对话框
        feedbackDialog.style.display = 'none';
    });

    cancelButton.addEventListener('click', function() {
        feedbackDialog.style.display = 'none';
    });
});
</script>

    <style>
        /* 隐藏整个搜索栏容器 */
        .wy-side-nav-search > div[role="search"] {
            display: none !important;
        }

        /* 或者更精确地隐藏表单 */
        form#rtd-search-form {
            display: none !important;
        }
    </style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

    
    <div id="custom-selectors" style="display: block !important; padding: 0; background: none; border: none;">
    </div>

    <script>
    /* ====================== 嵌入式配置开始 ====================== */
    const embeddedConfig = {
        "freertos": {
            "name": "FreeRTOS",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        },
        "linux": {
            "name": "Linux",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        }
    };
    /* ====================== 嵌入式配置结束 ====================== */

    (function() {
        // 获取基础URL路径
        function getBaseURL() {
            const url = new URL(window.location.href);
            if (url.protocol === 'file:') {
                // 本地路径处理
                const pathParts = url.pathname.split('/').filter(part => part !== '');
                const index = pathParts.indexOf('build');
                return `file://${pathParts.slice(0, index + 1).join('/')}/`;
            } else {
                // 网络路径处理
                return `${url.origin}/${url.pathname.split('/').slice(1, 3).join('/')}/`;
            }
        }

        // 获取当前URL路径分段
        function getCurrentSegments() {
            const url = new URL(window.location.href);
            let segments = url.pathname.split('/').filter(segment => segment);

            if (url.protocol === 'file:') {
                // 本地路径处理
                const index = segments.indexOf('build');
                segments = segments.slice(index + 1); // 去掉 build 及之前的路径
            } else {
                // 网络路径处理
                segments = segments.slice(3); // 去掉 ameba-iot-docs/
            }

            return {
                osKey: segments[0] || 'freertos', // 默认为 freertos
                language: segments[1] || 'en',   // 默认为 en
                version: segments[2] || 'latest' // 默认为 latest
            };
        }

        // 获取OS显示名称列表
        function getOSNames(data) {
            return Object.keys(data).map(key => data[key].name);
        }

        // 获取指定OS的语言列表
        function getLanguages(data, osKey) {
            return Object.keys(data[osKey]?.languages || {});
        }

        // 获取指定OS和语言的版本列表
        function getVersions(data, osKey, language) {
            return data[osKey]?.languages?.[language] || ['latest'];
        }

        // 根据显示名称查找OS键
        function findOSKey(data, displayName) {
            return Object.keys(data).find(key => data[key].name === displayName);
        }

        // 初始化选择器
        function initSelectors() {
            const segments = getCurrentSegments();
            const currentOSName = embeddedConfig[segments.osKey]?.name;

            // 如果 OS 无效，默认设置为 FreeRTOS
            if (!currentOSName) {
                console.warn("Invalid OS key, defaulting to FreeRTOS");
                segments.osKey = 'freertos';
            }

            // 如果语言无效，默认设置为 en
            if (!getLanguages(embeddedConfig, segments.osKey).includes(segments.language)) {
                console.warn("Invalid language, defaulting to en");
                segments.language = 'en';
            }

            // 获取基础URL
            const baseURL = getBaseURL();

            // 生成选择器HTML
            document.getElementById('custom-selectors').innerHTML = `
                <div id="custom-selectors" style="padding: 0; background: none; border: none;">
                    <!-- 系统选择器 -->
                    <div class="selector-container">
                        <label class="selector-label">
                            ${segments.language === 'cn' ? '系统' : 'OS'}:
                        </label>
                        <select id="os-selector" class="selector-dropdown">
                            ${Object.keys(embeddedConfig).map(key => `
                                <option value="${key}">${embeddedConfig[key].name}</option>
                            `).join('')}
                        </select>
                    </div>

                    <!-- 语言选择器 -->
                    <div class="selector-container">
                        <label class="selector-label">
                            ${segments.language === 'cn' ? '语言' : 'Language'}:
                        </label>
                        <select id="language-selector" class="selector-dropdown">
                            ${getLanguages(embeddedConfig, segments.osKey).map(lang => `
                                <option value="${lang}">${lang}</option>
                            `).join('')}
                        </select>
                    </div>

                    <!-- 版本选择器 -->
                    <div class="selector-container version-selector-container">
                        <label class="selector-label">
                            ${segments.language === 'cn' ? '版本' : 'Version'}:
                        </label>
                        <select id="version-selector" class="selector-dropdown">
                            ${getVersions(embeddedConfig, segments.osKey, segments.language).map(ver => `
                                <option value="${ver}">${ver}</option>
                            `).join('')}
                        </select>
                    </div>

                    

                </div>`;

            // 设置初始选中值
            document.getElementById('os-selector').value = segments.osKey;
            document.getElementById('language-selector').value = segments.language;

            // 确保版本选择框有默认值
            const versionSelector = document.getElementById('version-selector');
            const availableVersions = getVersions(embeddedConfig, segments.osKey, segments.language);
            versionSelector.value = availableVersions.includes(segments.version) ? segments.version : availableVersions[0] || 'latest';

            // 绑定事件监听
            document.getElementById('os-selector').addEventListener('change', () => {
                const newOSKey = document.getElementById('os-selector').value;
                const availableLangs = getLanguages(embeddedConfig, newOSKey);
                const defaultLang = availableLangs[0] || 'en';
                const defaultVersion = getVersions(embeddedConfig, newOSKey, defaultLang)[0] || 'latest';
                redirectTo(`${baseURL}${newOSKey}/${defaultLang}/${defaultVersion}/`);
            });

            document.getElementById('language-selector').addEventListener('change', () => {
                const newLang = document.getElementById('language-selector').value;
                const defaultVersion = getVersions(embeddedConfig, segments.osKey, newLang)[0] || 'latest';
                redirectTo(`${baseURL}${segments.osKey}/${newLang}/${defaultVersion}/`);
            });

            document.getElementById('version-selector').addEventListener('change', () => {
                const newVer = document.getElementById('version-selector').value;
                redirectTo(`${baseURL}${segments.osKey}/${segments.language}/${newVer}/`);
            });

            // ====================== 新增代码：注册和登录的弹窗逻辑 ======================
            function createAuthDialog(type) {
                const lang = segments.language === 'cn' ? 'cn' : 'en';
                
                // 创建弹窗容器
                const dialog = document.createElement('div');
                dialog.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 9999;
                `;

                // 弹窗内容
                const content = document.createElement('div');
                content.style.cssText = `
                    background: white;
                    padding: 20px;
                    border-radius: 8px;
                    min-width: 300px;
                `;

                // 标题
                const title = document.createElement('h3');
                title.textContent = type === 'register' 
                    ? (lang === 'cn' ? '注册' : 'Register') 
                    : (lang === 'cn' ? '登录' : 'Login');
                content.appendChild(title);

                // 用户名输入
                const usernameLabel = document.createElement('label');
                usernameLabel.textContent = lang === 'cn' ? '用户名：' : 'Username:';
                const usernameInput = document.createElement('input');
                usernameInput.style.cssText = 'width: 100%; margin-bottom: 10px; padding: 5px;';
                content.appendChild(usernameLabel);
                content.appendChild(usernameInput);

                // 密码输入
                const passwordLabel = document.createElement('label');
                passwordLabel.textContent = lang === 'cn' ? '密码：' : 'Password:';
                const passwordInput = document.createElement('input');
                passwordInput.type = 'password';
                passwordInput.style.cssText = 'width: 100%; margin-bottom: 10px; padding: 5px;';
                content.appendChild(passwordLabel);
                content.appendChild(passwordInput);

                // 注册时需要确认密码
                let confirmPasswordInput;
                if (type === 'register') {
                    const confirmLabel = document.createElement('label');
                    confirmLabel.textContent = lang === 'cn' ? '确认密码：' : 'Confirm Password:';
                    confirmPasswordInput = document.createElement('input');
                    confirmPasswordInput.type = 'password';
                    confirmPasswordInput.style.cssText = 'width: 100%; margin-bottom: 10px; padding: 5px;';
                    content.appendChild(confirmLabel);
                    content.appendChild(confirmPasswordInput);
                }

                // 按钮容器
                const buttonContainer = document.createElement('div');
                buttonContainer.style.cssText = 'display: flex; gap: 10px; margin-top: 10px;';

                // 确认按钮
                const confirmBtn = document.createElement('button');
                confirmBtn.textContent = lang === 'cn' ? '确认' : 'Confirm';
                confirmBtn.onclick = () => {
                    const username = usernameInput.value.trim();
                    const password = passwordInput.value.trim();
                    const confirmPassword = confirmPasswordInput ? confirmPasswordInput.value.trim() : null;

                    // 验证输入
                    if (!username || !password) {
                        alert(lang === 'cn' ? '用户名和密码不能为空！' : 'Username and password are required!');
                        return;
                    }

                    if (type === 'register' && password !== confirmPassword) {
                        alert(lang === 'cn' ? '两次输入的密码不一致！' : 'Passwords do not match!');
                        return;
                    }

                    // flask 发送请求
                    fetch('http://172.29.57.206:5000/auth', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: type,
                            username,
                            password
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert(lang === 'cn' ? '操作成功！' : 'Success!');
                            // 更新本地存储和UI
                            localStorage.setItem('isLoggedIn', 'true');
                            localStorage.setItem('username', username);
                            // 强制刷新显示状态
                            document.getElementById('auth-buttons').style.display = 'none';
                            document.getElementById('user-info').style.display = 'block';
                            document.getElementById('username-display').textContent = username;
                            document.body.removeChild(dialog);
                        } else {
                            alert(lang === 'cn' ? '失败：' + data.message : 'Failed: ' + data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert(lang === 'cn' ? '网络错误' : 'Network error');
                    });
                };

                // 取消按钮
                const cancelBtn = document.createElement('button');
                cancelBtn.textContent = lang === 'cn' ? '取消' : 'Cancel';
                cancelBtn.onclick = () => document.body.removeChild(dialog);

                buttonContainer.appendChild(confirmBtn);
                buttonContainer.appendChild(cancelBtn);
                content.appendChild(buttonContainer);
                dialog.appendChild(content);
                document.body.appendChild(dialog);
            }

            // 注册按钮点击事件
            document.getElementById('register-button').addEventListener('click', () => {
                createAuthDialog('register');
            });

            // 登录按钮点击事件
            document.getElementById('login-button').addEventListener('click', () => {
                createAuthDialog('login');
            });

            // 跳转函数
            function redirectTo(path) {
                const url = new URL(path, window.location.href);
                if (url.protocol === 'file:') {
                    // 本地路径附加 index.html
                    url.pathname += 'index.html';
                }
                window.location.href = url.href;
            }

            /* =============== 左上角登录区域  =============== */
            function syncLoginState() {
                const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                document.getElementById('auth-buttons').style.display = isLoggedIn ? 'none' : 'flex';
                document.getElementById('user-info').style.display = isLoggedIn ? 'block' : 'none';
                if (isLoggedIn) {
                    document.getElementById('username-display').textContent = localStorage.getItem('username') || '';
                }
            }

            // 初始化同步状态
            syncLoginState();
            /* =============== 左上角登录区域  =============== */
        }

        // DOM加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            try {
                initSelectors();
            } catch (error) {
                console.error("Error initializing selectors:", error);
            }
        });
    })();
</script>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_product/0_ameba_product_center_index.html">Products Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_sdk/0_ameba_sdks_index.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_solutions/0_ameba_solutions_index.html">Ameba Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index.html">0.1 GCC Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gdb_debug/0_gdb_debug_index.html">0.2 GDB Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_library/0_gcc_build_library_index.html">0.3 GCC Build Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_example/0_sdk_example_index.html">0.4 SDK Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_memory_layout/0_layout_index.html">0.5 Flash &amp; RAM Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_user_config/0_usrcfg_index.html">0.6 User Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_tools/0_tools_index.html">0.7 Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_at_command/0_at_command_index.html">0.8 AT Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_file_system/0_vfs_index.html">0.9 Virtual File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_mpu_cache/0_mpu_cache_index.html">1.0 MPU and Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index.html">1.1 BOOT Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index.html">1.2 OTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_otpc/0_otpc_index.html">1.3 OTPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_chipen/0_chipen_index.html">1.4 Chip Enable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ipc/0_ipc_index.html">1.5 Inter Processor Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_pinmux/0_pinmux_index.html">1.6 Pin Multiplexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index.html">1.7 GPIO &amp; Pin Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index.html">1.9 Power Save</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_wifi_bridge_index.html">2.0 WHC Bridge</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">WiFi Bridge Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-interfaces">WiFi Bridge Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-features">WiFi Bridge Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-file-architecture">WiFi Bridge File Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-hardware-configuration">WiFi Bridge Hardware Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#interface-connections">Interface Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sdio-adapter-board">SDIO Adapter Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="#raspberry-pi-direct-connection">Raspberry Pi Direct Connection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-device-porting-guide">WiFi Bridge Device Porting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-host-porting-guide">WiFi Bridge Host Porting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-api">WiFi Bridge API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-linux-test">WiFi Bridge Linux Test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#app-architecture">APP Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#communication-stack">Communication Stack</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#supported-commands">Supported Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-execution">Build &amp; Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-procedure">Testing Procedure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#validation-results">Validation Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wifi-bridge-throughput">WiFi Bridge Throughput</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_fullmac/0_fullmac_index.html">2.1 WHC FullMAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_tunnel/0_wifi_tunnel_index.html">2.2 Wi-Fi R-Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_csi/0_wifi_csi_index.html">2.3 Wi-Fi CSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_adaptivity_test/0_wifi_adaptivity_index.html">2.4 Wi-Fi Adaptivity Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_security/0_security_index.html">3.1 Security &amp; Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_trng/0_trng_index.html">3.2 True Random Number Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_huk_derivation/0_huk_derivation_index_nda.html">3.3 HUK Derivation 🔒</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_rdp/0_rdp_index_nda.html">3.4 RDP 🔒</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_rsip/0_rsip_index_nda.html">3.5 RSIP 🔒</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_secure_boot/0_secure_boot_index_nda.html">3.6 Secure Boot 🔒</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_swd_protection/0_swd_protection_index_nda.html">3.7 SWD Protection 🔒</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_tfm/0_tfm_index_nda.html">3.8 Trusted Firmware-M (TF-M) 🔒</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_crypto_engine/0_crypto_engine_index.html">3.9 Crypto Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ecdsa_engine/0_ecdsa_index.html">3.a ECDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_eddsa_engine/0_eddsa_index.html">3.b EDDSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_rsa_engine/0_rsa_index.html">3.c RSA Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai/0_ai_index.html">4.1 AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai_voice/0_ai_voice_index.html">4.2 AIVoice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index.html">4.3 Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_dsp/0_dsp_index.html">4.4 DSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mass_production/0_mp_index.html">6.1 Mass Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mp_image/0_mp_image_index.html">6.2 MP Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mptools/0_mptools_index.html">6.3 MP Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index.html">7.1 USB Host &amp; Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index.html">8.1 DMA Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_psram/0_psram_index.html">8.2 PSRAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index.html">8.3 Thermal Meter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index.html">8.4 ADC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index.html">8.5 IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ledc/0_ledc_index.html">8.6 LED Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_cap_touch/0_cap_touch_index.html">8.7 Cap-Touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_key_scan/0_key_scan_index.html">8.8 Key-Scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc_io/0_rtc_io_index.html">8.9 RTC-IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index.html">8.A LCD Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_api_docs/0_api_index.html">10.0 API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">
    
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_wifi_bridge_index.html">WHC Bridge</a></li>
      <li class="breadcrumb-item active">WiFi Bridge Introduction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p id="wifi-bridge"><strong>Supported ICs</strong></p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Ameba SoC</p></th>
<th class="head"><p>RTL8721Dx</p></th>
<th class="head"><p>RTL8726EA</p></th>
<th class="head"><p>RTL8720EA</p></th>
<th class="head"><p>RTL8730E</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Supported</p></td>
<td><p>Y</p></td>
<td><p>N</p></td>
<td><p>N</p></td>
<td><p>N</p></td>
</tr>
</tbody>
</table>
<section id="wifi-bridge-introduction">
<h1>WiFi Bridge Introduction<a class="headerlink" href="#wifi-bridge-introduction" title="Link to this heading"></a></h1>
<p>The following figure is the high-level block diagram for WiFi bridge solution.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/wifi_bridge_architecture.svg"><img alt="../../_images/wifi_bridge_architecture.svg" height="398" src="../../_images/wifi_bridge_architecture.svg" width="824" /></a>
<figcaption>
<p><span class="caption-text">WiFi bridge architecture</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="wifi-bridge-interfaces">
<h1>WiFi Bridge Interfaces<a class="headerlink" href="#wifi-bridge-interfaces" title="Link to this heading"></a></h1>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">RTL8721Dx</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">Linux HOST</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">FreeRTOS HOST</button><button aria-controls="panel-1-1-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-2" name="1-2" role="tab" tabindex="-1">Zephyr HOST</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><table class="docutils align-center">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>Wi-Fi</p></th>
<th class="head"><p>BT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SDIO</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SPI</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-even"><td><p>USB</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-odd"><td><p>UART</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-even"><td><p>SDIO (Wi-Fi) + UART (BT)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SPI (Wi-Fi) + UART (BT)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-even"><td><p>USB (Wi-Fi) + UART (BT)</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><table class="docutils align-center">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>Wi-Fi</p></th>
<th class="head"><p>BT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SDIO</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SPI</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-even"><td><p>USB</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-odd"><td><p>UART</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-even"><td><p>SDIO (Wi-Fi) + UART (BT)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SPI (Wi-Fi) + UART (BT)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
</tr>
<tr class="row-even"><td><p>USB (Wi-Fi) + UART (BT)</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-2" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-2" name="1-2" role="tabpanel" tabindex="0"><table class="docutils align-center">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>Wi-Fi</p></th>
<th class="head"><p>BT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SDIO</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-odd"><td><p>SPI</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-even"><td><p>USB</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-odd"><td><p>UART</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-even"><td><p>SDIO (Wi-Fi) + UART (BT)</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-odd"><td><p>SPI (Wi-Fi) + UART (BT)</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr class="row-even"><td><p>USB (Wi-Fi) + UART (BT)</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
</tbody>
</table>
</div></div>
</div></div>
</section>
<section id="wifi-bridge-features">
<h1>WiFi Bridge Features<a class="headerlink" href="#wifi-bridge-features" title="Link to this heading"></a></h1>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Features</p></th>
<th class="head"><p>Linux host</p></th>
<th class="head"><p>FreeRTOS host</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Wi-Fi API</p></td>
<td><p>FreeRTOS Wi-Fi APIs</p></td>
<td><p>FreeRTOS Wi-Fi APIs</p></td>
</tr>
<tr class="row-odd"><td><p>Wi-Fi mode</p></td>
<td><ul class="simple">
<li><p>Station</p></li>
<li><p>SoftAP</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Station</p></li>
<li><p>SoftAP</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Wi-Fi security</p></td>
<td><ul class="simple">
<li><p>Open</p></li>
<li><p>WPA</p></li>
<li><p>WPA2</p></li>
<li><p>WPA3</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Open</p></li>
<li><p>WPA</p></li>
<li><p>WPA2</p></li>
<li><p>WPA3</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Wowlan</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-even"><td><p>Bluetooth features</p></td>
<td><ul class="simple">
<li><p>BLE 5.0</p></li>
<li><p>BLE 5.2</p></li>
<li><p>Bluetooth 5.3</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>BLE 5.0</p></li>
<li><p>BLE 5.2</p></li>
<li><p>Bluetooth 5.3</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="wifi-bridge-file-architecture">
<h1>WiFi Bridge File Architecture<a class="headerlink" href="#wifi-bridge-file-architecture" title="Link to this heading"></a></h1>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">RTOS HOST/DEV</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">Linux HOST</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├─ whc
│  ├─ README.md
│  ├─ whc_def.h
│  ├─ whc_dev
│  │  ├─ ipc
│  │  │  ├─ whc_ipc_dev_api.c
│  │  │  ├─ whc_ipc_dev_trx.c
│  │  │  ├─ whc_ipc_dev_trx.h
│  │  │  └─ whc_ipc_device.c
│  │  ├─ sdio
│  │  │  ├─ whc_bridge_sdio_dev.c
│  │  │  ├─ whc_bridge_sdio_dev.h
│  │  │  ├─ whc_fullmac_sdio_dev.c
│  │  │  ├─ whc_fullmac_sdio_dev.h
│  │  │  ├─ whc_sdio_drv.c
│  │  │  └─ whc_sdio_drv.h
│  │  ├─ spi
│  │  │  ├─ whc_bridge_spi_dev.c
│  │  │  ├─ whc_bridge_spi_dev.h
│  │  │  ├─ whc_fullmac_spi_dev.c
│  │  │  ├─ whc_fullmac_spi_dev.h
│  │  │  ├─ whc_spi_dev.c
│  │  │  └─ whc_spi_dev.h
│  │  ├─ usb
│  │  │  ├─ whc_usb_dev.c
│  │  │  └─ whc_usb_dev.h
<span class="hll">│  │  ├─ whc_bridge_dev_api.c
</span><span class="hll">│  │  ├─ whc_bridge_dev_api.h
</span>│  │  ├─ whc_dev.h
│  │  ├─ whc_dev_api.c
│  │  ├─ whc_dev_api.h
│  │  ├─ whc_dev_app.c
│  │  ├─ whc_dev_bridge.c
│  │  ├─ whc_dev_bridge.h
│  │  ├─ whc_dev_cust_evt.c
│  │  ├─ whc_dev_cust_evt.h
│  │  ├─ whc_dev_msg_queue.c
│  │  ├─ whc_dev_msg_queue.h
│  │  ├─ whc_dev_protocal_offload.c
│  │  ├─ whc_dev_protocal_offload.h
│  │  ├─ whc_dev_struct.h
│  │  ├─ whc_dev_trx.c
│  │  └─ whc_dev_trx.h
│  ├─ whc_host_rtos
│  │  ├─ ipc
│  │  │  ├─ whc_ipc_host.c
│  │  │  ├─ whc_ipc_host_api.c
│  │  │  ├─ whc_ipc_host_api.h
│  │  │  ├─ whc_ipc_host_api_basic.c
│  │  │  ├─ whc_ipc_host_api_ext.c
│  │  │  ├─ whc_ipc_host_trx.c
│  │  │  ├─ whc_ipc_host_trx.h
│  │  │  └─ whc_ipc_host_zephyr.c
│  │  ├─ spi
│  │  │  ├─ whc_spi_host.c
│  │  │  ├─ whc_spi_host.h
│  │  │  ├─ whc_spi_host_trx.c
│  │  │  └─ whc_spi_host_trx.h
│  │  ├─ whc_host.h
│  │  ├─ whc_host_api.c
│  │  ├─ whc_host_api.h
│  │  ├─ whc_host_api_basic.c
│  │  ├─ whc_host_api_ext.c
│  │  ├─ whc_host_cust_evt.c
│  │  ├─ whc_host_cust_evt.h
│  │  └─ whc_rtos
│  │     ├─ os_wrapper_memory.c
│  │     ├─ os_wrapper_mutex.c
│  │     └─ os_wrapper_semaphore.c
│  ├─ whc_ipc.h
│  ├─ whc_ipc_cfg.h
│  ├─ whc_ipc_msg_queue.c
│  └─ whc_ipc_msg_queue.h
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├─ whc_host_linux
│  ├─ Kconfig
│  ├─ Makefile
│  ├─ fullmac_setup.sh
│  ├─ bridge
│  │  ├─ Makefile
<span class="hll">│  │  ├─ whc_bridge_host_api.c
</span><span class="hll">│  │  ├─ whc_bridge_host_api.h
</span>│  │  ├─ whc_bridge_host_demo.c
│  │  ├─ whc_bridge_host_intf.h
│  │  ├─ whc_bridge_host_netlink.c
│  │  ├─ whc_bridge_host_netlink.h
│  │  ├─ whc_bridge_host_pkt_rx.c
│  │  ├─ whc_bridge_host_tx.c
│  │  ├─ sdio_bridge
│  │  │  └─ Kbuild
│  │  ├─ spi_bridge
│  │  │  ├─ whc_bridge_host_spi.c.c
│  │  │  └─ Kbuild
│  ├─ common
│  │  ├─ autoconf.h
│  │  ├─ whc_host_event.h
│  │  ├─ whc_host_hci.c
│  │  ├─ whc_host_hci.h
│  │  ├─ whc_host_memory.c
│  │  ├─ whc_host_ops.c
│  │  ├─ whc_host_pkt_rx.c
│  │  ├─ whc_host_pkt_tx.c
│  │  ├─ whc_host_trx.h
│  │  ├─ netdev
│  │  │  ├─ whc_host_drv_probe.c
│  │  │  ├─ whc_host_drv_probe.h
│  │  │  ├─ whc_host_ethtool_ops.c
│  │  │  ├─ whc_host_ethtool_ops.h
│  │  │  ├─ whc_host_function.h
│  │  │  ├─ whc_host_linux.h
│  │  │  ├─ whc_host_netdev_ops.c
│  │  │  ├─ whc_host_netdev_ops.h
│  │  │  └─ whc_host_wiphy.h
│  │  ├─ sdio
│  │  │  ├─ whc_sdio_host.h
│  │  │  ├─ whc_sdio_host_drvio.c
│  │  │  ├─ whc_sdio_host_drvio.h
│  │  │  ├─ whc_sdio_host_fwdl.c
│  │  │  ├─ whc_sdio_host_init.c
│  │  │  ├─ whc_sdio_host_ops.c
│  │  │  ├─ whc_sdio_host_ops.h
│  │  │  ├─ whc_sdio_host_probe.c
│  │  │  └─ whc_sdio_host_reg.h
│  │  ├─ spi
│  │  │  ├─ whc_spi_host.h
│  │  │  ├─ whc_spi_host_ops.c
│  │  │  ├─ whc_spi_host_probe.c
│  │  │  └─ spidev-overlay.dts
│  │  └─ usb
│  │     ├─ whc_usb_host.h
│  │     ├─ whc_usb_host_ops.c
│  │     └─ whc_usb_host_probe.c
</pre></div>
</div>
</div></div>
</section>
<section id="wifi-bridge-hardware-configuration">
<h1>WiFi Bridge Hardware Configuration<a class="headerlink" href="#wifi-bridge-hardware-configuration" title="Link to this heading"></a></h1>
<section id="interface-connections">
<h2>Interface Connections<a class="headerlink" href="#interface-connections" title="Link to this heading"></a></h2>
<p>Pin connections between Ameba and Raspberry Pi are as follows:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">Raspberry Pi</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>SoC</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="6"><p>SDIO</p></td>
<td><p>PB6</p></td>
<td><p>SDIO_DAT2</p></td>
<td rowspan="6"><p>SDIO pins</p></td>
</tr>
<tr class="row-odd"><td><p>PB7</p></td>
<td><p>SDIO_DAT3</p></td>
</tr>
<tr class="row-even"><td><p>PB8</p></td>
<td><p>SDIO_CMD</p></td>
</tr>
<tr class="row-odd"><td><p>PB9</p></td>
<td><p>SDIO_CLK</p></td>
</tr>
<tr class="row-even"><td><p>PB13</p></td>
<td><p>SDIO_DAT0</p></td>
</tr>
<tr class="row-odd"><td><p>PB14</p></td>
<td><p>SDIO_DAT1</p></td>
</tr>
<tr class="row-even"><td rowspan="6"><p>SPI</p></td>
<td><p>PB24</p></td>
<td><p>SPI_MOSI</p></td>
<td rowspan="6"><p>SPI pins</p></td>
</tr>
<tr class="row-odd"><td><p>PB25</p></td>
<td><p>SPI_MISO</p></td>
</tr>
<tr class="row-even"><td><p>PB23</p></td>
<td><p>SPI_CLK</p></td>
</tr>
<tr class="row-odd"><td><p>PB26</p></td>
<td><p>SPI_CS</p></td>
</tr>
<tr class="row-even"><td><p>PB8</p></td>
<td><p>DEV_TX_REQ</p></td>
</tr>
<tr class="row-odd"><td><p>PB9</p></td>
<td><p>DEV_READY</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>UART</p></td>
<td><p>PB14</p></td>
<td><p>SDIO_DAT1</p></td>
<td><p>SDIO_DAT1</p></td>
</tr>
<tr class="row-odd"><td><p>PB14</p></td>
<td><p>SDIO_DAT1</p></td>
<td><p>SDIO_DAT1</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>Raspberry Pi</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="6"><p>SDIO</p></td>
<td><p>GPIO 26</p></td>
<td><p>SDIO_DAT2</p></td>
<td rowspan="6"><p>SDIO pins</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO 27</p></td>
<td><p>SDIO_DAT3</p></td>
</tr>
<tr class="row-even"><td><p>GPIO 23</p></td>
<td><p>SDIO_CMD</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO 22</p></td>
<td><p>SDIO_CLK</p></td>
</tr>
<tr class="row-even"><td><p>GPIO 24</p></td>
<td><p>SDIO_DAT0</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO 25</p></td>
<td><p>SDIO_DAT1</p></td>
</tr>
<tr class="row-even"><td rowspan="6"><p>SPI</p></td>
<td><p>GPIO 10</p></td>
<td><p>SPI_MOSI</p></td>
<td rowspan="6"><p>SPI pins</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO 9</p></td>
<td><p>SPI_MISO</p></td>
</tr>
<tr class="row-even"><td><p>GPIO 11</p></td>
<td><p>SPI_CLK</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO 8</p></td>
<td><p>SPI_CS</p></td>
</tr>
<tr class="row-even"><td><p>GPIO 23</p></td>
<td><p>DEV_TX_REQ</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO 22</p></td>
<td><p>DEV_READY</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>UART</p></td>
<td><p>GPIO 25</p></td>
<td><p>SDIO_DAT1</p></td>
<td><p>SDIO_DAT1</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO 25</p></td>
<td><p>SDIO_DAT1</p></td>
<td><p>SDIO_DAT1</p></td>
</tr>
</tbody>
</table>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><strong>SPI DEV_TX_REQ</strong>: Ameba notifies Host of pending data transmission via rising edge on this pin</p></li>
<li><p><strong>SPI DEV_READY</strong>: Ameba status indicator</p>
<ul>
<li><p>High level (1): Device ready to receive data</p></li>
<li><p>Low level (0): Device busy (pause transmission)</p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>Default SDIO pins defined in Ameba SDK are used. Modify pinmux configuration in SPDIO_Board_Init function at:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">component</span><span class="o">/</span><span class="n">soc</span><span class="o">/</span><span class="n">amebadplus</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">spdio_api</span><span class="p">.</span><span class="n">c</span>
</pre></div>
</div>
</li>
<li><p>Host-side SDIO interrupt requirements:</p>
<ul class="simple">
<li><p>SDIO_DATA1 must be configured for SDIO function (not GPIO)</p></li>
<li><p>Switch to polling mode if Host doesn’t support SDIO interrupts</p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="sdio-adapter-board">
<h2>SDIO Adapter Board<a class="headerlink" href="#sdio-adapter-board" title="Link to this heading"></a></h2>
<p>To avoid signal interference from flying wires, use dedicated adapter board for SDIO connections:</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/sdio_adapter_board.jpg"><img alt="../../_images/sdio_adapter_board.jpg" src="../../_images/sdio_adapter_board.jpg" style="width: 335.5px; height: 248.5px;" /></a>
<figcaption>
<p><span class="caption-text">FullMAC SDIO Adapter Board (Physical Diagram)</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Realtek official adapter boards will be available soon. Currently request samples via &lt;<a class="reference external" href="mailto:claire_wang&#37;&#52;&#48;realsil&#46;com&#46;cn">claire_wang<span>&#64;</span>realsil<span>&#46;</span>com<span>&#46;</span>cn</a>&gt;.</p>
</div>
</section>
<section id="raspberry-pi-direct-connection">
<h2>Raspberry Pi Direct Connection<a class="headerlink" href="#raspberry-pi-direct-connection" title="Link to this heading"></a></h2>
<p>For high-speed scenarios, directly solder Ameba SDIO pins to Raspberry Pi GPIO:</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../_images/connection_with_raspberry_pi.jpg"><img alt="../../_images/connection_with_raspberry_pi.jpg" src="../../_images/connection_with_raspberry_pi.jpg" style="width: 254.5px; height: 227.0px;" /></a>
<figcaption>
<p><span class="caption-text">Ameba-Raspberry Pi Direct Connection Diagram</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="wifi-bridge-device-porting-guide">
<h1>WiFi Bridge Device Porting Guide<a class="headerlink" href="#wifi-bridge-device-porting-guide" title="Link to this heading"></a></h1>
<ol class="arabic">
<li><p><strong>Project Configuration</strong></p>
<p>Execute in project directory (example path: <code class="docutils literal notranslate"><span class="pre">{SDK}/amebaxxx_gcc_project</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./menuconfig.py
</pre></div>
</div>
<ol class="loweralpha">
<li><p>Navigate through menu path for bridge mode selection:</p>
<p>Locate <span class="menuselection">CONFIG_WHC_ITNF ‣ WHC Mode ‣ WHC_BRIDGE</span>, and select the desired interface:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">SDIO</button><button aria-controls="panel-4-4-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-1" name="4-1" role="tab" tabindex="-1">SPI</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><p>To select the <span class="menuselection">WHC_INTF_SDIO</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Top</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CONFIG</span> <span class="n">WHC</span> <span class="n">INTF</span>
<span class="o">----</span><span class="n">Configuration</span><span class="o">----</span>
<span class="hll">    <span class="n">WHC</span> <span class="n">MODE</span> <span class="p">(</span><span class="n">WHC_BRIDGE</span><span class="p">)</span>  <span class="o">---&gt;</span>
</span><span class="hll">    <span class="n">HW</span> <span class="n">INTERFACE</span> <span class="p">(</span><span class="n">WHC_INTF_SDIO</span><span class="p">)</span>  <span class="o">---&gt;</span>
</span></pre></div>
</div>
</div><div aria-labelledby="tab-4-4-1" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-1" name="4-1" role="tabpanel" tabindex="0"><p>To select the <span class="menuselection">WHC_INTF_SPI</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Top</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CONFIG</span> <span class="n">WHC</span> <span class="n">INTF</span>
<span class="o">----</span><span class="n">Configuration</span><span class="o">----</span>
<span class="hll">    <span class="n">WHC</span> <span class="n">MODE</span> <span class="p">(</span><span class="n">WHC_BRIDGE</span><span class="p">)</span>  <span class="o">---&gt;</span>
</span><span class="hll">    <span class="n">HW</span> <span class="n">INTERFACE</span> <span class="p">(</span><span class="n">WHC_INTF_SPI</span><span class="p">)</span>  <span class="o">---&gt;</span>
</span></pre></div>
</div>
</div></div>
</li>
</ol>
</li>
<li><p><strong>Firmware Compilation</strong></p>
<p>Build the image with compile command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./build.py
</pre></div>
</div>
</li>
<li><p><strong>Image Flashing</strong></p>
<p>Flash the generated image to development board using programming tool.</p>
</li>
</ol>
</section>
<section id="wifi-bridge-host-porting-guide">
<h1>WiFi Bridge Host Porting Guide<a class="headerlink" href="#wifi-bridge-host-porting-guide" title="Link to this heading"></a></h1>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">RTOS</button><button aria-controls="panel-5-5-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-1" name="5-1" role="tab" tabindex="-1">Linux Environment</button><button aria-controls="panel-5-5-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-2" name="5-2" role="tab" tabindex="-1">Raspberry Pi</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"></div><div aria-labelledby="tab-5-5-1" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-1" name="5-1" role="tabpanel" tabindex="0"><p>The current driver code has been validated on <strong>Linux Kernel v5.15</strong>. For compilation issues with other kernel versions, please contact the Realtek technical support team.</p>
<p class="rubric">Local SDK Environment Operations</p>
<ol class="arabic">
<li><p>Navigate to driver configuration directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="o">{</span>SDK<span class="o">}</span>/component/wifi/whc_host_linux
</pre></div>
</div>
</li>
<li><p>Execute interface deployment script (supports SDIO/SPI etc.):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-6-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-6-6-0" name="6-0" role="tab" tabindex="0">SDIO</button><button aria-controls="panel-6-6-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-6-6-1" name="6-1" role="tab" tabindex="-1">SPI</button></div><div aria-labelledby="tab-6-6-0" class="sphinx-tabs-panel" id="panel-6-6-0" name="6-0" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./fullmac_setup.sh<span class="w"> </span>sdio<span class="w"> </span>bridge
</pre></div>
</div>
</div><div aria-labelledby="tab-6-6-1" class="sphinx-tabs-panel" hidden="true" id="panel-6-6-1" name="6-1" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./fullmac_setup.sh<span class="w"> </span>spi<span class="w"> </span>bridge
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SPI initiates data transmission immediately after CS pin goes low and detects CLK. Potential edge cases may occur during bus contention:
Testing shows adding 7μs delay between CS low and host CLK push ensures safe data transmission under busy conditions.
Older SPI driver versions may lack <code class="docutils literal notranslate"><span class="pre">spi_delay</span></code> support, requiring direct code modification to implement delay.</p>
</div>
</div></div>
</li>
<li><p>Select target device model via interactive interface</p></li>
<li><p>Copy entire <code class="docutils literal notranslate"><span class="pre">whc_host_linux</span></code> directory to Linux host</p></li>
</ol>
<p class="rubric">Linux Host Operations</p>
<ol class="arabic" start="5">
<li><p>Install build toolchain:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>build-essential
</pre></div>
</div>
</li>
<li><p>Compile and load driver module:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-7-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-7-7-0" name="7-0" role="tab" tabindex="0">SDIO</button><button aria-controls="panel-7-7-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-7-7-1" name="7-1" role="tab" tabindex="-1">SPI</button></div><div aria-labelledby="tab-7-7-0" class="sphinx-tabs-panel" id="panel-7-7-0" name="7-0" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="o">{</span>driver_path<span class="o">}</span>/whc_host_linux
make
sudo<span class="w"> </span>cp<span class="w"> </span>bridge/sdio_bridge/bridge_sdio.ko<span class="w"> </span>/lib/modules/<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>/
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>dhcpcd.service
sudo<span class="w"> </span>depmod<span class="w"> </span>-a
sudo<span class="w"> </span>modprobe<span class="w"> </span>bridge_sdio
</pre></div>
</div>
</div><div aria-labelledby="tab-7-7-1" class="sphinx-tabs-panel" hidden="true" id="panel-7-7-1" name="7-1" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="o">{</span>driver_path<span class="o">}</span>/whc_host_linux
make
sudo<span class="w"> </span>cp<span class="w"> </span>bridge/spi_bridge/bridge_spi.ko<span class="w"> </span>/lib/modules/<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>/
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>dhcpcd.service
sudo<span class="w"> </span>depmod<span class="w"> </span>-a
sudo<span class="w"> </span>modprobe<span class="w"> </span>bridge_spi
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{driver_path}</span></code>: Actual storage path of driver directory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$(uname</span> <span class="pre">-r)</span></code>: Automatically detects current kernel version</p></li>
</ul>
</div>
</li>
<li><p>Enable network interfaces:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>ifconfig<span class="w"> </span>eth_sta0<span class="w"> </span>up
sudo<span class="w"> </span>ifconfig<span class="w"> </span>eth_sta1<span class="w"> </span>up
</pre></div>
</div>
</li>
<li><p>Verify interface status:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig
</pre></div>
</div>
</li>
</ol>
</div><div aria-labelledby="tab-5-5-2" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-2" name="5-2" role="tabpanel" tabindex="0"><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-8-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-8-8-0" name="8-0" role="tab" tabindex="0">SDIO</button><button aria-controls="panel-8-8-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-1" name="8-1" role="tab" tabindex="-1">SPI</button></div><div aria-labelledby="tab-8-8-0" class="sphinx-tabs-panel" id="panel-8-8-0" name="8-0" role="tabpanel" tabindex="0"><p>Driver currently validated on <strong>Raspberry Pi 4 Model B</strong> (Broadcom BCM2711) with Raspberry Pi OS based on Debian 11 and <strong>Raspberry 5</strong> (Broadcom BCM2712) with Raspberry Pi OS based on Debian 12.</p>
<ol class="arabic">
<li><p>Enable SDIO interface setup:</p>
<p>Raspberry Pi 4 or 4B:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add device tree overlay in /boot/config.txt</span>
sudo<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;echo &quot;dtoverlay=sdio,poll_once=off&quot; &gt;&gt; /boot/config.txt&#39;</span>
</pre></div>
</div>
<p>Raspberry Pi 5:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add device tree overlay in /boot/firmware/config.txt</span>
sudo<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;echo &quot;dtoverlay=sdio,poll_once=off&quot; &gt;&gt; /boot/firmware/config.txt&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This configuration disables SDIO bus polling for better stability</p>
</div>
</li>
<li><p>Subsequent steps align with linux_host_porting steps 3-7:</p></li>
</ol>
</div><div aria-labelledby="tab-8-8-1" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-1" name="8-1" role="tabpanel" tabindex="0"><ol class="lowerroman">
<li><p>Enable SPI interface:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>raspi-config
</pre></div>
</div>
</li>
<li><p>Select <span class="menuselection">Interface Options &gt; SPI &gt; Yes</span>:</p></li>
</ol>
<blockquote>
<div><figure class="align-center">
<a class="reference internal image-reference" href="../../_images/bridge_raspberry_pi_spi_config.png"><img alt="../../_images/bridge_raspberry_pi_spi_config.png" src="../../_images/bridge_raspberry_pi_spi_config.png" style="width: 640.0px; height: 268.0px;" /></a>
</figure>
</div></blockquote>
<ol class="lowerroman simple" start="3">
<li><p>Generate device tree overlay:</p></li>
</ol>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>su
<span class="nb">cd</span><span class="w"> </span><span class="o">{</span>driver_path<span class="o">}</span>/whc_host_linux/common/spi
dtc<span class="w"> </span>-@<span class="w"> </span>-Hepapr<span class="w"> </span>-I<span class="w"> </span>dts<span class="w"> </span>-O<span class="w"> </span>dtb<span class="w"> </span>-o<span class="w"> </span>inic_spidev.dtbo<span class="w"> </span>spidev-overlay.dts
cp<span class="w"> </span>inic_spidev.dtbo<span class="w"> </span>/boot/overlays/
dtoverlay<span class="w"> </span>inic_spidev
</pre></div>
</div>
</div></blockquote>
<ol class="lowerroman simple" start="4">
<li><p>Subsequent steps align with linux_host_porting steps:</p></li>
</ol>
</div></div>
</div></div>
</section>
<section id="wifi-bridge-api">
<h1>WiFi Bridge API<a class="headerlink" href="#wifi-bridge-api" title="Link to this heading"></a></h1>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"></div><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-10-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-10-10-0" name="10-0" role="tab" tabindex="0">Linux HOST</button><button aria-controls="panel-10-10-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-10-10-1" name="10-1" role="tab" tabindex="-1">RTOS DEVICE</button></div><div aria-labelledby="tab-10-10-0" class="sphinx-tabs-panel" id="panel-10-10-0" name="10-0" role="tabpanel" tabindex="0"><p><strong>API Documentation</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Kernel Layer APIs
whc_bridge_host_tx.c
whc_bridge_host_netlink.c

# User Space Layer APIs
whc_bridge_host_demo.c
</pre></div>
</div>
<p><strong>whc_bridge_host_send_data_to_dev</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">whc_bridge_host_send_data_to_dev</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">pbuf</span><span class="p">,</span><span class="w"> </span><span class="n">u32</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">u32</span><span class="w"> </span><span class="n">with_txdesc</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Overview</p></td>
<td><p>Sends data from the kernel to the device</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>pbuf: Address of the data buffer</p></li>
<li><p>len: Length of the data</p></li>
<li><p>with_txdesc: Whether the buffer has a reserved TX descriptor</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_host_buf_rx_to_user</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">__attribute__</span><span class="p">((</span><span class="n">weak</span><span class="p">))</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">whc_bridge_host_buf_rx_to_user</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">u16</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Overview</p></td>
<td><p>Receives data from the device to the host.</p>
<p>This is a weak function,
the SDK sends data from the kernel to user space.</p>
<p>Customers not using the bridge app need to implement this function.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>buf: Address of the received data</p></li>
<li><p>size: Length of the received data (including padding)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>Data reception result:</p>
<ul class="simple">
<li><p>0: Data successfully transferred to user space</p></li>
<li><p>Other: Data reception error</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_host_api_send_nl_data</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">whc_bridge_host_api_send_nl_data</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">buf_len</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Overview</p></td>
<td><p>Sends data from user space to the kernel.</p>
<p>which processes or forwards the data to the device based on the
buffer content</p>
</td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>buf: Address of the data buffer</p></li>
<li><p>buf_len: Length of the data</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>Data transmission result:</p>
<ul class="simple">
<li><p>0: Data sent successfully</p></li>
<li><p>Other: Data transmission error</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-10-10-1" class="sphinx-tabs-panel" hidden="true" id="panel-10-10-1" name="10-1" role="tabpanel" tabindex="0"><p><strong>API Documentation</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>whc_bridge_dev_api.c
</pre></div>
</div>
<p><strong>whc_bridge_dev_api_add_filter_node</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_add_filter_node</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">whc_bridge_dev_pkt_filter</span><span class="w"> </span><span class="o">*</span><span class="n">filter</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Add new filtering rule to the list</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>filter: Pointer to <cite>whc_bridge_dev_pkt_filter</cite> structure
(contains filter configuration)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_dev_api_get_filter_node</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_get_filter_node</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">whc_bridge_dev_pkt_filter</span><span class="w"> </span><span class="o">*</span><span class="n">filter</span><span class="p">,</span><span class="w"> </span><span class="n">u32_t</span><span class="w"> </span><span class="n">identity</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Query registered filter configuration by unique identifier</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>filter: Output parameter (stores query result)</p></li>
<li><p>identity: Unique identifier of the filter entry</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_dev_api_delete_filter_node</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_delete_filter_node</span><span class="p">(</span><span class="n">u32_t</span><span class="w"> </span><span class="n">identity</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Remove filter entry with specified ID from the list</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>identity: Target filter entry identifier</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_dev_api_set_host_state</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_set_host_state</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Update host’s data reception readiness status</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>state: Status flag (<cite>WHC_BRIDGE_HOST_READY</cite>/<cite>WHC_BRIDGE_HOST_UNREADY</cite>)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_dev_api_get_host_rdy</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_get_host_rdy</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Get current host data reception capability status</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><ul class="simple">
<li><p><cite>WHC_BRIDGE_HOST_READY</cite>: Host ready to receive data</p></li>
<li><p><cite>WHC_BRIDGE_HOST_UNREADY</cite>: Host not ready</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_dev_api_set_default_direction</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_set_default_direction</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="n">dir</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Define default forwarding behavior for unmatched packets</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><p>dir: Forwarding direction enumeration:</p>
<ul class="simple">
<li><p><cite>PORT_TO_HOST</cite>: Forward to host only</p></li>
<li><p><cite>PORT_TO_BOTH</cite>: Forward to both host and application layer</p></li>
<li><p><cite>PORT_TO_UP</cite>: Forward to application layer only</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_dev_api_get_default_direction</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_get_default_direction</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Get currently active default forwarding policy</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>Currently active forwarding direction enumeration</p></td>
</tr>
</tbody>
</table>
<p><strong>whc_bridge_dev_api_send_to_host</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">whc_bridge_dev_api_send_to_host</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">u32</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functionality</p></td>
<td><p>Transmit data to host</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><ul class="simple">
<li><p>data: Pointer to data buffer</p></li>
<li><p>len: Valid data length (in bytes)</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Return Value</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="wifi-bridge-linux-test">
<h1>WiFi Bridge Linux Test<a class="headerlink" href="#wifi-bridge-linux-test" title="Link to this heading"></a></h1>
<section id="app-architecture">
<h2>APP Architecture<a class="headerlink" href="#app-architecture" title="Link to this heading"></a></h2>
<p>The demo APP implements bidirectional control through two command categories:</p>
<ol class="arabic simple">
<li><p><strong>Kernel-level Configuration</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">setmac</span></code>: Configure device MAC address</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netifon</span></code>: Activate network interface carrier</p></li>
</ul>
</li>
<li><p><strong>Device-level Control</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">getmac</span></code>: Retrieve device MAC address</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getip</span></code>: Fetch device IP configuration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setrdy</span></code>: Notify device host status</p></li>
</ul>
</li>
</ol>
<section id="communication-stack">
<h3>Communication Stack<a class="headerlink" href="#communication-stack" title="Link to this heading"></a></h3>
<figure class="align-center" id="control-flow-en">
<a class="reference internal image-reference" href="../../_images/bridge_testapp_control_flow.svg"><img alt="../../_images/bridge_testapp_control_flow.svg" height="244" src="../../_images/bridge_testapp_control_flow.svg" width="338" /></a>
</figure>
</section>
</section>
<section id="supported-commands">
<h2>Supported Commands<a class="headerlink" href="#supported-commands" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Command Syntax</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">init</span></code></p></td>
<td><p>Initialize Netlink communication channel</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getmac</span> <span class="pre">&lt;device_idx&gt;</span></code></p></td>
<td><p>Retrieve device MAC address</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">device_idx</span></code>: The device port index can only be 0 or 1:</p>
<p>where 0 corresponds to eth_sta0 (STA on the device side)</p>
<p>and 1 corresponds to eth_sta1 (SoftAP on the device side).</p>
</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">getip</span> <span class="pre">&lt;device_idx&gt;</span></code></p></td>
<td><p>Fetch network layer configuration</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">device_idx</span></code>: The device port index and it is same to
“getmac”.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">setrdy</span></code></p></td>
<td><p>Notify device host readiness</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">setmac</span> <span class="pre">&lt;device_idx&gt;</span> <span class="pre">&lt;mac&gt;</span></code></p></td>
<td><p>Configure interface hardware address</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">device_idx</span></code>: The device port index and it is same to
“getmac”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mac</span></code>: MAC format (xx:xx:xx:xx:xx:xx)</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">netifon</span> <span class="pre">&lt;device_idx&gt;</span></code></p></td>
<td><p>Activate physical layer carrier</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">device_idx</span></code>: The device port index and it is same to
“getmac”.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>In our kernel driver, the carrier state of the network device (net_device) is off by default, causing the device to not work properly. Use the “netifon” command to enable the carrier state, similar to calling the <code class="docutils literal notranslate"><span class="pre">netif_carrier_on</span></code> function. Developers should call <code class="docutils literal notranslate"><span class="pre">netif_carrier_on</span></code> to ensure proper device operation.</p></li>
<li><p>In our provided kernel driver, the network device (net_device) has a default MAC address of 00:00:00:00:00:00. Use the “setmac” command to configure the correct MAC address. Developers must set the correct physical address for the network device. Refer to the “getmac” and “setmac” commands for more details.</p></li>
</ol>
</div>
</section>
<section id="build-execution">
<h2>Build &amp; Execution<a class="headerlink" href="#build-execution" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Navigate to bridge module</span>
<span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">SDK</span><span class="si">}</span>/component/wifi/whc_host_linux/bridge

<span class="c1"># Build executable</span>
make

<span class="c1"># Run with privileges</span>
sudo<span class="w"> </span>./bridge
</pre></div>
</div>
</section>
<section id="testing-procedure">
<h2>Testing Procedure<a class="headerlink" href="#testing-procedure" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p><strong>Initial Configuration</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start console</span>
&gt;<span class="w"> </span>init
&gt;<span class="w"> </span>getmac<span class="w"> </span><span class="m">0</span>
<span class="m">00</span>:0A:35:XX:XX:XX
&gt;<span class="w"> </span>setmac<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">00</span>:0A:35:11:22:33
&gt;<span class="w"> </span>getip<span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
</li>
<li><p><strong>Network Configuration</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign IP address</span>
sudo<span class="w"> </span>ip<span class="w"> </span>addr<span class="w"> </span>add<span class="w"> </span><span class="m">192</span>.168.1.100/24<span class="w"> </span>dev<span class="w"> </span>eth_sta0
sudo<span class="w"> </span>ip<span class="w"> </span>link<span class="w"> </span><span class="nb">set</span><span class="w"> </span>eth_sta0<span class="w"> </span>up
</pre></div>
</div>
</li>
<li><p><strong>Data Path Validation</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enable communication</span>
&gt;<span class="w"> </span>setrdy
&gt;<span class="w"> </span>netifon<span class="w"> </span><span class="m">0</span>

<span class="c1"># Perform network test</span>
ping<span class="w"> </span><span class="m">192</span>.168.1.1
</pre></div>
</div>
</li>
</ol>
<section id="validation-results">
<h3>Validation Results<a class="headerlink" href="#validation-results" title="Link to this heading"></a></h3>
<figure class="align-center" id="bridge-testapp-control-flow-en">
<a class="reference internal image-reference" href="../../_images/bridge_testapp_control_flow.png"><img alt="../../_images/bridge_testapp_control_flow.png" src="../../_images/bridge_testapp_control_flow.png" style="width: 561.6px; height: 323.20000000000005px;" /></a>
<figcaption>
<p><span class="caption-text">Test application control flow</span><a class="headerlink" href="#bridge-testapp-control-flow-en" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="ifconfig-result-en">
<a class="reference internal image-reference" href="../../_images/bridge_ifconfig_result.png"><img alt="../../_images/bridge_ifconfig_result.png" src="../../_images/bridge_ifconfig_result.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-text">Interface status verification</span><a class="headerlink" href="#ifconfig-result-en" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="wifi-bridge-throughput">
<h1>WiFi Bridge Throughput<a class="headerlink" href="#wifi-bridge-throughput" title="Link to this heading"></a></h1>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-11-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-11-11-0" name="11-0" role="tab" tabindex="0">SDIO</button><button aria-controls="panel-11-11-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-11-11-1" name="11-1" role="tab" tabindex="-1">SPI</button></div><div aria-labelledby="tab-11-11-0" class="sphinx-tabs-panel" id="panel-11-11-0" name="11-0" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Bandwidth 20M</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TCP TX</p></td>
<td><p>42Mbps</p></td>
</tr>
<tr class="row-odd"><td><p>TCP RX</p></td>
<td><p>42Mbps</p></td>
</tr>
<tr class="row-even"><td><p>UDP TX</p></td>
<td><p>53Mbps</p></td>
</tr>
<tr class="row-odd"><td><p>UDP RX</p></td>
<td><p>52Mbps</p></td>
</tr>
</tbody>
</table>
<p>Test conditions:</p>
<ul class="simple">
<li><p>Image2 running on PSRAM</p></li>
<li><p>AP: xiaomi AX3000</p></li>
<li><p>Host platform: Linux PC</p></li>
</ul>
</div><div aria-labelledby="tab-11-11-1" class="sphinx-tabs-panel" hidden="true" id="panel-11-11-1" name="11-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Bandwidth 20M</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TCP TX</p></td>
<td><p>17.8Mbps</p></td>
</tr>
<tr class="row-odd"><td><p>TCP RX</p></td>
<td><p>17.5Mbps</p></td>
</tr>
<tr class="row-even"><td><p>UDP TX</p></td>
<td><p>19.2Mbps</p></td>
</tr>
<tr class="row-odd"><td><p>UDP RX</p></td>
<td><p>18.9Mbps</p></td>
</tr>
</tbody>
</table>
<p>Test conditions:</p>
<ul class="simple">
<li><p>Image2 running on FLASH</p></li>
<li><p>AP: Netcore AC1</p></li>
<li><p>Host platform: Raspberry 5, Linux 6.6.31+rpt-rpi-2712</p></li>
</ul>
</div></div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="0_wifi_bridge_index.html" class="btn btn-neutral float-left" title="WHC Bridge" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../2_whc_fullmac/0_fullmac_index.html" class="btn btn-neutral float-right" title="FullMAC" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Realsil.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
    <!-- 问题反馈按钮和对话框 -->
    
    <div id="feedback-dialog" class="feedback-dialog" style="display: none;">
        <p>Please describe your issue:</p>
        <textarea id="feedback-text" placeholder="Feature enhancement in progress, please stay tuned..."></textarea>
        <button id="submit-feedback">Submit</button>
        <button id="cancel-feedback">Cancel</button>
    </div>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
     
    


</body>
</html>