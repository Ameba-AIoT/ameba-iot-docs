

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>概述 &mdash; Ameba IoT Docs  文档</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=b947ea82" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=b947ea82" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=7d86a446"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script src="../../_static/tabs.js?v=3030b3cb"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../../_static/translations.js?v=beaddf03"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="芯片使能（CHIP_EN）" href="../1_chipen/0_chipen_index_cn.html" />
    <link rel="prev" title="OTP 存储器" href="0_otpc_index_cn.html" />
     

    
        
        <script>
        // 配置豁免路径（需要与后端路由完全匹配）
        const EXEMPT_PATHS = [
            '/_',                     // Sphinx生成路径
            '/_static',               // 静态资源路径
            '/_images',               // 图片资源
            '/auth',                  // 认证端点
            '/login',                 // 登录页面
            '/logout',                // 登出端点
            '/check_session',         // 会话检查
            '/nda_restricted'         // 无权限提示页
        ];

        // 增强型路径检查
        function isExemptPath(targetPath = window.location.pathname) {
            const path = targetPath.toLowerCase();
            const fullExemptPaths = EXEMPT_PATHS.concat(
                EXEMPT_PATHS.map(p => `/en${p}`),  // 英文路径
                EXEMPT_PATHS.map(p => `/zh_CN${p}`) // 中文路径
            );

            return fullExemptPaths.some(exempt => {
                // 精确匹配或前缀匹配
                return path === exempt.toLowerCase() || 
                    path.startsWith(exempt.toLowerCase() + '/');
            });
        }
        </script>
    

    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />

    <!-- NDA文档输入密码的框 -->
    
<script>
// ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼ 多语言配置 ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼
const lang = 'zh';  // 使用 Python 字符串切片
const i18n = {
    zh: {
        title: '访问授权',
        username: '用户名',
        password: '密码',
        confirm: '确认',
        cancel: '取消',
        usernameError: '用户名错误',
        userNotExist: '该用户不存在',
        passwordError: '密码错误',
        wrongPassword: '请输入正确的密码',
        accessDenied: '无访问权限',
        noPermission: '您无权查看此内容',
        expiredTitle: '访问已过期',
        expiredMsg: '您的权限已失效<br>有效期：%s 至 %s',
        deniedTitle: '⚠️ 无访问权限',
        contact: '请联系 claire_wang@realsil.com.cn 获取权限'
    },
    en: {
        title: 'Access Required',
        username: 'Username',
        password: 'Password',
        confirm: 'Confirm',
        cancel: 'Cancel',
        usernameError: 'Invalid Username',
        userNotExist: 'User does not exist',
        passwordError: 'Wrong Password',
        wrongPassword: 'Please enter correct password',
        accessDenied: 'Access Denied',
        noPermission: 'You have no permission to view this content',
        expiredTitle: 'Authorization Expired',
        expiredMsg: 'Your access has expired<br>Valid period: %s to %s',
        deniedTitle: '⚠️ Access Denied',
        contact: 'Please contact claire_wang@realsil.com.cn for access'
    }
};
// ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲ 多语言配置结束 ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲
</script>

    <!-- 样式模板 -->
    

<style>
    .wy-nav-content {
        max-width: 1100px;
         
    }
    
    .auth-denied {
        padding: 20px;
        background: #f8f9fa;
        border-radius: 4px;
        border: 1px solid #dee2e6;
        text-align: center;
        color: #721c24;
        margin-top: 20px;
    }
    .auth-denied h3 {
        margin-bottom: 10px;
        color: #dc3545;
    }
    
    #report-button {
        position: fixed;
        top: 10px;
        left: 1270px;
        padding: 1px 15px; /* 调整内边距：1px 为上下，5px 为左右 */
        height: 30px; /* 设置固定高度 */
        background-color: #2ecc71;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        z-index: 1000;
    }
    #report-button:hover {
        background-color: #2ecc71;
    }
    
    .feedback-dialog {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        z-index: 1001;
        width: 600px;
    }
    .feedback-dialog textarea {
        width: 100%;
        height: 150px;
        margin-top: 10px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        resize: vertical;
    }
    .feedback-dialog button {
        margin-top: 10px;
        padding: 8px 16px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    .feedback-dialog button:hover {
        background-color: #0056b3;
    }

    
    
</style>



    <!-- 注入 TOC 映射和当前页面信息 -->
    

<!-- TOC 映射和当前文档信息 -->
<script>
// 将 Python 字典转换为 JS 对象
const TOC_TITLE_MAP = {"rst_rtos/0_ameba_product": "\u4ea7\u54c1\u4e2d\u5fc3", "rst_rtos/0_ameba_product/0_ameba_product_center_index_cn": "\u4ea7\u54c1\u4e2d\u5fc3", "rst_rtos/0_ameba_sdk": "Ameba SDK", "rst_rtos/0_ameba_sdk/0_ameba_sdks_index_cn": "Ameba SDK", "rst_rtos/0_ameba_solutions": "\u89e3\u51b3\u65b9\u6848", "rst_rtos/0_ameba_solutions/0_ameba_solutions_index_cn": "\u89e3\u51b3\u65b9\u6848", "rst_rtos/0_at_command": "0.8 AT \u547d\u4ee4\u96c6", "rst_rtos/0_at_command/0_at_command_index_cn": "0.8 AT \u547d\u4ee4\u96c6", "rst_rtos/0_build_system": "0.3 \u6784\u5efa\u7cfb\u7edf", "rst_rtos/0_build_system/0_build_system_index_cn": "0.3 \u6784\u5efa\u7cfb\u7edf", "rst_rtos/0_file_system": "0.9 \u865a\u62df\u6587\u4ef6\u7cfb\u7edf", "rst_rtos/0_file_system/0_vfs_index_cn": "0.9 \u865a\u62df\u6587\u4ef6\u7cfb\u7edf", "rst_rtos/0_ftl": "0.a Flash \u8f6c\u6362\u5c42", "rst_rtos/0_ftl/0_ftl_index_cn": "0.a Flash \u8f6c\u6362\u5c42", "rst_rtos/0_gcc_build_environment": "0.1 GCC \u7f16\u8bd1\u73af\u5883", "rst_rtos/0_gcc_build_environment/0_gcc_build_index_cn": "0.1 GCC \u7f16\u8bd1\u73af\u5883", "rst_rtos/0_gdb_debug": "0.2 GDB \u8c03\u8bd5", "rst_rtos/0_gdb_debug/0_gdb_debug_index_cn": "0.2 GDB \u8c03\u8bd5", "rst_rtos/0_memory_layout": "0.5 Flash \u548c RAM \u5e03\u5c40", "rst_rtos/0_memory_layout/0_layout_index_cn": "0.5 Flash \u548c RAM \u5e03\u5c40", "rst_rtos/0_sdk_example": "0.4 SDK \u793a\u4f8b", "rst_rtos/0_sdk_example/0_sdk_example_index_cn": "0.4 SDK \u793a\u4f8b", "rst_rtos/0_tools": "0.7 \u5de5\u5177", "rst_rtos/0_tools/0_tools_index_cn": "0.7 \u5de5\u5177", "rst_rtos/0_user_config": "0.6 \u5f00\u53d1\u8005\u914d\u7f6e", "rst_rtos/0_user_config/0_usrcfg_index_cn": "0.6 \u5f00\u53d1\u8005\u914d\u7f6e", "rst_rtos/1_boot_process": "1.1 \u542f\u52a8\u8fc7\u7a0b", "rst_rtos/1_boot_process/0_boot_index_cn": "1.1 \u542f\u52a8\u8fc7\u7a0b", "rst_rtos/1_chipen": "1.4 \u82af\u7247\u4f7f\u80fd", "rst_rtos/1_chipen/0_chipen_index_cn": "1.4 \u82af\u7247\u4f7f\u80fd", "rst_rtos/1_gpio": "1.7 GPIO \u548c\u5f15\u811a\u63a7\u5236", "rst_rtos/1_gpio/0_gpio_index_cn": "1.7 GPIO \u548c\u5f15\u811a\u63a7\u5236", "rst_rtos/1_ipc": "1.5 \u6838\u95f4\u901a\u4fe1", "rst_rtos/1_ipc/0_ipc_index_cn": "1.5 \u6838\u95f4\u901a\u4fe1", "rst_rtos/1_mpu_cache": "1.0 \u5185\u5b58\u4fdd\u62a4\u5355\u5143\u548c\u7f13\u5b58", "rst_rtos/1_mpu_cache/0_mpu_cache_index_cn": "1.0 \u5185\u5b58\u4fdd\u62a4\u5355\u5143\u548c\u7f13\u5b58", "rst_rtos/1_ota": "1.2 \u56fa\u4ef6\u5347\u7ea7\uff08OTA\uff09", "rst_rtos/1_ota/0_ota_index_cn": "1.2 \u56fa\u4ef6\u5347\u7ea7\uff08OTA\uff09", "rst_rtos/1_otpc": "1.3 OTP\u5b58\u50a8\u5668", "rst_rtos/1_otpc/0_otpc_index_cn": "1.3 OTP\u5b58\u50a8\u5668", "rst_rtos/1_pinmux": "1.6 \u5f15\u811a\u590d\u7528", "rst_rtos/1_pinmux/0_pinmux_index_cn": "1.6 \u5f15\u811a\u590d\u7528", "rst_rtos/1_power_save": "1.9 \u4f4e\u529f\u8017\u5f00\u53d1", "rst_rtos/1_power_save/0_ps_index_cn": "1.9 \u4f4e\u529f\u8017\u5f00\u53d1", "rst_rtos/2_whc_fullmac": "2.1 WHC FullMAC", "rst_rtos/2_whc_fullmac/0_fullmac_index_cn": "2.1 WHC FullMAC", "rst_rtos/2_whc_wifi_bridge": "2.0 WHC Bridge", "rst_rtos/2_whc_wifi_bridge/0_wifi_bridge_index_cn": "2.0 WHC Bridge", "rst_rtos/2_wifi_adaptivity_test": "2.4 Wi-Fi Adaptivity \u6d4b\u8bd5\u6307\u5357", "rst_rtos/2_wifi_adaptivity_test/0_wifi_adaptivity_index_cn": "2.4 Wi-Fi Adaptivity \u6d4b\u8bd5\u6307\u5357", "rst_rtos/2_wifi_csi": "2.3 Wi-Fi CSI", "rst_rtos/2_wifi_csi/0_wifi_csi_index_cn": "2.3 Wi-Fi CSI", "rst_rtos/2_wifi_tunnel": "2.2 Wi-Fi R-Mesh", "rst_rtos/2_wifi_tunnel/0_wifi_tunnel_index_cn": "2.2 Wi-Fi R-Mesh", "rst_rtos/3_ap_trustzone": "3.d AP \u5b89\u5168\u670d\u52a1", "rst_rtos/3_ap_trustzone/0_ap_tz_index_cn": "3.d AP \u5b89\u5168\u670d\u52a1", "rst_rtos/3_crypto_engine": "3.9 \u5bf9\u79f0\u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_crypto_engine/0_crypto_engine_index_cn": "3.9 \u5bf9\u79f0\u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_ecdsa_engine": "3.a ECDSA \u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_ecdsa_engine/0_ecdsa_index_cn": "3.a ECDSA \u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_eddsa_engine": "3.b EDDSA \u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_eddsa_engine/0_eddsa_index_cn": "3.b EDDSA \u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_rsa_engine": "3.c RSA \u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_rsa_engine/0_rsa_index_cn": "3.c RSA \u786c\u4ef6\u52a0\u5bc6\u5f15\u64ce", "rst_rtos/3_security": "3.1 \u5b89\u5168\u4e0e\u52a0\u5bc6", "rst_rtos/3_security/0_security_index_cn": "3.1 \u5b89\u5168\u4e0e\u52a0\u5bc6", "rst_rtos/3_trng": "3.2 \u771f\u968f\u673a\u6570\u53d1\u751f\u5668", "rst_rtos/3_trng/0_trng_index_cn": "3.2 \u771f\u968f\u673a\u6570\u53d1\u751f\u5668", "rst_rtos/4_ai": "4.1 \u4eba\u5de5\u667a\u80fd", "rst_rtos/4_ai/0_ai_index_cn": "4.1 \u4eba\u5de5\u667a\u80fd", "rst_rtos/4_ai_voice": "4.2 \u8bed\u97f3\u8bc6\u522b", "rst_rtos/4_ai_voice/0_ai_voice_index_cn": "4.2 \u8bed\u97f3\u8bc6\u522b", "rst_rtos/4_dsp": "4.4 DSP \u4f7f\u7528\u6307\u5357", "rst_rtos/4_dsp/0_dsp_index_cn": "4.4 DSP \u4f7f\u7528\u6307\u5357", "rst_rtos/4_multimedia": "4.3 \u591a\u5a92\u4f53", "rst_rtos/4_multimedia/0_multimedia_index_cn": "4.3 \u591a\u5a92\u4f53", "rst_rtos/6_mass_production": "6.1 \u6279\u91cf\u751f\u4ea7", "rst_rtos/6_mass_production/0_mp_index_cn": "6.1 \u6279\u91cf\u751f\u4ea7", "rst_rtos/6_mptools": "6.2 \u4ea7\u6d4b\u5de5\u5177", "rst_rtos/6_mptools/0_mptools_index_cn": "6.2 \u4ea7\u6d4b\u5de5\u5177", "rst_rtos/7_usb": "7.1 USB \u4e3b\u673a\u4e0e\u8bbe\u5907", "rst_rtos/7_usb/0_usb_index_cn": "7.1 USB \u4e3b\u673a\u4e0e\u8bbe\u5907", "rst_rtos/8_adc": "8.4 \u6a21\u6570\u8f6c\u6362\u5668", "rst_rtos/8_adc/0_adc_index_cn": "8.4 \u6a21\u6570\u8f6c\u6362\u5668", "rst_rtos/8_cap_touch": "8.7 Cap-Touch", "rst_rtos/8_cap_touch/0_cap_touch_index_cn": "8.7 Cap-Touch", "rst_rtos/8_dmac": "8.1 DMA \u63a7\u5236\u5668", "rst_rtos/8_dmac/0_dmac_index_cn": "8.1 DMA \u63a7\u5236\u5668", "rst_rtos/8_ir": "8.5 \u7ea2\u5916\u6536\u53d1\u5668", "rst_rtos/8_ir/0_ir_index_cn": "8.5 \u7ea2\u5916\u6536\u53d1\u5668", "rst_rtos/8_key_scan": "8.8 Key-Scan", "rst_rtos/8_key_scan/0_key_scan_index_cn": "8.8 Key-Scan", "rst_rtos/8_lcdc": "8.a LCD \u63a7\u5236\u5668", "rst_rtos/8_lcdc/0_lcdc_index_cn": "8.a LCD \u63a7\u5236\u5668", "rst_rtos/8_ledc": "8.6 LED \u63a7\u5236\u5668", "rst_rtos/8_ledc/0_ledc_index_cn": "8.6 LED \u63a7\u5236\u5668", "rst_rtos/8_psram": "8.2 PSRAM", "rst_rtos/8_psram/0_psram_index_cn": "8.2 PSRAM", "rst_rtos/8_rtc_io": "8.9 RTC-IO", "rst_rtos/8_rtc_io/0_rtc_io_index_cn": "8.9 RTC-IO", "rst_rtos/8_thermal": "8.3 \u6e29\u5ea6\u6d4b\u91cf", "rst_rtos/8_thermal/0_thermal_index_cn": "8.3 \u6e29\u5ea6\u6d4b\u91cf"};
console.log("TOC_TITLE_MAP:", TOC_TITLE_MAP);

// 获取当前页面的文档名 (例如 'rst_rtos/3_nda_secure_boot/0_secure_boot_index_nda')
const CURRENT_DOCNAME = 'rst_rtos/1_otpc/1_otpc_toprst_cn';

// 动态查找顶级分类函数（定义为全局函数）
window.findTopLevelChapter = function(docname) {
    console.log("Attempting to find top-level chapter for:", docname);
    let bestMatch = "";
    let bestTitle = "Unknown Chapter";

    // 按路径长度降序排序以确保最长匹配
    const sortedPaths = Object.keys(TOC_TITLE_MAP).sort((a, b) => b.length - a.length);

    for (const path of sortedPaths) {
        console.log("Checking path:", path);
        if (docname === path || docname.startsWith(path + '/')) { // 子页面
            bestMatch = path;
            bestTitle = TOC_TITLE_MAP[path];
            console.log("Matched path:", path, "with title:", bestTitle);
            break;
        }
    }

    // 如果没有找到任何匹配项，则尝试更短的路径
    if (bestMatch === "") {
        const pathSegments = docname.split('/');
        while (pathSegments.length > 1) { // 至少保留根路径
            const candidate = pathSegments.join('/');
            console.log("Checking shorter path:", candidate);
            if (TOC_TITLE_MAP[candidate]) {
                bestTitle = TOC_TITLE_MAP[candidate];
                console.log("Matched shorter path:", candidate, "with title:", bestTitle);
                break;
            }
            pathSegments.pop();
        }
    }

    console.log("Final top-level chapter:", bestTitle);
    return bestTitle;
}

// 初始化时调用
document.addEventListener('DOMContentLoaded', function() {
    const topLevelChapter = findTopLevelChapter(CURRENT_DOCNAME);
    console.log("Top Level Chapter:", topLevelChapter);

    // 将顶级分类插入到DOM中（根据需要）
    const chapterElement = document.createElement('div');
    chapterElement.className = 'top-level-chapter';
    chapterElement.innerHTML = `<strong>Top Level Chapter: </strong>${topLevelChapter}`;
    document.body.appendChild(chapterElement);
});
</script>

    <style>
        /* ====================== 紧凑型选择器 ====================== */
        #topleft-panel {
            background: rgba(40, 58, 73, 0.9);
            border-radius: 8px;
            padding: 4px;
            margin: 4px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            backdrop-filter: blur(4px);
        }

        .selectors-grid {
            display: grid;
            gap: 4px;
        }

        .dual-selector-group {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 两列等宽 */
            gap: 4px; /* 列间距 */
        }

        .selector-group {
            position: relative;
        }

        .selector-label {
            display: block;
            color: #a0b3c6;
            font-size: 0.85em;
            margin-bottom: 4px;
            padding-left: 4px;
        }

        .selector-dropdown {
            width: 100%;
            padding: 4px 4px;
            border: 1px solid rgba(64, 82, 97, 0.8);
            border-radius: 6px;
            background: rgba(44, 62, 80, 0.9);
            color: #ecf0f1;
            font-size: 0.95em;
            transition: all 0.2s ease;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23a0b3c6'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
        }

        .selector-dropdown:hover {
            border-color: #4a6a8b;
            background-color: rgba(44, 62, 80, 1);
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .selector-dropdown:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        /* 移动端优化 */
        @media (max-width: 768px) {
            #topleft-panel {
                margin: 8px 0;
                padding: 10px;
            }

            .selectors-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .selector-dropdown {
                padding: 10px 12px;
            }

            .dual-selector-group {
                grid-template-columns: 1fr; /* 小屏幕下堆叠显示 */
            }
        }
    </style>

    
        

<style>
    /* ================= 用户面板 ================= */
    .user-panel {
        /* background: rgba(255,255,255,0.1); */
        background: rgba(255, 255, 255, 0.05); /* 更暗的背景 */
        border-radius: 4px;
        padding: 4px 4px; /* 上下间距减少 */
        margin: 4px 0px; /* 左右各10px边距 */
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);

        width: calc(100% - 4px); /* 宽度占满父容器减去20px（左右边距总和） */
        max-width: 280px; /* 设置最大宽度，防止过宽 */
        box-sizing: border-box; /* 确保padding和border不影响总宽度 */
    }

    #user-info {
        display: flex;
        gap: 4px;
        align-items: center;
        padding: 4px 0;
        width: 100%;
    }

    .username-btn, .logout-btn, .link-btn, .auth-btn {
        flex: 1; /* 均分剩余空间 */
        margin: 3px 0;           /* 减少外链按钮间距 */
        padding: 4px 6px;       /* 减少内边距 */
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 6px;
        color: white;
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
    }

    .username-btn:hover {
        background: #92b5bb;
    }

    #username-display {
        font-size: 0.95em;
        color: #ecf0f1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        text-align: left;
    }

    .logout-btn:hover {
        background: #c0392b;
    }

    /* ================= 按钮容器 ================= */
    .button-row {
        display: flex;
        gap: 4px;
        width: 100%;
        margin: 4px 0;
    }

    .auth-btn:hover {
        background: #2980b9;
        transform: translateY(-1px);
    }

    /* 外链按钮 */
    .external-links {
        display: flex;       /* 新增Flex布局 */
        gap: 4px;           /* 按钮间距 */
        width: 100%;        /* 确保容器宽度填满父级 */
    }

    .link-btn:hover {
        background: rgba(255,255,255,0.1);
        transform: translateY(-1px);
    }

    .btn-text {
        font-size: 0.95em;
    }

    .panel-divider {
        height: 1px;
        background: rgba(255,255,255,0.1);
        margin: 6px 0;          /* 减少分隔线间距 */
    }

    /* 桌面端悬停效果 */
    @media (hover: hover) {
        .username-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(255,255,255,0.15);
        }

        .logout-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(231, 76, 60, 0.3);
        }
    }

    /* 响应式调整 */
    @media (max-width: 768px) {
        .user-panel {
            padding: 4px 6px;
        }

        .auth-btn {
            padding: 4px 68px;
            font-size: 0.9em;
        }

        .external-links {
            flex-direction: column; /* 移动端垂直排列 */
            gap: 6px;              /* 调整间距 */
        }
        .link-btn {
            width: 100%;          /* 移动端填满宽度 */
            flex: none;           /* 禁用flex缩放 */
        }

        .btn-text {
            font-size: 0.9em;
        }

        #user-info {
            flex-direction: row; /* 保持行排列 */
            gap: 6px;
        }

        .username-btn {
            flex: 1 1 60%;
            padding: 6px 8px;
        }

        .logout-btn {
            flex: 1 1 40%;
            text-align: center;
        }
    }
</style>

<style>
    .auth-dialog {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        backdrop-filter: blur(3px);
    }

    .auth-content {
        background: #ffffff;
        padding: 2rem;
        border-radius: 12px;
        min-width: 380px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        transform: translateY(-20px);
        opacity: 0;
        animation: dialogEnter 0.3s ease forwards;
    }

    @keyframes dialogEnter {
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    .auth-title {
        color: #2c3e50;
        font-size: 1.5rem;
        margin: 0 0 1.5rem;
        font-weight: 600;
        text-align: center;
    }

    .auth-input-group {
        margin-bottom: 1.2rem;
    }

    .auth-label {
        display: block;
        color: #7f8c8d;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
    }

    .auth-input {
        width: 100%;
        padding: 0.8rem;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    .auth-input:focus {
        border-color: #3498db;
        box-shadow: 0 0 0 3px rgba(52,152,219,0.1);
        outline: none;
    }

    .auth-button-group {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
    }

    .auth-button {
        flex: 1;
        padding: 0.8rem 1.2rem;
        border: none;
        border-radius: 8px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .auth-button.confirm {
        background: #3498db;
        color: white;
    }

    .auth-button.confirm:hover {
        background: #2980b9;
        transform: translateY(-1px);
    }

    .auth-button.cancel {
        background: #f1f2f6;
        color: #2c3e50;
    }

    .auth-button.cancel:hover {
        background: #dfe4ea;
    }

    @media (max-width: 480px) {
        .auth-content {
            min-width: 90%;
            padding: 1.2rem;
        }

        .auth-input-group {
            margin-bottom: 0.8rem;
        }

        .auth-input {
            padding: 0.7rem;
            font-size: 0.9rem;
        }
    }
</style>
        <!-- source/_templates/_layout_issue_report.html -->
<div id="prompt-box" style="
    display: none;
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    z-index: 9999;
    text-align: center;
    font-size: 14px;
"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    'use strict'; // 添加严格模式

    // 获取所有DOM元素引用
    const reportButton = document.getElementById('report-button');
    const feedbackDialog = document.getElementById('feedback-dialog');
    const feedbackText = document.getElementById('inquire_input');
    const submitButton = document.getElementById('submit-feedback');
    const cancelButton = document.getElementById('cancel-feedback');
    const promptBox = document.getElementById('prompt-box');
    const chapterSelect = document.getElementById('chapter-select');
    const paragraphInput = document.getElementById('paragraph-input');
    const postTypeSelect = document.getElementById('post-type');
    console.log('帖子类型(postTypeSelect)DOM元素:', postTypeSelect); // 应输出<select>元素

    // 状态变量
    let hasUserInput = false; // 跟踪用户是否主动输入
    let selectedText = '';
    const language = 'zh-CN'; // 从模板引擎获取语言变量

    // 初始化时设置placeholder
    paragraphInput.placeholder = language === 'zh_CN' 
        ? '你可以先选择有问题的段落或手动输入...'
        : 'You can select text or type directly here...';

    // 获取当前激活的章节
    function getCurrentChapter() {
        try {
            // 通过激活的菜单项获取当前章节
            const currentLink = document.querySelector('.wy-menu .toctree-l1.current > a');
            if (currentLink) {
                return currentLink.textContent.replace('¶', '').trim();
            }

            // 如果没有找到激活的链接，尝试通过页面标题获取
            const pageTitle = document.querySelector('h1');
            if (pageTitle) {
                return pageTitle.textContent.split('\n')[0].trim();
            }

            // 如果以上方法都失败，尝试通过URL路径推断章节
            const pathParts = window.location.pathname.split('/');
            if (pathParts.length > 2) {
                return decodeURIComponent(pathParts[pathParts.length - 2]);
            }

            return null;
        } catch (error) {
            console.error('获取当前章节失败:', error);
            return null;
        }
    }

    // 填充章节选择框
    function populateChapters() {
        const chapterElements = document.querySelectorAll('.wy-menu .toctree-l1 > a');
        const chapters = Array.from(chapterElements).map(el => el.textContent.replace('¶', '').trim());
        const currentChapter = getCurrentChapter();

        console.log('提取全部章节:', chapters);
        console.log('当前页面章节:', currentChapter);

        if (chapters.length === 0) {
            console.error('未找到章节链接');
            return;
        }

        chapterSelect.innerHTML = '';

        // 添加默认选项
        const defaultOption = document.createElement('option');
        defaultOption.value = '';
        defaultOption.textContent = language === 'zh_CN' ? '-- 请选择章节 --' : '-- Select Chapter --';
        chapterSelect.appendChild(defaultOption);

        // 添加章节选项
        chapters.forEach(chapter => {
            const option = document.createElement('option');
            option.value = chapter;
            option.textContent = chapter;
            if (chapter === currentChapter) {
                option.selected = true;
            }
            chapterSelect.appendChild(option);
        });
    }

    // 初始化章节选择框
    populateChapters();

    // 报告按钮点击事件（处理文本选择）
    reportButton.addEventListener('click', function() {
        // 重置所有输入字段，每次重新inquire应该让对话框处于默认状态
        feedbackText.value = '';          // 清空问题输入框
        paragraphInput.value = '';        // 清空段落输入框
        selectedText = '';                // 清除之前选择的文本

        const selection = window.getSelection().toString().trim();
        if (selection) {
            paragraphInput.value = selection;
        } else {
            // 保持placeholder提示
            if (!paragraphInput.value.trim()) {
                paragraphInput.value = '';
            }
        }
        feedbackDialog.style.display = 'block';
    });

    // 监听输入事件
    paragraphInput.addEventListener('input', function() {
        // 标记用户已经输入
        this.placeholder = '';
    });

    // 提交按钮点击事件
    submitButton.addEventListener('click', function() {
        const userQuestion = feedbackText.value.trim();
        const selectedChapter = chapterSelect.value;
        const selectedPostType = postTypeSelect.value;
        const paragraphContent = paragraphInput.value.trim() || 'null';

        // 在提交事件顶部添加详细日志
        console.group('=== 提交调试信息 ===');
        console.log('章节选择值:', chapterSelect.value);
        console.log('帖子类型postTypeSelect DOM元素:', postTypeSelect);
        console.log('帖子类型postTypeSelect 选中的选项:', postTypeSelect.options[postTypeSelect.selectedIndex]);
        console.log('帖子类型postTypeSelect 实际值:', postTypeSelect.value); // 应输出'doc_correction' 对应文档纠错
          console.groupEnd();

        // 验证输入
        if (!userQuestion) {
            alert(language === 'zh_CN' ? '问题描述为空' : 'Issue description cannot be empty');
            return;
        }
        if (!selectedChapter) {
            alert(language === 'zh_CN' ? '请选择相关章节' : 'Please select a related chapter');
            return;
        }

        if (!selectedPostType) {
            alert(language === 'zh_CN' ? '请选择帖子类型' : 'Please select a post type');
            return;
        }

        // 获取用户名
        const username = localStorage.getItem('username') || 'Anonymous';

        // 构建提交数据
        const feedbackData = {
            user: username,
            chapters: selectedChapter,
            post_type: selectedPostType,
            paragraph: paragraphContent,
            question: userQuestion
        };

        console.log('完整提交数据:', feedbackData);

        // 发送到后端
        fetch('http://172.29.57.206:5000/submit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(feedbackData)
        })
        .then(response => {
            if (!response.ok) throw new Error('Network response was not ok');
            return response.json();
        })
        .then(data => {
            console.log('提交成功:', data);
            promptBox.textContent = language === 'zh_CN' ? '问题已成功提交' : 'Issue submitted successfully';
            promptBox.style.display = 'block';
            setTimeout(() => promptBox.style.display = 'none', 5000);
        })
        .catch(error => {
            console.error('提交失败:', error);
            promptBox.textContent = language === 'zh_CN' ? '提交失败，请检查网络连接' : 'Submission failed, check your network';
            promptBox.style.display = 'block';
            setTimeout(() => promptBox.style.display = 'none', 5000);
        });

        // 关闭对话框
        feedbackDialog.style.display = 'none';
    });


    // 取消按钮点击事件
    cancelButton.addEventListener('click', function() {
        feedbackDialog.style.display = 'none';
    });

    // 初始化检查
    console.log('问题反馈系统已加载');
    console.log('当前语言:', language);
    console.log('检测到章节数量:', chapterSelect.options.length - 1);
});
</script> <!-- 问题回报 -->
    

    <style>
        /* 隐藏整个搜索栏容器 */
        .wy-side-nav-search > div[role="search"] {
            display: none !important;
        }

        /* 或者更精确地隐藏表单 */
        form#rtd-search-form {
            display: none !important;
        }
    </style>

    <style>
        .extension-container {
            position: fixed;
            left: 10px;
            bottom: 10px;
            z-index: 1000;
        }

        .extension-button {
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .extension-button:hover {
            background-color: #2980b9;
        }
    </style>

    <style>
        /* 保留bottomleft-panel作为用户面板容器 */
        .bottomleft-panel {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 300px;
            height: auto;
            background: #2d2d2d;
            border-top: 1px solid #404040;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.2);
            z-index: 1001;
        }

        /* 新增userpanel-container的flex定义 */
        .userpanel-container {
            padding: 10px;
            width: 100%;
        }
        /* 增加字体配置 */
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined' !important;
            font-weight: 400 !important;
            font-style: normal !important;
            line-height: 1 !important;
            letter-spacing: normal !important;
            text-transform: none !important;
        }

        /* 调整父容器定位方式 */
        .userpanel-container {
            position: relative; /* 新增定位上下文 */
        }
    </style>

    <!-- 左上角标题距离控制：Ameba IoT Docs -->
    <style>
        /* 隐藏整个搜索栏容器 */
        .wy-side-nav-search > div[role="search"] {
            display: none !important;
        }

        /* 新增的标题间距调整样式（添加在此处） */
        div[role="navigation"] > div[role="search"] {
            margin-bottom: 4px !important;
        }

        a.icon.icon-home {
            display: inline-block;
            margin-bottom: 2px !important;
        }
    </style>

    <!-- 引入功能模块 -->
    
        
<script>
    // 初始化认证对话框
    window.initAuthDialogs = function() {
        function createAuthDialog(type) {
            const lang = document.getElementById('language-selector').value === 'cn' ? 'cn' : 'en';

            // 对话框容器
            const dialog = document.createElement('div');
            dialog.className = 'auth-dialog';  // 使用CSS类替代内联样式

            // 内容容器
            const content = document.createElement('div');
            content.className = 'auth-content';

            // 标题
            const title = document.createElement('h3');
            title.className = 'auth-title';
            title.textContent = type === 'register' 
                ? (lang === 'cn' ? '注册' : 'Register') 
                : (lang === 'cn' ? '登录' : 'Login');

            // 输入字段创建函数
            const createInput = (labelText, inputType) => {
                const container = document.createElement('div');
                container.className = 'auth-input-group';

                const label = document.createElement('label');
                label.textContent = labelText;

                const input = document.createElement('input');
                input.type = inputType;
                input.className = 'auth-input';

                container.appendChild(label);
                container.appendChild(input);
                return { container, input };
            };

            // 用户名输入
            const username = createInput(
                lang === 'cn' ? '用户名：' : 'Username:', 
                'text'
            );
            content.appendChild(username.container);

            // 密码输入
            const password = createInput(
                lang === 'cn' ? '密码：' : 'Password:', 
                'password'
            );
            content.appendChild(password.container);

            // Enter键支持
            const handleKeyPress = (e) => {
                if (e.key === 'Enter') confirmBtn.click();
            };

            // 确认密码（仅注册）
            let confirmPassword;
            let companyInput, productInput, emailInput;
            if (type === 'register') {
                confirmPassword = createInput(
                    lang === 'cn' ? '确认密码：' : 'Confirm Password:', 
                    'password'
                );
                content.appendChild(confirmPassword.container);

                // 工作单位
                const company = createInput(
                    lang === 'cn' ? '工作单位：' : 'Company:', 
                    'text'
                );
                content.appendChild(company.container);
                companyInput = company.input;

                // 产品信息 
                const product = createInput(
                    lang === 'cn' ? '产品信息：' : 'Product:', 
                    'text'
                );
                content.appendChild(product.container);
                productInput = product.input;

                // 工作邮箱
                const email = createInput(
                    lang === 'cn' ? '工作邮箱：' : 'Email:', 
                    'email'
                );
                email.input.autocomplete = 'email'; // ➕ 添加自动完成类型

                content.appendChild(email.container);
                emailInput = email.input;

                // 添加Enter键支持到新字段
                [companyInput, productInput, emailInput].forEach(input => {
                    input.addEventListener('keypress', handleKeyPress);
                });
            }

            // 按钮容器
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'auth-button-group';

            // 确认按钮
            const confirmBtn = document.createElement('button');
            confirmBtn.className = 'auth-confirm-btn';
            confirmBtn.textContent = lang === 'cn' ? '确认' : 'Confirm';

            username.input.addEventListener('keypress', handleKeyPress);
            password.input.addEventListener('keypress', handleKeyPress);
            if (confirmPassword) confirmPassword.input.addEventListener('keypress', handleKeyPress);

            // 确认按钮逻辑
            confirmBtn.onclick = () => {
                const usernameVal = username.input.value.trim();
                const passwordVal = password.input.value.trim();
                const companyVal = companyInput?.value.trim() || '';
                const productVal = productInput?.value.trim() || '';
                const emailVal = emailInput?.value.trim() || '';
                const confirmVal = confirmPassword ? confirmPassword.input.value.trim() : null;

                // 基础邮箱格式验证
                if (type === 'register' && emailVal) {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(emailVal)) {
                        alert(lang === 'cn' 
                            ? '请输入有效邮箱地址' 
                            : 'Please enter a valid email address');
                        return;
                    }
                }

                // 验证逻辑
                if (!usernameVal || !passwordVal) {
                    alert(lang === 'cn' ? '用户名和密码不能为空！' : 'Username and password are required!');
                    return;
                }

                if (type === 'register' && passwordVal !== confirmVal) {
                    alert(lang === 'cn' ? '两次输入的密码不一致！' : 'Passwords do not match!');
                    return;
                }

                // fetch请求
                fetch('http://172.29.57.206:5000/auth', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': window.getCSRFToken()
                    },
                    body: JSON.stringify({
                        action: type, 
                        username: usernameVal, 
                        password: passwordVal,
                        company: companyVal,
                        product: productVal,
                        email: emailVal
                    }),
                    credentials: 'include'
                })
                .then(response => {
                    console.log('[DEBUG] 完整响应头:', [...response.headers.entries()]);
                    console.log('Access-Control-Allow-Origin:', response.headers.get('Access-Control-Allow-Origin'));
                    console.log('Access-Control-Allow-Credentials:', response.headers.get('Access-Control-Allow-Credentials'));
                    console.log('登录响应 Cookies:', response.headers.get('Set-Cookie'));
                    return response.json();
                })
                .then(async (data) => {
                    // 成功处理逻辑
                    if (data.success) {
                        console.log('initAuthDialogs 登录成功，当前 Cookies:', document.cookie);
                        console.log('initAuthDialogs CSRF Token:', window.getCSRFToken());

                        localStorage.setItem('auth_session', JSON.stringify({
                            username: data.username, 
                            expires: Date.now() + 3600000
                        }));

                        localStorage.setItem('isLoggedIn', 'true');
                        localStorage.setItem('username', usernameVal);
                        
                        document.getElementById('auth-buttons').style.display = 'none';
                        document.getElementById('user-info').style.display = 'flex';
                        document.getElementById('username-display').textContent = localStorage.getItem('username') || '';
                        document.body.removeChild(dialog);

                        Swal.fire({
                            icon: 'success',
                            title: lang === 'cn' ? '登录成功' : 'Logged In',
                            showConfirmButton: false,
                            timer: 500
                        });
                    } else {
                        document.body.removeChild(dialog);
                        window.syncLoginState();
                        Swal.fire({
                            icon: 'fail',
                            title: lang === 'cn' ? '登录失败' : 'Logged In Fail',
                            showConfirmButton: false,
                            timer: 500
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert(lang === 'cn' ? '网络错误' : 'Network error');
                });
            };

            // 取消按钮
            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'auth-cancel-btn';
            cancelBtn.textContent = lang === 'cn' ? '取消' : 'Cancel';
            cancelBtn.onclick = () => document.body.removeChild(dialog);

            // 组装元素
            buttonContainer.appendChild(confirmBtn);
            buttonContainer.appendChild(cancelBtn);
            content.appendChild(buttonContainer);
            dialog.appendChild(content);
            document.body.appendChild(dialog);

            // 点击外部关闭
            dialog.addEventListener('click', (e) => {
                if (e.target === dialog) document.body.removeChild(dialog);
            });
        }

        // 事件绑定
        document.getElementById('register-button').addEventListener('click', () => createAuthDialog('register'));
        document.getElementById('login-button').addEventListener('click', () => createAuthDialog('login'));
    }

    // 注销功能
    async function handleLogout() {
        try {
            const lang = (window.location.pathname.includes('/zh_CN') || 
                        document.documentElement.lang === 'zh_CN') ? 'cn' : 'en';

            // 更新本地存储和UI
            //localStorage.removeItem('isLoggedIn');
            localStorage.setItem('isLoggedIn', 'false');
            localStorage.removeItem('username');

            // 强制刷新显示状态
            document.getElementById('auth-buttons').style.display = 'flex';
            document.getElementById('user-info').style.display = 'none';
            document.getElementById('username-display').textContent = localStorage.getItem('username') || '';

            const response = await fetch('http://172.29.57.206:5000/logout', {
                method: 'GET',
                headers: {
                    'X-CSRFToken': window.getCSRFToken(),
                    'Content-Type': 'application/json'
                },
                credentials: 'include'
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            await Swal.fire({
                icon: 'success',
                title: lang === 'cn' ? '登出成功' : 'Logged Out',
                timer: 1500
            });
        } catch (error) {
            console.error('登出流程异常:', error);
            Swal.fire({
                icon: 'error',
                title: lang === 'cn' ? '登出异常' : 'Logout Failed',
                text: lang === 'cn' ? '请尝试清除浏览器缓存' : 'Please clear browser cache'
            });
        }
    }

    // 同步登录状态
    window.syncLoginState = function() {
        const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
        document.getElementById('auth-buttons').style.display = isLoggedIn ? 'none' : 'flex';
        document.getElementById('user-info').style.display = isLoggedIn ? 'flex' : 'none';
        if (isLoggedIn) {
            document.getElementById('username-display').textContent = localStorage.getItem('username') || '';
        } else {

        }
    }

</script>
    
    
<script>
    /* ====================== 嵌入式配置开始 ====================== */
    const embeddedConfig = {
        "freertos": {
            "name": "FreeRTOS",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        },
        "linux": {
            "name": "Linux",
            "languages": {
                "en": ["latest"],
                "cn": ["latest"]
            }
        }
    };
    /* ====================== 嵌入式配置结束 ====================== */
</script>
    
<script>
    // 获取基础URL路径
    function getBaseURL() {
        const url = new URL(window.location.href);
        console.log('[DEBUG] getBaseURL:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const pathParts = url.pathname.split('/').filter(part => part !== '');
            const index = pathParts.indexOf('build');
            console.log('[DEBUG] getBaseURL0:', pathParts.slice(0, index + 1).join('/'));
            return `file://${pathParts.slice(0, index + 1).join('/')}/`;
        } else {
            // 网络路径处理
            const basePath = url.pathname.split('/')[1]; // 直接取第一个有效路径段
            console.log('[DEBUG] getBaseURL:', url.origin, basePath);
            return `${url.origin}/${basePath}/`;
        }
    }

    // 获取当前URL路径分段
    function getCurrentSegments() {
        const url = new URL(window.location.href);
        let segments = url.pathname.split('/').filter(segment => segment);

        console.log('[DEBUG] getCurrentSegments:');

        if (url.protocol === 'file:') {
            // 本地路径处理
            const index = segments.indexOf('build');
            segments = segments.slice(index + 1); // 去掉 build 及之前的路径
            console.log('[DEBUG] getCurrentSegments0:', segments);
        } else {
            // 网络路径处理
            segments = segments.slice(3); // 去掉 ameba-iot-docs/
            console.log('[DEBUG] getCurrentSegments:', segments);
        }

        return {
            osKey: segments[0] || 'freertos', // 默认为 freertos
            language: segments[1] || 'en',   // 默认为 en
            version: segments[2] || 'latest' // 默认为 latest
        };
    }
</script>
    
<script>
    // 获取OS显示名称列表
    function getOSNames(data) {
        return Object.keys(data).map(key => data[key].name);
    }

    // 获取指定OS的语言列表
    function getLanguages(data, osKey) {
        return Object.keys(data[osKey]?.languages || {});
    }

    // 获取指定OS和语言的版本列表
    function getVersions(data, osKey, language) {
        return data[osKey]?.languages?.[language] || ['latest'];
    }

    // 根据显示名称查找OS键
    function findOSKey(data, displayName) {
        return Object.keys(data).find(key => data[key].name === displayName);
    }
</script>
    
<script>
    // 验证并修正路径参数
    function validateSegments(segments) {
        const currentOSName = embeddedConfig[segments.osKey]?.name;

        // 如果 OS 无效，默认设置为 FreeRTOS
        if (!currentOSName) {
            console.warn("Invalid OS key, defaulting to FreeRTOS");
            segments.osKey = 'freertos';
        }

        // 如果语言无效，默认设置为 en
        if (!getLanguages(embeddedConfig, segments.osKey).includes(segments.language)) {
            console.warn("Invalid language, defaulting to en");
            segments.language = 'en';
        }

        return segments;
    }

    // 生成选择器HTML
    function generateSelectorsHTML(segments) {
        return `
        <div class="selectors-grid">
            <!-- 系统选择器 -->
            <div class="selector-group">
                <select id="os-selector" class="selector-dropdown">
                    ${Object.keys(embeddedConfig).map(key => `
                        <option value="${key}">${embeddedConfig[key].name}</option>
                    `).join('')}
                </select>
            </div>

            <!-- 语言和版本组合（修正类名） -->
            <div class="dual-selector-group"> <!-- 修改此处 -->
                <div class="selector-group">
                    <select id="language-selector" class="selector-dropdown">
                        ${getLanguages(embeddedConfig, segments.osKey).map(lang => `
                            <option value="${lang}">${lang}</option>
                        `).join('')}
                    </select>
                </div>

                <div class="selector-group">
                    <select id="version-selector" class="selector-dropdown">
                        ${getVersions(embeddedConfig, segments.osKey, segments.language).map(ver => `
                            <option value="${ver}">${ver}</option>
                        `).join('')}
                    </select>
                </div>
            </div>
        </div>
        ${generateUserPanelHTML(segments)}`;
    }

    // 生成用户面板HTML
    function generateUserPanelHTML(segments) {
        return `
            <div class="user-panel">
                <!-- 用户名显示（登录后可见） -->
                <div id="user-info" style="display: ${localStorage.getItem('isLoggedIn') ? 'flex' : 'none'}">
                    <button class="username-btn")">
                        <span class="btn-icon">👤</span>
                        <span id="username-display">${localStorage.getItem('username') || ''}</span>
                    </button>
                    <button class="logout-btn" onclick="handleLogout()")">
                        <span class="btn-icon">🚪</span>
                        <span id="btn-text">${segments.language === 'cn' ? '注销' : 'Logout'}</span>
                    </button>
                </div>

                <!-- 登录注册按钮（未登录时可见） -->
                <div id="auth-buttons" class="button-row" style="display: ${localStorage.getItem('isLoggedIn') ? 'none' : 'flex'}">
                    <button class="auth-btn" id="login-button">
                        <span class="btn-icon">🔓</span> <!-- 登录图标 -->
                        ${segments.language === 'cn' ? '登录' : 'Login'}
                    </button>
                    <button class="auth-btn" id="register-button">
                        <span class="btn-icon">✍️</span> <!-- 注册图标 -->
                        ${segments.language === 'cn' ? '注册' : 'Register'}
                    </button>
                </div>

                <!-- 分隔线 -->
                <div class="panel-divider"></div>

                <!-- 外链按钮 -->
                <div class="external-links">
                    <button class="link-btn official" onclick="window.open('https://www.realmcu.com/', '_blank')">
                        <span class="btn-icon">🌐</span>
                        <span class="btn-text">${segments.language === 'cn' ? '官网' : 'Official'}</span>
                    </button>
                    <button class="link-btn forum" onclick="window.open('http://172.29.57.206:5000/view', '_blank')">
                        <span class="btn-icon">💬</span>
                        <span class="btn-text">${segments.language === 'cn' ? '论坛' : 'Forum'}</span>
                    </button>
                </div>
            </div>
        `;
    }

    // 设置初始选中值
    function setInitialValues(segments) {
        document.getElementById('os-selector').value = segments.osKey;
        document.getElementById('language-selector').value = segments.language;

        const versionSelector = document.getElementById('version-selector');
        const availableVersions = getVersions(embeddedConfig, segments.osKey, segments.language);
        versionSelector.value = availableVersions.includes(segments.version) ? segments.version : availableVersions[0] || 'latest';
    }
</script>
    
<script>
    // 绑定事件监听
    function bindEvents(baseURL, segments) {
        document.getElementById('os-selector').addEventListener('change', () => {
            const newOSKey = document.getElementById('os-selector').value;
            const availableLangs = getLanguages(embeddedConfig, newOSKey);
            const defaultLang = availableLangs[0] || 'en';
            const defaultVersion = getVersions(embeddedConfig, newOSKey, defaultLang)[0] || 'latest';
            redirectTo(`${baseURL}${newOSKey}/${defaultLang}/${defaultVersion}/`);
        });

        document.getElementById('language-selector').addEventListener('change', () => {
            const newLang = document.getElementById('language-selector').value;
            const defaultVersion = getVersions(embeddedConfig, segments.osKey, newLang)[0] || 'latest';
            redirectTo(`${baseURL}${segments.osKey}/${newLang}/${defaultVersion}/`);
        });

        document.getElementById('version-selector').addEventListener('change', () => {
            const newVer = document.getElementById('version-selector').value;
            redirectTo(`${baseURL}${segments.osKey}/${segments.language}/${newVer}/`);
        });
    }

    // 跳转函数
    function redirectTo(path) {
        const url = new URL(path, window.location.href);
        if (url.protocol === 'file:') {
            url.pathname += 'index.html';
        }
        window.location.href = url.href;
    }
</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

    
    <div id="topleft-panel" style="display: block !important; padding: 0; background: none; border: none;"></div>

    
        
        <div class="bottomleft-panel">
            <div class="userpanel-container"></div>
        </div>
    

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const segments = validateSegments(getCurrentSegments());
                const baseURL = getBaseURL();

                // 渲染HTML
                document.getElementById('topleft-panel').innerHTML = generateSelectorsHTML(segments);

                // 设置初始值
                setInitialValues(segments);

                // 绑定事件
                bindEvents(baseURL, segments);

                // 初始化认证逻辑
                
                    window.initAuthDialogs();
                    window.syncLoginState();

                    // 将 user-panel 移动到 bottomleft-panel 内
                    const userPanel = document.querySelector('.user-panel');
                    const settingsContainer = document.querySelector('.userpanel-container');
                    if (userPanel && settingsContainer) {
                        settingsContainer.appendChild(userPanel); // 直接添加为子元素
                    }
                
            } catch (error) {
                console.error("Error initializing selectors:", error);
            }
        });
    </script>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_product/0_ameba_product_center_index_cn.html">产品中心</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_sdk/0_ameba_sdks_index_cn.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ameba_solutions/0_ameba_solutions_index_cn.html">解决方案</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index_cn.html">0.1 GCC 编译环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gdb_debug/0_gdb_debug_index_cn.html">0.2 GDB 调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_build_system/0_build_system_index_cn.html">0.3 构建系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_example/0_sdk_example_index_cn.html">0.4 SDK 示例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_memory_layout/0_layout_index_cn.html">0.5 Flash 和 RAM 布局</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_user_config/0_usrcfg_index_cn.html">0.6 开发者配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_tools/0_tools_index_cn.html">0.7 工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_at_command/0_at_command_index_cn.html">0.8 AT 命令集</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_file_system/0_vfs_index_cn.html">0.9 虚拟文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_ftl/0_ftl_index_cn.html">0.a Flash 转换层</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_mpu_cache/0_mpu_cache_index_cn.html">1.0 内存保护单元和缓存</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index_cn.html">1.1 启动过程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index_cn.html">1.2 固件升级（OTA）</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_otpc_index_cn.html">1.3 OTP存储器</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="#otp-api">OTP API 参考</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#otp-read8">OTP_Read8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#otp-write8">OTP_Write8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#otp-logicalmap-read">OTP_LogicalMap_Read</a></li>
<li class="toctree-l3"><a class="reference internal" href="#otp-logicalmap-write">OTP_LogicalMap_Write</a></li>
<li class="toctree-l3"><a class="reference internal" href="#otp-remainlength">OTP_RemainLength</a></li>
<li class="toctree-l3"><a class="reference internal" href="#otpgetcrc">OTPGetCRC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#otp">OTP 编程命令</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#otpc-logical-zone">逻辑区域</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">物理区域</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id4">使用方法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">逻辑区域</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">系统数据</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wi-fi">Wi-Fi 校准数据</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">编程场景</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">安全区域</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">密钥区域</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">配置区域</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id13">隐藏物理区域</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../1_chipen/0_chipen_index_cn.html">1.4 芯片使能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ipc/0_ipc_index_cn.html">1.5 核间通信</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_pinmux/0_pinmux_index_cn.html">1.6 引脚复用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index_cn.html">1.7 GPIO 和引脚控制</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index_cn.html">1.9 低功耗开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_wifi_bridge/0_wifi_bridge_index_cn.html">2.0 WHC Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_whc_fullmac/0_fullmac_index_cn.html">2.1 WHC FullMAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_tunnel/0_wifi_tunnel_index_cn.html">2.2 Wi-Fi R-Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_csi/0_wifi_csi_index_cn.html">2.3 Wi-Fi CSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_wifi_adaptivity_test/0_wifi_adaptivity_index_cn.html">2.4 Wi-Fi Adaptivity 测试指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_security/0_security_index_cn.html">3.1 安全与加密</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_trng/0_trng_index_cn.html">3.2 真随机数发生器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_crypto_engine/0_crypto_engine_index_cn.html">3.9 对称硬件加密引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ecdsa_engine/0_ecdsa_index_cn.html">3.a ECDSA 硬件加密引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_eddsa_engine/0_eddsa_index_cn.html">3.b EDDSA 硬件加密引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_rsa_engine/0_rsa_index_cn.html">3.c RSA 硬件加密引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_ap_trustzone/0_ap_tz_index_cn.html">3.d AP 安全服务</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai/0_ai_index_cn.html">4.1 人工智能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ai_voice/0_ai_voice_index_cn.html">4.2 语音识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index_cn.html">4.3 多媒体</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_dsp/0_dsp_index_cn.html">4.4 DSP 使用指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mass_production/0_mp_index_cn.html">6.1 批量生产</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_mptools/0_mptools_index_cn.html">6.2 产测工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index_cn.html">7.1 USB 主机与设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index_cn.html">8.1 DMA 控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_psram/0_psram_index_cn.html">8.2 PSRAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index_cn.html">8.3 温度测量</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index_cn.html">8.4 模数转换器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index_cn.html">8.5 红外收发器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ledc/0_ledc_index_cn.html">8.6 LED 控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_cap_touch/0_cap_touch_index_cn.html">8.7 Cap-Touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_key_scan/0_key_scan_index_cn.html">8.8 Key-Scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc_io/0_rtc_io_index_cn.html">8.9 RTC-IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index_cn.html">8.a LCD 控制器</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">
    
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_otpc_index_cn.html">OTP 存储器</a></li>
      <li class="breadcrumb-item active">概述</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="otpc"></span><!-- 下拉菜单 -->
<div style="margin: 20px 0; text-align: left;">
    <div style="display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 14px;">IC: </span>
        <select class="tab-selector" style="height: 22px; padding: 2px 8px; font-size: 13px;">
            <option value="RTL8721Dx">RTL8721Dx</option>
            <option value="RTL8720E">RTL8720E</option>
            <option value="RTL8726E">RTL8726E</option>
            <option value="RTL8730E">RTL8730E</option>
        </select>
    </div>
</div>

<!-- 修复后的 JavaScript -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const selector = document.querySelector('.tab-selector');

    selector.addEventListener('change', function() {
        const targetTab = this.value;
        const tabs = document.querySelectorAll('.sphinx-tabs-tab');
        let found = false;

        tabs.forEach(tab => {
            const tabText = tab.textContent.trim();
            if (tabText === targetTab) {
                tab.click();
                window.dispatchEvent(new Event('resize')); // 触发插件更新
                found = true;
            }
        });

        if (!found) {
            console.error("未找到选项卡:", targetTab);
        }
    });
});
</script><section id="id1">
<h1>概述<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<p>反熔丝一次性可编程存储器（One-Time Programmable, OTP） 是安全性最高的嵌入式非易失性存储器（eNVM）。其默认值为 <strong>1</strong>，且仅支持从 <strong>1</strong> 改写为 <strong>0</strong>。</p>
<figure class="align-center" id="id14">
<a class="reference internal image-reference" href="../../_images/otp_layout.svg"><img alt="../../_images/otp_layout.svg" height="400" src="../../_images/otp_layout.svg" width="869" /></a>
<figcaption>
<p><span class="caption-text">OTP 布局</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>关于 OTP 各分区的详细布局，请参考相应的 User Manual 文档。</p>
</div>
</section>
<section id="otp-api">
<h1>OTP API 参考<a class="headerlink" href="#otp-api" title="Link to this heading"></a></h1>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>API</p></th>
<th class="head"><p>描述</p></th>
<th class="head"><p>操作区域</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>OTP_Read8</p></td>
<td><p>读取 OTP 物理区域单个字节</p></td>
<td><p>物理区域</p></td>
</tr>
<tr class="row-odd"><td><p>OTP_Write8</p></td>
<td><p>写入 OTP 物理区域单个字节</p></td>
<td><p>物理区域</p></td>
</tr>
<tr class="row-even"><td><p>OTP_LogicalMap_Read</p></td>
<td><p>按长度读取 OTP 逻辑映射区域</p></td>
<td><p>逻辑区域</p></td>
</tr>
<tr class="row-odd"><td><p>OTP_LogicalMap_Write</p></td>
<td><p>按长度写入 OTP 逻辑映射区域地址</p></td>
<td><p>逻辑区域</p></td>
</tr>
<tr class="row-even"><td><p>OTP_RemainLength</p></td>
<td><p>获取逻辑映射区域中 OTP 剩余可用长度</p></td>
<td><p>逻辑区域</p></td>
</tr>
<tr class="row-odd"><td><p>OTPGetCRC</p></td>
<td><p>获取安全区域的 CRC 校验值</p></td>
<td><p>物理区域</p></td>
</tr>
</tbody>
</table>
<section id="otp-read8">
<h2>OTP_Read8<a class="headerlink" href="#otp-read8" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>项目</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>功能</p></td>
<td><p>读取 OTP 物理区域单个字节</p></td>
</tr>
<tr class="row-odd"><td><p>参数</p></td>
<td><ul class="simple">
<li><p>Addr：待读取的 OTP 物理区域地址</p></li>
<li><p>Data：OTP 数据读取缓冲区（1字节）</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>返回值</p></td>
<td><p>读操作结果</p>
<ul class="simple">
<li><p>1：成功</p></li>
<li><p>0：失败</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="otp-write8">
<h2>OTP_Write8<a class="headerlink" href="#otp-write8" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>项目</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>功能</p></td>
<td><p>写入 OTP 物理区域单个字节</p></td>
</tr>
<tr class="row-odd"><td><p>参数</p></td>
<td><ul class="simple">
<li><p>Addr：待写入的 OTP 物理区域地址</p></li>
<li><p>Data：待写入的 1 字节数据</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>返回值</p></td>
<td><p>写操作结果</p>
<ul class="simple">
<li><p>1：成功</p></li>
<li><p>0：失败</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="otp-logicalmap-read">
<h2>OTP_LogicalMap_Read<a class="headerlink" href="#otp-logicalmap-read" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>项目</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>功能</p></td>
<td><p>按长度读取 OTP 逻辑映射区域</p></td>
</tr>
<tr class="row-odd"><td><p>参数</p></td>
<td><ul class="simple">
<li><p>pbuf：OTP 逻辑映射区域使用的缓冲区</p></li>
<li><p>addr：待读取的 OTP 逻辑映射区域起始地址</p></li>
<li><p>len：待读取的 OTP 逻辑映射区域字节长度</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>返回值</p></td>
<td><p>读操作结果</p>
<ul class="simple">
<li><p>1：成功</p></li>
<li><p>0：失败</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="otp-logicalmap-write">
<h2>OTP_LogicalMap_Write<a class="headerlink" href="#otp-logicalmap-write" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>项目</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>功能</p></td>
<td><p>按长度写入 OTP 逻辑映射区域地址</p></td>
</tr>
<tr class="row-odd"><td><p>参数</p></td>
<td><ul class="simple">
<li><p>addr：待写入的 OTP 逻辑映射区域起始地址</p></li>
<li><p>cnts：待写入的 OTP 逻辑映射区域字节长度</p></li>
<li><p>data：待写入的数据</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>返回值</p></td>
<td><p>写操作结果</p>
<ul class="simple">
<li><p>1：成功</p></li>
<li><p>0：失败</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="otp-remainlength">
<h2>OTP_RemainLength<a class="headerlink" href="#otp-remainlength" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>项目</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>功能</p></td>
<td><p>获取逻辑映射区域中 OTP 剩余可用长度</p></td>
</tr>
<tr class="row-odd"><td><p>参数</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td><p>返回值</p></td>
<td><p>剩余可用长度</p></td>
</tr>
</tbody>
</table>
</section>
<section id="otpgetcrc">
<h2>OTPGetCRC<a class="headerlink" href="#otpgetcrc" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>项目</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>功能</p></td>
<td><p>获取安全区域的 CRC 校验值</p></td>
</tr>
<tr class="row-odd"><td><p>参数</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td><p>返回值</p></td>
<td><p>CRC 校验值</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="otp">
<h1>OTP 编程命令<a class="headerlink" href="#otp" title="Link to this heading"></a></h1>
<p>可通过串口使用以下命令访问 OTP 的物理区域和逻辑区域：</p>
<section id="otpc-logical-zone">
<span id="id2"></span><h2>逻辑区域<a class="headerlink" href="#otpc-logical-zone" title="Link to this heading"></a></h2>
<p>通过以下命令可以对逻辑区域进行读写操作。</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>操作</p></th>
<th class="head"><p>命令</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>读</p></td>
<td><p>EFUSE rmap</p></td>
<td><p>读取整个逻辑区域</p></td>
</tr>
<tr class="row-odd"><td><p>写</p></td>
<td><p>EFUSE wmap &lt;address&gt; &lt;length&gt; &lt;data&gt;</p></td>
<td><p>写入到逻辑区域的指定地址</p>
<ul class="simple">
<li><p>address：待写入的起始逻辑地址（十六进制）</p></li>
<li><p>length： 待写入数据的字节数（十六进制）</p></li>
<li><p>data：待写入的数据（十六进制）</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>待写入数据的字符串长度必须为偶数。</p>
</div>
</td>
</tr>
</tbody>
</table>
<p>例如：</p>
<ul class="simple">
<li><p>通过命令 <code class="docutils literal notranslate"><span class="pre">EFUSE</span> <span class="pre">wmap</span> <span class="pre">0</span> <span class="pre">2</span> <span class="pre">3087</span></code> 可以将 0x3087 （2字节）写入逻辑映射地址 0x0。</p></li>
<li><p>通过命令 <code class="docutils literal notranslate"><span class="pre">EFUSE</span> <span class="pre">rmap</span></code> 可以立即读取整个逻辑区域。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">EFUSE</span> <span class="n">wmap</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">3087</span>
</span><span class="n">efuse</span> <span class="n">wmap</span> <span class="n">write</span> <span class="nb">len</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">string</span> <span class="nb">len</span><span class="p">:</span><span class="mi">4</span>
<span class="hll"><span class="n">EFUSE</span> <span class="n">rmap</span>
</span><span class="n">EFUSE</span><span class="p">[</span><span class="mi">000</span><span class="p">]:</span> <span class="mi">30</span> <span class="mi">87</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="n">EFUSE</span><span class="p">[</span><span class="mi">010</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="n">EFUSE</span><span class="p">[</span><span class="mi">020</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="n">EFUSE</span><span class="p">[</span><span class="mi">030</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="o">...</span>
</pre></div>
</div>
<p>在大批量生产（MP）阶段，可通过另一个命令 <code class="docutils literal notranslate"><span class="pre">iwpriv</span></code> 操作逻辑区域。这个命令已经集成在 RF 校准工具中，但仅推荐用来操作 Wi-Fi 校准区域。</p>
</section>
<section id="id3">
<h2>物理区域<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p>通过以下命令可以对物理区域进行读写操作。物理区域的值仅支持从 <strong>1</strong> 改写为 <strong>0</strong>，请谨慎操作。</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>操作</p></th>
<th class="head"><p>命令</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>读</p></td>
<td><p>EFUSE rraw</p></td>
<td><p>读取整个物理区域</p></td>
</tr>
<tr class="row-odd"><td><p>写</p></td>
<td><p>EFUSE wraw &lt;address&gt; &lt;length&gt; &lt;data&gt;</p></td>
<td><p>写入到物理区域的指定地址</p>
<ul class="simple">
<li><p>address：待写入的起始物理地址（十六进制）</p></li>
<li><p>length： 待写入数据的字节数（十六进制）</p></li>
<li><p>data：待写入的数据（十六进制）</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>待写入数据的字符串长度必须为偶数。</p>
</div>
</td>
</tr>
</tbody>
</table>
<p>例如：</p>
<ul class="simple">
<li><p>通过命令 <code class="docutils literal notranslate"><span class="pre">EFUSE</span> <span class="pre">wraw</span> <span class="pre">366</span> <span class="pre">1</span> <span class="pre">FE</span></code> 可以将 0xFE （1字节）写入物理地址 0x366，从而使能 <code class="docutils literal notranslate"><span class="pre">NS_IPSEC_Key2_R_Forbidden_EN</span></code> 位。</p></li>
<li><p>通过命令 <code class="docutils literal notranslate"><span class="pre">EFUSE</span> <span class="pre">rraw</span></code> 可以立即读取整个物理区域。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">EFUSE</span> <span class="n">wraw</span> <span class="mi">366</span> <span class="mi">1</span> <span class="n">FE</span>
</span><span class="n">efuse</span> <span class="n">wraw</span> <span class="n">write</span> <span class="nb">len</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">string</span> <span class="nb">len</span><span class="p">:</span><span class="mi">2</span>
<span class="n">wraw</span><span class="p">:</span> <span class="mi">366</span> <span class="n">fe</span>
<span class="hll"><span class="n">EFUSE</span> <span class="n">rraw</span>
</span><span class="n">efuse</span> <span class="n">rraw</span>
<span class="n">RawMap</span><span class="p">[</span><span class="mi">000</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="n">RawMap</span><span class="p">[</span><span class="mi">010</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="n">RawMap</span><span class="p">[</span><span class="mi">020</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="n">RawMap</span><span class="p">[</span><span class="mi">030</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="o">...</span>
<span class="n">RawMap</span><span class="p">[</span><span class="mi">340</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="n">RawMap</span><span class="p">[</span><span class="mi">350</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="hll"><span class="n">RawMap</span><span class="p">[</span><span class="mi">360</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">fe</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
</span><span class="n">RawMap</span><span class="p">[</span><span class="mi">370</span><span class="p">]:</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>
<span class="o">...</span>
</pre></div>
</div>
<p>在大批量生产阶段，同样可以使用 <a class="reference internal" href="#otpc-logical-zone"><span class="std std-ref">Logical Zone</span></a> 中提到的 Wi-Fi 命令 <code class="docutils literal notranslate"><span class="pre">iwpriv</span></code>。</p>
</section>
</section>
<section id="id4">
<h1>使用方法<a class="headerlink" href="#id4" title="Link to this heading"></a></h1>
<section id="id5">
<h2>逻辑区域<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<p>OTP 仅能编程一次，但在某些情况下部分数据需要被重写。因此，经 Realtek 定义的格式转换后，可以支持逻辑数据被重写，具体请参阅用户手册。</p>
<p>若物理区域（0x0~0x1FF）的剩余空间足够，逻辑区域可被多次编程。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>逻辑区域按字节（而非按位）编程。因此，为避免错误写入导致逻辑映射占用不必要的物理区域，写入新值前应读取逻辑映射以检查原始值。</p>
</div>
<section id="id6">
<h3>系统数据<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<p>逻辑区域（0x000 ~ 0x01F，32字节）会在系统启动时由硬件自动加载至系统寄存器。若系统数据未被编程，系统寄存器保持初始值 0x00，但读取逻辑映射将返回 0xFF。</p>
<p>系统数据的编程流程如下：</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/programming_the_system_data.svg"><img alt="../../_images/programming_the_system_data.svg" height="360" src="../../_images/programming_the_system_data.svg" width="432" /></a>
</figure>
<p>针对目标地址的编程分为两种情况：</p>
<ul class="simple">
<li><p><strong>情况1</strong>：目标地址的系统数据已被编程，请参考 <a class="reference internal" href="#otpc-system-data-example-1"><span class="std std-ref">示例 1</span></a>。</p></li>
<li><p><strong>情况2</strong>：目标地址的系统数据从未被编程，请参考 <a class="reference internal" href="#otpc-system-data-example-2"><span class="std std-ref">示例 2</span></a>。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>编程系统数据时，起始地址必须为 4 字节对齐，且长度为 4 字节。</p>
</div>
<section id="otpc-system-data-example-1">
<span id="id7"></span><h4>示例 1<a class="headerlink" href="#otpc-system-data-example-1" title="Link to this heading"></a></h4>
<p>将逻辑地址 0x02[1] 的值编程为 1，按以下步骤操作：</p>
<ol class="arabic">
<li><p>读取逻辑映射，检查逻辑地址 0x00~0x03 的原始值。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">rmap</span>
</pre></div>
</div>
<p>或</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="n">data_read</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="n">OTP_LogicalMap_Read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data_read</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>假设步骤 1 中读取的逻辑地址 0x00~0x03 数据为 <cite>0x12A03456</cite>。将 <cite>0xA0`（地址 0x02 的字节）与目标位 [1] 进行或操作，其余数据保持默认值。所以新写入的值为 `0x12A23456</cite>。</p></li>
<li><p>写入新值 <cite>0x12A23456</cite> 到逻辑地址 0x00~0x03。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">wmap</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5634</span><span class="n">A212</span>
</pre></div>
</div>
<p>或</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="n">data_written</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0xA2</span><span class="p">,</span><span class="mh">0x12</span><span class="p">};</span>
<span class="n">OTP_LogicalMap_Write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">data_written</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>再次读取数据以验证写入是否成功。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">rmap</span>
</pre></div>
</div>
<p>或</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="n">data_read</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="n">OTP_LogicalMap_Read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data_read</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="otpc-system-data-example-2">
<span id="id8"></span><h4>示例 2<a class="headerlink" href="#otpc-system-data-example-2" title="Link to this heading"></a></h4>
<p>将逻辑地址 0x08[0] 的值编程为 1，按以下步骤操作：</p>
<ol class="arabic">
<li><p>读取逻辑映射，检查逻辑地址 0x08~0x0B 的原始值。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">rmap</span>
</pre></div>
</div>
<p>或</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="n">data_read</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="n">OTP_LogicalMap_Read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data_read</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>假设步骤 1 中读取的逻辑地址 0x08~0x0B 数据为 <cite>0xFFFFFFFF</cite>。将 <cite>0x00`（地址 0x08 的字节）与目标位 [0] 进行或操作，其余数据保持默认值。所以新写入的值为 `x00000001</cite>。</p></li>
<li><p>写入新值 <cite>0x00000001</cite> 到逻辑地址 0x08~0x0B。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">wmap</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mo">01000000</span>
</pre></div>
</div>
<p>或</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="n">data_written</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">};</span>
<span class="n">OTP_LogicalMap_Write</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">data_written</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>再次读取数据以验证写入是否成功。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">rmap</span>
</pre></div>
</div>
<p>或</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="n">data_read</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="n">OTP_LogicalMap_Read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data_read</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="wi-fi">
<h3>Wi-Fi 校准数据<a class="headerlink" href="#wi-fi" title="Link to this heading"></a></h3>
<p>关于 Wi-Fi 校准数据的详细信息，请参考 <em>WS_MP_FLOW.pdf</em>。</p>
</section>
<section id="id9">
<h3>编程场景<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-0-0-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-3" name="0-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>Usually, system data has their initial value, and you can program specific bits according to your demands. Table below lists some scenarios that specific bits need to be programmed at your requirements.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>INI</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Scenarios</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x02</p></td>
<td><p>[1]</p></td>
<td><p>SPIC_ADDR_4BYTE_EN</p></td>
<td><p>0</p></td>
<td><p>SPI Flash controller address 4-byte enable</p>
<p>0: Disable</p>
<p>1: Enable</p>
</td>
<td><ul class="simple">
<li><p>If embedded Flash is used, ignore it.</p></li>
<li><p>If external Flash is used, moreover, its size is larger than 16M bytes, program it.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>0x03</p></td>
<td><p>[1]</p></td>
<td><p>LOW_BAUD_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>LOGUART baud rate selection</p>
<p>0: 1.5Mbps</p>
<p>1: 115200bps</p>
</td>
<td><p>If the LOGUART baud rate needs to be changed from 1.5Mbps to 115200bps, program it.</p></td>
</tr>
<tr class="row-even"><td><p>0x03</p></td>
<td><p>[0]</p></td>
<td><p>DIS_BOOT_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>Boot ROM log disable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>If boot ROM log needs to be disabled, program it.</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p>Usually, system data has their initial value, and you can program specific bits according to your demands. Table below lists some scenarios that specific bits need to be programmed at your requirements.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>INI</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Scenarios</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x02</p></td>
<td><p>[1]</p></td>
<td><p>SPIC_ADDR_4BYTE_EN</p></td>
<td><p>0</p></td>
<td><p>SPI Flash controller address 4-byte enable</p>
<p>0: Disable</p>
<p>1: Enable</p>
</td>
<td><ul class="simple">
<li><p>If embedded Flash is used, ignore it.</p></li>
<li><p>If external Flash is used, moreover, its size is larger than 16M bytes, program it.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>0x03</p></td>
<td><p>[1]</p></td>
<td><p>LOW_BAUD_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>LOGUART baud rate selection</p>
<p>0: 1.5Mbps</p>
<p>1: 115200bps</p>
</td>
<td><p>If the LOGUART baud rate needs to be changed from 1.5Mbps to 115200bps, program it.</p></td>
</tr>
<tr class="row-even"><td><p>0x03</p></td>
<td><p>[0]</p></td>
<td><p>DIS_BOOT_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>Boot ROM log disable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>If boot ROM log needs to be disabled, program it.</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><p>Usually, system data has their initial value, and you can program specific bits according to your demands. Table below lists some scenarios that specific bits need to be programmed at your requirements.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>INI</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Scenarios</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x02</p></td>
<td><p>[1]</p></td>
<td><p>SPIC_ADDR_4BYTE_EN</p></td>
<td><p>0</p></td>
<td><p>SPI Flash controller address 4-byte enable</p>
<p>0: Disable</p>
<p>1: Enable</p>
</td>
<td><ul class="simple">
<li><p>If embedded Flash is used, ignore it.</p></li>
<li><p>If external Flash is used, moreover, its size is larger than 16M bytes, program it.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>0x03</p></td>
<td><p>[1]</p></td>
<td><p>LOW_BAUD_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>LOGUART baud rate selection</p>
<p>0: 1.5Mbps</p>
<p>1: 115200bps</p>
</td>
<td><p>If the LOGUART baud rate needs to be changed from 1.5Mbps to 115200bps, program it.</p></td>
</tr>
<tr class="row-even"><td><p>0x03</p></td>
<td><p>[0]</p></td>
<td><p>DIS_BOOT_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>Boot ROM log disable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>If boot ROM log needs to be disabled, program it.</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-0-0-3" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-3" name="0-3" role="tabpanel" tabindex="0"><p>Usually, system data has their initial value, and you can program specific bits according to your demands. Table below lists some scenarios that specific bits need to be programmed at your requirements.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>INI</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Scenarios</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x02</p></td>
<td><p>[1]</p></td>
<td><p>SPIC_ADDR_4BYTE_EN</p></td>
<td><p>0</p></td>
<td><p>SPI Flash controller address  4-byte enable</p>
<p>0: Disable</p>
<p>1: Enable</p>
</td>
<td><ul class="simple">
<li><p>If embedded Flash is used, ignore it.</p></li>
<li><p>If external Flash is used, moreover, its size is larger than 16M bytes, program it.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>0x02</p></td>
<td><p>[7]</p></td>
<td><p>BIG_PAGE_NAND</p></td>
<td><p>0</p></td>
<td><p>NAND Flash page</p>
<p>0: 2K</p>
<p>1: 4K</p>
</td>
<td><ul class="simple">
<li><p>If embedded NAND Flash is used, ignore it.</p></li>
<li><p>If external NAND Flash is used, moreover, its page is 4K bytes, program it.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>0x03</p></td>
<td><p>[1]</p></td>
<td><p>LOW_BAUD_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>LOGUART baud rate selection</p>
<p>0: 1.5Mbps</p>
<p>1: 115200bps</p>
</td>
<td><p>If the LOGUART baud rate needs to be changed from 1.5Mbps to 115200bps, program it.</p></td>
</tr>
<tr class="row-odd"><td><p>0x03</p></td>
<td><p>[0]</p></td>
<td><p>DIS_BOOT_LOG_EN</p></td>
<td><p>0</p></td>
<td><p>Boot ROM log disable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>If boot ROM log needs to be disabled, program it.</p></td>
</tr>
</tbody>
</table>
</div></div>
</section>
</section>
<section id="id10">
<h2>安全区域<a class="headerlink" href="#id10" title="Link to this heading"></a></h2>
<p>安全区域分为以下三个部分：</p>
<ul class="simple">
<li><p>密钥区域：0x200~0x35F</p></li>
<li><p>配置区域：0x360~0x37F</p></li>
<li><p>用户自定义区域：0x380~0x3FF</p></li>
</ul>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/security_area_layout.svg"><img alt="../../_images/security_area_layout.svg" height="607" src="../../_images/security_area_layout.svg" width="486" /></a>
</figure>
<section id="id11">
<h3>密钥区域<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<p>密钥区域包括以下内容，请至相应的章节查看各密钥的具体用法。</p>
<ul class="simple">
<li><p>IPSEC：参考 <a class="reference internal" href="../3_crypto_engine/1_crypto_engine_toprst_cn.html#hardware-crypto-engine"><span class="std std-ref">对称硬件加密引擎</span></a></p></li>
<li><p>RSIP：参考 <span class="xref std std-ref">RSIP</span></p></li>
<li><p>SWD：参考 <span class="xref std std-ref">SWD 保护</span></p></li>
<li><p>PSA：参考 <span class="xref std std-ref">HUK 生成</span></p></li>
<li><p>安全启动：参考 <span class="xref std std-ref">安全启动</span></p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-1-1-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-2" name="1-2" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-1-1-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-3" name="1-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Size (bits)</p></th>
<th class="head"><p>Start offset</p></th>
<th class="head"><p>End offset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IPSEC</p></td>
<td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>256</p></td>
<td><p>0x200</p></td>
<td><p>0x021F</p></td>
</tr>
<tr class="row-odd"><td><p>IPSEC</p></td>
<td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>256</p></td>
<td><p>0x220</p></td>
<td><p>0x023F</p></td>
</tr>
<tr class="row-even"><td><p>IPSEC</p></td>
<td><p>NS_IPSEC_Key1</p></td>
<td><p>256</p></td>
<td><p>0x240</p></td>
<td><p>0x025F</p></td>
</tr>
<tr class="row-odd"><td><p>IPSEC</p></td>
<td><p>NS_IPSEC_Key2</p></td>
<td><p>256</p></td>
<td><p>0x260</p></td>
<td><p>0x027F</p></td>
</tr>
<tr class="row-even"><td><p>USER PRI</p></td>
<td><p>USER_PRI_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x280</p></td>
<td><p>0x029F</p></td>
</tr>
<tr class="row-odd"><td><p>USER PRI</p></td>
<td><p>USER_PRI_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2A0</p></td>
<td><p>0x02BF</p></td>
</tr>
<tr class="row-even"><td><p>RSIP</p></td>
<td><p>RSIP_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x2C0</p></td>
<td><p>0x02DF</p></td>
</tr>
<tr class="row-odd"><td><p>RSIP</p></td>
<td><p>RSIP_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2E0</p></td>
<td><p>0x02FF</p></td>
</tr>
<tr class="row-even"><td><p>SWD</p></td>
<td><p>SWD_PASSWORD</p></td>
<td><p>128</p></td>
<td><p>0x300</p></td>
<td><p>0x030F</p></td>
</tr>
<tr class="row-odd"><td><p>PSA</p></td>
<td><p>HUK</p></td>
<td><p>128</p></td>
<td><p>0x310</p></td>
<td><p>0x031F</p></td>
</tr>
<tr class="row-even"><td><p>Secure Boot</p></td>
<td><p>PK1 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x320</p></td>
<td><p>0x033F</p></td>
</tr>
<tr class="row-odd"><td><p>Secure Boot</p></td>
<td><p>PK2 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x340</p></td>
<td><p>0x035F</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Size (bits)</p></th>
<th class="head"><p>Start offset</p></th>
<th class="head"><p>End offset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="4"><p>IPSEC</p></td>
<td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>256</p></td>
<td><p>0x200</p></td>
<td><p>0x021F</p></td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>256</p></td>
<td><p>0x220</p></td>
<td><p>0x023F</p></td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1</p></td>
<td><p>256</p></td>
<td><p>0x240</p></td>
<td><p>0x025F</p></td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2</p></td>
<td><p>256</p></td>
<td><p>0x260</p></td>
<td><p>0x027F</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>ECDSA</p></td>
<td><p>ECDSA_PRI_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x280</p></td>
<td><p>0x029F</p></td>
</tr>
<tr class="row-odd"><td><p>ECDSA_PRI_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2A0</p></td>
<td><p>0x02BF</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>RSIP</p></td>
<td><p>RSIP_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x2C0</p></td>
<td><p>0x02DF</p></td>
</tr>
<tr class="row-odd"><td><p>RSIP_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2E0</p></td>
<td><p>0x02FF</p></td>
</tr>
<tr class="row-even"><td><p>SWD</p></td>
<td><p>SWD_PASSWORD</p></td>
<td><p>128</p></td>
<td><p>0x300</p></td>
<td><p>0x030F</p></td>
</tr>
<tr class="row-odd"><td><p>PSA</p></td>
<td><p>HUK</p></td>
<td><p>128</p></td>
<td><p>0x310</p></td>
<td><p>0x031F</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Secure Boot</p></td>
<td><p>PK1 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x320</p></td>
<td><p>0x033F</p></td>
</tr>
<tr class="row-odd"><td><p>PK2 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x340</p></td>
<td><p>0x035F</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-2" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-2" name="1-2" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Size (bits)</p></th>
<th class="head"><p>Start offset</p></th>
<th class="head"><p>End offset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="4"><p>IPSEC</p></td>
<td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>256</p></td>
<td><p>0x200</p></td>
<td><p>0x021F</p></td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>256</p></td>
<td><p>0x220</p></td>
<td><p>0x023F</p></td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1</p></td>
<td><p>256</p></td>
<td><p>0x240</p></td>
<td><p>0x025F</p></td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2</p></td>
<td><p>256</p></td>
<td><p>0x260</p></td>
<td><p>0x027F</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>ECDSA</p></td>
<td><p>ECDSA_PRI_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x280</p></td>
<td><p>0x029F</p></td>
</tr>
<tr class="row-odd"><td><p>ECDSA_PRI_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2A0</p></td>
<td><p>0x02BF</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>RSIP</p></td>
<td><p>RSIP_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x2C0</p></td>
<td><p>0x02DF</p></td>
</tr>
<tr class="row-odd"><td><p>RSIP_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2E0</p></td>
<td><p>0x02FF</p></td>
</tr>
<tr class="row-even"><td><p>SWD</p></td>
<td><p>SWD_PASSWORD</p></td>
<td><p>128</p></td>
<td><p>0x300</p></td>
<td><p>0x030F</p></td>
</tr>
<tr class="row-odd"><td><p>PSA</p></td>
<td><p>HUK</p></td>
<td><p>128</p></td>
<td><p>0x310</p></td>
<td><p>0x031F</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Secure Boot</p></td>
<td><p>PK1 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x320</p></td>
<td><p>0x033F</p></td>
</tr>
<tr class="row-odd"><td><p>PK2 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x340</p></td>
<td><p>0x035F</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-1-1-3" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-3" name="1-3" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Size (bits)</p></th>
<th class="head"><p>Start offset</p></th>
<th class="head"><p>End offset</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="4"><p>IPSEC</p></td>
<td><p>S_IPSEC_Key1 (RDP)</p></td>
<td><p>256</p></td>
<td><p>0x200</p></td>
<td><p>0x021F</p></td>
<td rowspan="4"><p><a class="reference internal" href="../3_crypto_engine/1_crypto_engine_toprst_cn.html#hardware-crypto-engine"><span class="std std-ref">Hardware Crypto Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>S_IPSEC_Key2</p>
<p>(Secure boot HMAC)</p>
</td>
<td><p>256</p></td>
<td><p>0x220</p></td>
<td><p>0x023F</p></td>
</tr>
<tr class="row-even"><td><p>NS_IPSEC_Key1</p></td>
<td><p>256</p></td>
<td><p>0x240</p></td>
<td><p>0x025F</p></td>
</tr>
<tr class="row-odd"><td><p>NS_IPSEC_Key2</p></td>
<td><p>256</p></td>
<td><p>0x260</p></td>
<td><p>0x027F</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>ECDSA</p></td>
<td><p>ECDSA_PRI_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x280</p></td>
<td><p>0x029F</p></td>
<td rowspan="2"><p><a class="reference internal" href="../3_ecdsa_engine/1_ecdsa_toprst_cn.html#ecdsa-engine"><span class="std std-ref">ECDSA Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>ECDSA_PRI_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2A0</p></td>
<td><p>0x02BF</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>RSIP</p></td>
<td><p>RSIP_KEY1</p></td>
<td><p>256</p></td>
<td><p>0x2C0</p></td>
<td><p>0x02DF</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-odd"><td><p>RSIP_KEY2</p></td>
<td><p>256</p></td>
<td><p>0x2E0</p></td>
<td><p>0x02FF</p></td>
</tr>
<tr class="row-even"><td><p>SWD</p></td>
<td><p>SWD_PASSWORD</p></td>
<td><p>128</p></td>
<td><p>0x300</p></td>
<td><p>0x030F</p></td>
<td><p><span class="xref std std-ref">SWD Protection</span></p></td>
</tr>
<tr class="row-odd"><td><p>PSA</p></td>
<td><p>HUK</p></td>
<td><p>128</p></td>
<td><p>0x310</p></td>
<td><p>0x031F</p></td>
<td><p><span class="xref std std-ref">HUK Derivation</span></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Secure Boot</p></td>
<td><p>PK1 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x320</p></td>
<td><p>0x033F</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>PK2 (ROTPK hash)</p></td>
<td><p>256</p></td>
<td><p>0x340</p></td>
<td><p>0x035F</p></td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="id12">
<h3>配置区域<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<p>配置区域的内容如下表所示。关于本区域各字段的具体用法，请参考对应章节的详细说明。</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-2-2-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-2" name="2-2" role="tab" tabindex="-1">RTL8713E</button><button aria-controls="panel-2-2-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-3" name="2-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x360</p></td>
<td><p>[31:0]</p></td>
<td><p>SWD_ID</p></td>
<td><p>SWDID used to mapping the real SWD Key</p></td>
<td rowspan="8"></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x364</p></td>
<td><p>[0]</p></td>
<td><p>SWD_PWD_EN</p></td>
<td><p>SWD password enable</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>SWD_DBGEN</p></td>
<td rowspan="4"><p>SWD external debug authentication</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>SWD_NIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SWD_SPIDEN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SWD_SPNIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>SWD_PWD_R_Protection_EN</p></td>
<td rowspan="23"><p>Key write protection and read protections</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>HUK_W_Forbidden_EN</p></td>
<td></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x365</p></td>
<td><p>[0]</p></td>
<td><p>RSVD</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>PK1_W_Forbidden_EN</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>PK2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>S_IPSEC_Key1_R_Protection_EN</p></td>
<td rowspan="8"><p><a class="reference internal" href="../3_crypto_engine/1_crypto_engine_toprst_cn.html#hardware-crypto-engine"><span class="std std-ref">Hardware Crypto Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>S_IPSEC_Key1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>S_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>S_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>NS_IPSEC_Key1_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x366</p></td>
<td><p>[0]</p></td>
<td><p>NS_IPSEC_Key1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>NS_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>NS_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>USER_PRI_KEY1_R_Protection_EN</p></td>
<td rowspan="4"></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>USER_PRI_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>USER_PRI_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>USER_PRI_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>RSIP_KEY1_R_Protection_EN</p></td>
<td rowspan="5"></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x367</p></td>
<td><p>[0]</p></td>
<td><p>RSIP_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSIP_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>RSIP_MODE_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SIC_SECURE_EN</p></td>
<td><p>Permit SIC to access secure zone</p>
<p>1: Permit</p>
<p>0: Forbid</p>
</td>
<td><p>Program it or keep it default value according to your requirements.</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>CPU_PC_DBG_EN</p></td>
<td><p>Enable to get KM4/KM0 PC value through debug port</p>
<p>1: Enable</p>
<p>0: Disable</p>
</td>
<td><p>Program it or keep it default value according to your requirements.</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>UDF1_TRUSTZONE_EN</p></td>
<td><p>User-defined 1 area (0x380~0x3BF) TrustZone protection enable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>By default, this area can be accessible from both secure world and non-secure world.</p>
<p>To make this area only be accessible from secure world, program this bit.</p>
</td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>UDF2_TRUSTZONE_EN</p></td>
<td><p>User-defined 2 area (0x3C0~0x3FF) TrustZone protection enable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>By default, this area can be accessible from both secure world and non-secure world.</p>
<p>To make this area only be accessible from secure world, program this bit.</p>
</td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x368</p></td>
<td><p>[0]</p></td>
<td><p>UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable power on latch UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable power on latch UART download, program this bit.</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_EN</p></td>
<td rowspan="4"><p>Enable/Disable RSIP control</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SECURE_BOOT_EN</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SECURE_BOOT_HW_DIS</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>RDP_EN</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>ANTI_ROLLBACK_EN</p></td>
<td></td>
<td><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>FAULT_LOG_PRINT_DIS</p></td>
<td><p>Used in ROM to disable ROM hard fault log</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable ROM hard fault log, program this bit.</p></td>
</tr>
<tr class="row-odd"><td rowspan="7"><p>0x369</p></td>
<td><p>[1:0]</p></td>
<td><p>RSIP_MODE</p></td>
<td><p>RSIP Mode</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>HUK_DERIV_EN</p></td>
<td><p>Enable/Disable HUK derive</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>USER_PHYSICAL_TZ1_EN</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>[4]</p></td>
<td><p>USER_PHYSICAL_TZ2_EN</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>[5]</p></td>
<td><p>SW_RSVD0</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>[6]</p></td>
<td><p>SWTRIG_UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable SW trigger UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable SW trigger UART download, program this bit.</p></td>
</tr>
<tr class="row-odd"><td><p>[7]</p></td>
<td><p>SPIC_PINMUX_TESTMODE_DISABLE</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>0x36A</p></td>
<td><p>[7:0]</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>0x36B</p></td>
<td><p>[3:0]</p></td>
<td><p>SECURE_BOOT_AUTH_LOG</p></td>
<td><p>Secure boot Auth Algorithm</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-even"><td><p>[7:4]</p></td>
<td><p>SECURE_BOOT_HASH_LOG</p></td>
<td><p>Secure boot Hash Algorithm</p></td>
</tr>
<tr class="row-odd"><td><p>0x36C</p></td>
<td><p>[15:0]</p></td>
<td><p>OTA_ADDR</p></td>
<td><p>OTA address, 4K aligned</p></td>
<td rowspan="2"><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-even"><td><p>0x36E</p></td>
<td><p>[15:0]</p></td>
<td><p>BOOTLOADER_VERSION</p></td>
<td><p>Bootloader version</p></td>
</tr>
<tr class="row-odd"><td><p>0x370</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC0</p></td>
<td rowspan="4"><p>CRC check</p></td>
<td rowspan="4"><p><a class="reference internal" href="#otpc-usage-security-zone-config-area-crc"><span class="std std-ref">CRC</span></a></p></td>
</tr>
<tr class="row-even"><td><p>0x374</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC1</p></td>
</tr>
<tr class="row-odd"><td><p>0x378</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC2</p></td>
</tr>
<tr class="row-even"><td><p>0x37C</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC3</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x360</p></td>
<td><p>[31:0]</p></td>
<td><p>SWD_ID</p></td>
<td><p>SWDID used to mapping the real SWD Key</p></td>
<td rowspan="8"><p><span class="xref std std-ref">SWD Protection</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x364</p></td>
<td><p>[0]</p></td>
<td><p>SWD_PWD_EN</p></td>
<td><p>SWD password enable</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>SWD_DBGEN</p></td>
<td rowspan="4"><p>SWD external debug authentication</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>SWD_NIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SWD_SPIDEN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SWD_SPNIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>SWD_PWD_R_Protection_EN</p></td>
<td rowspan="23"><p>Key write protection and read protection</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>HUK_W_Forbidden_EN</p></td>
<td><p><span class="xref std std-ref">HUK Derivation</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x365</p></td>
<td><p>[0]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>PK1_W_Forbidden_EN</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>PK2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>S_IPSEC_Key1_R_Protection_EN</p></td>
<td rowspan="8"><p><a class="reference internal" href="../3_crypto_engine/1_crypto_engine_toprst_cn.html#hardware-crypto-engine"><span class="std std-ref">Hardware Crypto Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>S_IPSEC_Key1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>S_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>S_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>NS_IPSEC_Key1_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x366</p></td>
<td><p>[0]</p></td>
<td><p>NS_IPSEC_Key1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>NS_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>NS_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>ECDSA_PRI_KEY1_R_Protection_EN</p></td>
<td rowspan="4"><p><a class="reference internal" href="../3_ecdsa_engine/1_ecdsa_toprst_cn.html#ecdsa-engine"><span class="std std-ref">ECDSA Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>ECDSA_PRI_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>ECDSA_PRI_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>ECDSA_PRI_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>RSIP_KEY1_R_Protection_EN</p></td>
<td rowspan="5"><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x367</p></td>
<td><p>[0]</p></td>
<td><p>RSIP_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSIP_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>RSIP_MODE_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SIC_SECURE_EN</p></td>
<td><p>Permit SIC to access secure zone</p>
<p>1: Permit</p>
<p>0: Forbid</p>
</td>
<td><p>Program it or keep default value at your requirement</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>CPU_PC_DBG_EN</p></td>
<td><p>Enable get KM4/KR4 PC value through debug port</p>
<p>1: Enable</p>
<p>0: Disable</p>
</td>
<td><p>Program it or keep default value at your requirement</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>UDF1_TRUSTZONE_EN</p></td>
<td><p>User-defined 1 area (0x380~0x3BF) TrustZone protection enable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>By default, this area can be accessible from both secure world and non-secure world.</p>
<p>To make this area only be accessible from secure world, program this bit.</p>
</td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>UDF2_TRUSTZONE_EN</p></td>
<td><p>User-defined 2 area (0x3C0~0x3FF) TrustZone protection enable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>By default, this area can be accessible from both secure world and non-secure world.</p>
<p>To make this area only be accessible from secure world, program this bit.</p>
</td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x368</p></td>
<td><p>[0]</p></td>
<td><p>UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable power on latch UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable power on latch UART download, program this bit.</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_EN</p></td>
<td rowspan="4"><p>Enable/Disable RSIP control</p></td>
<td><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SECURE_BOOT_EN</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SECURE_BOOT_HW_DIS</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>RDP_EN</p></td>
<td><p><span class="xref std std-ref">Read Protection</span></p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>Anti_Rollback_EN</p></td>
<td></td>
<td><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>FAULT_LOG_PRINT_DIS</p></td>
<td><p>Used in ROM to disable ROM hard fault log</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable hard fault log, program this bit.</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x369</p></td>
<td><p>[1:0]</p></td>
<td><p>RSIP_MODE</p></td>
<td><p>RSIP Mode</p></td>
<td><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>HUK_DERIV_EN</p></td>
<td><p>Enable/Disable HUK derive</p></td>
<td><p><span class="xref std std-ref">HUK Derivation</span></p></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>SWTRIG_UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable SW trigger UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable SW trigger UART download, program this bit.</p></td>
</tr>
<tr class="row-even"><td><p>[7:4]</p></td>
<td><p>SW_RSVD0</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>0x36A</p></td>
<td><p>[7:0]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>0x36B</p></td>
<td><p>[3:0]</p></td>
<td><p>SECURE_BOOT_AUTH_LOG</p></td>
<td><p>Secure boot Auth Algorithm</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[7:4]</p></td>
<td><p>SECURE_BOOT_HASH_LOG</p></td>
<td><p>Secure boot Hash Algorithm</p></td>
</tr>
<tr class="row-even"><td><p>0x36C</p></td>
<td><p>[15:0]</p></td>
<td><p>OTA_ADDR[15:0]</p></td>
<td><p>OTA address, 4K aligned</p></td>
<td rowspan="2"><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>0x36E</p></td>
<td><p>[15:0]</p></td>
<td><p>BOOTLOADER[15:0]</p></td>
<td><p>Bootloader version</p></td>
</tr>
<tr class="row-even"><td><p>0x370</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC0[31:0]</p></td>
<td rowspan="4"><p>CRC check</p></td>
<td rowspan="4"><p><a class="reference internal" href="#otpc-usage-security-zone-config-area-crc"><span class="std std-ref">CRC</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>0x374</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC1[31:0]</p></td>
</tr>
<tr class="row-even"><td><p>0x378</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC2[31:0]</p></td>
</tr>
<tr class="row-odd"><td><p>0x37C</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC3[31:0]</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-2-2-2" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-2" name="2-2" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x360</p></td>
<td><p>[31:0]</p></td>
<td><p>SWD_ID</p></td>
<td><p>SWDID use to mapping the real SWD Key</p></td>
<td rowspan="8"><p><span class="xref std std-ref">SWD Protection</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x364</p></td>
<td><p>[0]</p></td>
<td><p>SWD_PWD_EN</p></td>
<td><p>SWD password enable</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>SWD_DBGEN</p></td>
<td rowspan="4"><p>SWD external debug authentication</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>SWD_NIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SWD_SPIDEN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SWD_SPNIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>SWD_PWD_R_Protection_EN</p></td>
<td rowspan="23"><p>Key write protection and read protections</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>HUK_W_Forbidden_EN</p></td>
<td><p><span class="xref std std-ref">HUK Derivation</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x365</p></td>
<td><p>[0]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>PK1_W_Forbidden_EN</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>PK2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>RSVD</p></td>
<td rowspan="8"><p><a class="reference internal" href="../3_crypto_engine/1_crypto_engine_toprst_cn.html#hardware-crypto-engine"><span class="std std-ref">Hardware Crypto Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>RSVD</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>S_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>S_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>NS_IPSEC_Key1_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x366</p></td>
<td><p>[0]</p></td>
<td><p>NS_IPSEC_Key1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>NS_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>NS_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>ECDSA_PRI_KEY1_R_Protection_EN</p></td>
<td rowspan="4"><p><a class="reference internal" href="../3_ecdsa_engine/1_ecdsa_toprst_cn.html#ecdsa-engine"><span class="std std-ref">ECDSA Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>ECDSA_PRI_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>ECDSA_PRI_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>ECDSA_PRI_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>RSIP_KEY1_R_Protection_EN</p></td>
<td rowspan="5"><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x367</p></td>
<td><p>[0]</p></td>
<td><p>RSIP_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSIP_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>RSIP_MODE_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SIC_SECURE_EN</p></td>
<td><p>Permit SIC to access secure zone</p>
<p>1: Permit</p>
<p>0: Forbid</p>
</td>
<td><p>Program it or keep default value at your requirement</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>CPU_PC_DBG_EN</p></td>
<td><p>Enable get KM4/KR4 PC value through debug port</p>
<p>1: Enable</p>
<p>0: Disable</p>
</td>
<td><p>Program it or keep default value at your requirement</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x368</p></td>
<td><p>[0]</p></td>
<td><p>UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable power on latch UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable power on latch UART download, program this bit.</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_EN</p></td>
<td rowspan="4"><p>Enable/Disable RSIP control</p></td>
<td><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SECURE_BOOT_EN</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SECURE_BOOT_HW_DIS</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>Anti_Rollback_EN</p></td>
<td></td>
<td><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>FAULT_LOG_PRINT_DIS</p></td>
<td><p>Used in ROM to disable ROM hard fault log</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable hard fault log, program this bit.</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x369</p></td>
<td><p>[1:0]</p></td>
<td><p>RSIP_MODE</p></td>
<td><p>RSIP Mode</p></td>
<td><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>HUK_DERIV_EN</p></td>
<td><p>Enable/Disable HUK derive</p></td>
<td><p><span class="xref std std-ref">HUK Derivation</span></p></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>SWTRIG_UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable SW trigger UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable SW trigger UART download, program this bit.</p></td>
</tr>
<tr class="row-even"><td><p>[7:4]</p></td>
<td><p>SW_RSVD0</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>0x36A</p></td>
<td><p>[7:0]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>0x36B</p></td>
<td><p>[3:0]</p></td>
<td><p>SECURE_BOOT_AUTH_LOG</p></td>
<td><p>Secure boot Auth Algorithm</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[7:4]</p></td>
<td><p>SECURE_BOOT_HASH_LOG</p></td>
<td><p>Secure boot Hash Algorithm</p></td>
</tr>
<tr class="row-even"><td><p>0x36C</p></td>
<td><p>[15:0]</p></td>
<td><p>OTA_ADDR[15:0]</p></td>
<td><p>OTA address, 4K aligned</p></td>
<td rowspan="2"><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>0x36E</p></td>
<td><p>[15:0]</p></td>
<td><p>BOOTLOADER[15:0]</p></td>
<td><p>Bootloader version</p></td>
</tr>
<tr class="row-even"><td><p>0x370</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC0[31:0]</p></td>
<td rowspan="4"><p>CRC check</p></td>
<td rowspan="4"><p><a class="reference internal" href="#otpc-usage-security-zone-config-area-crc"><span class="std std-ref">CRC</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>0x374</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC1[31:0]</p></td>
</tr>
<tr class="row-even"><td><p>0x378</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC2[31:0]</p></td>
</tr>
<tr class="row-odd"><td><p>0x37C</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC3[31:0]</p></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-2-2-3" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-3" name="2-3" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x360</p></td>
<td><p>[31:0]</p></td>
<td><p>SWD_ID</p></td>
<td><p>SWDID used to mapping the real SWD Key</p></td>
<td rowspan="8"><p><span class="xref std std-ref">SWD Protection</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x364</p></td>
<td><p>[0]</p></td>
<td><p>SWD_PWD_EN</p></td>
<td><p>SWD password enable</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>SWD_DBGEN</p></td>
<td rowspan="4"><p>SWD external debug authentication</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>SWD_NIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SWD_SPIDEN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SWD_SPNIDEN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>SWD_PWD_R_Protection_EN</p></td>
<td rowspan="23"><p>Key write protection and read protection</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>HUK_W_Forbidden_EN</p></td>
<td><p><span class="xref std std-ref">HUK Derivation</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x365</p></td>
<td><p>[0]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>PK1_W_Forbidden_EN</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>PK2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>S_IPSEC_Key1_R_Protection_EN</p></td>
<td rowspan="8"><p><a class="reference internal" href="../3_crypto_engine/1_crypto_engine_toprst_cn.html#hardware-crypto-engine"><span class="std std-ref">Hardware Crypto Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>S_IPSEC_Key1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>S_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>S_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>NS_IPSEC_Key1_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x366</p></td>
<td><p>[0]</p></td>
<td><p>NS_IPSEC_Key1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>NS_IPSEC_Key2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>NS_IPSEC_Key2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>ECDSA_PRI_KEY1_R_Protection_EN</p></td>
<td rowspan="4"><p><a class="reference internal" href="../3_ecdsa_engine/1_ecdsa_toprst_cn.html#ecdsa-engine"><span class="std std-ref">ECDSA Engine</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>ECDSA_PRI_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>ECDSA_PRI_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>ECDSA_PRI_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>RSIP_KEY1_R_Protection_EN</p></td>
<td rowspan="5"><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x367</p></td>
<td><p>[0]</p></td>
<td><p>RSIP_KEY1_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSIP_KEY2_R_Protection_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_KEY2_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>RSIP_MODE_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SIC_SECURE_EN</p></td>
<td><p>Permit SIC to access secure zone</p>
<p>1: Permit</p>
<p>0: Forbid</p>
</td>
<td><p>Program it or keep default value at your requirement</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>CPU_PC_DBG_EN</p></td>
<td><p>Enable get KM4/KM0 PC value through debug port</p>
<p>1: Enable</p>
<p>0: Disable</p>
</td>
<td><p>Program it or keep default value at your requirement</p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>UDF1_TRUSTZONE_EN</p></td>
<td><p>User-defined 1 area (0x380~0x3BF) TrustZone protection enable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>By default, this area can be accessible from both secure world and non-secure world.</p>
<p>To make this area only be accessible from secure world, program this bit.</p>
</td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>UDF2_TRUSTZONE_EN</p></td>
<td><p>User-defined 2 area (0x3C0~0x3FF) TrustZone protection enable</p>
<p>0: Enable</p>
<p>1: Disable</p>
</td>
<td><p>By default, this area can be accessible from both secure world and non-secure world.</p>
<p>To make this area only be accessible from secure world, program this bit.</p>
</td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>0x368</p></td>
<td><p>[0]</p></td>
<td><p>HWTRIG_UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable power on latch UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable power on latch UART download, program this bit.</p></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RSIP_EN</p></td>
<td rowspan="4"><p>Enable/Disable RSIP control</p></td>
<td><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-even"><td><p>[3]</p></td>
<td><p>SECURE_BOOT_EN</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[4]</p></td>
<td><p>SECURE_BOOT_HW_DIS</p></td>
</tr>
<tr class="row-even"><td><p>[5]</p></td>
<td><p>RDP_EN</p></td>
<td><p><span class="xref std std-ref">Read Protection</span></p></td>
</tr>
<tr class="row-odd"><td><p>[6]</p></td>
<td><p>Anti_Rollback_EN</p></td>
<td></td>
<td><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-even"><td><p>[7]</p></td>
<td><p>FAULT_LOG_PRINT_DIS</p></td>
<td><p>Used in ROM to disable ROM hard fault log</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable hard fault log, program this bit.</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x369</p></td>
<td><p>[1:0]</p></td>
<td><p>RSIP_MODE</p></td>
<td><p>RSIP Mode</p></td>
<td><p><span class="xref std std-ref">Secure Image Protection</span></p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>HUK_DERIV_EN</p></td>
<td><p>Enable/Disable HUK derive</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>SWTRIG_UART_DOWNLOAD_DISABLE</p></td>
<td><p>Used in ROM to disable SW trigger UART download</p>
<p>0: Disable</p>
<p>1: Enable (default)</p>
</td>
<td><p>To disable SW trigger UART download, program this bit.</p></td>
</tr>
<tr class="row-even"><td><p>[7:4]</p></td>
<td><p>SW_RSVD0</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>0x36A</p></td>
<td><p>[7:0]</p></td>
<td><p>RSVD</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>0x36B</p></td>
<td><p>[3:0]</p></td>
<td><p>SECURE_BOOT_AUTH_LOG</p></td>
<td><p>Secure boot Auth Algorithm</p></td>
<td rowspan="2"><p><span class="xref std std-ref">Secure Boot</span></p></td>
</tr>
<tr class="row-odd"><td><p>[7:4]</p></td>
<td><p>SECURE_BOOT_HASH_LOG</p></td>
<td><p>Secure boot Hash Algorithm</p></td>
</tr>
<tr class="row-even"><td><p>0x36C</p></td>
<td><p>[15:0]</p></td>
<td><p>OTA_ADDR</p></td>
<td><p>OTA address, 4K aligned</p></td>
<td rowspan="2"><p><a class="reference internal" href="../1_ota/1_ota_toprst_cn.html#ota-firmware-update"><span class="std std-ref">OTA Firmware Update</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>0x36E</p></td>
<td><p>[15:0]</p></td>
<td><p>BOOTLOADER_VERSION</p></td>
<td><p>Bootloader version</p></td>
</tr>
<tr class="row-even"><td><p>0x370</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC0</p></td>
<td rowspan="4"><p>CRC check</p></td>
<td rowspan="4"><p><a class="reference internal" href="#otpc-usage-security-zone-config-area-crc"><span class="std std-ref">CRC</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>0x374</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC1</p></td>
</tr>
<tr class="row-even"><td><p>0x378</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC2</p></td>
</tr>
<tr class="row-odd"><td><p>0x37C</p></td>
<td><p>[31:0]</p></td>
<td><p>CRC3</p></td>
</tr>
</tbody>
</table>
</div></div>
<section id="otpc-crc">
<span id="otpc-usage-security-zone-config-area-crc"></span><h4>OTPC CRC 校验<a class="headerlink" href="#otpc-crc" title="Link to this heading"></a></h4>
<p>CRC is used for defending against injection attacks, and this function is accomplished by comparing the valid CRC entry that you programmed into OTP with the one calculated by hardware for security zone (0x200~0x36B).
If you want to ensure the secure zone un-attacked, then CRC field needs to be programmed.</p>
<p>One CRC entry takes 4 bytes, including a 2-byte magic number and a 2-byte valid CRC value.</p>
<p>There are 4 CRC entries in total in physical OTP and you can only use one entry at one time. You must use entry 0 first, and then entry1, entry2 and use entry3 at last.
CRC check cannot be disabled once enabled. Rom will enter endless loop if magic number or valid CRC check fail.</p>
<p>When you use CRC validation function for the first time, please follow the following steps:</p>
<ol class="arabic">
<li><p>Program CRC entry after you make sure that security zone has been programmed done. Because any modification for the security zone (0x200~0x36B) will cause CRC value changed, then you have to re-program an new CRC entry, which will result in wasting one CRC entry</p></li>
<li><p>Get the valid CRC value without actually enabling the CRC function by func:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u32</span><span class="w"> </span><span class="n">OTPGetCRC</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Program valid CRC value calculated in previous step and magic number (0x8730) of the entry 0.</p>
<ul>
<li><p>Magic number is 0x8730:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">wraw</span><span class="w"> </span><span class="mi">370</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3087</span>
</pre></div>
</div>
</li>
<li><p>Assuming that CRC value is 0xB4C5:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">wraw</span><span class="w"> </span><span class="mi">372</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">C5B4</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Read the CRC entry back, to check whether it’s been written correctly</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">rraw</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<p>Pay attention to the order of data.</p>
</div>
</li>
<li><p>Reset the chip</p>
<ul class="simple">
<li><p>If the CRC entry is checked pass, the boot process will be successfully.</p></li>
<li><p>If the CRC entry is checked fail, the following log will show up, and the chip enters endless loop.</p></li>
</ul>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/otpc_usage_security_zone_config_area_crc.png"><img alt="../../_images/otpc_usage_security_zone_config_area_crc.png" src="../../_images/otpc_usage_security_zone_config_area_crc.png" style="width: 275.4px; height: 79.8px;" /></a>
</figure>
</li>
</ol>
<p>If security zone (0x200~0x36B) has been changed, a new CRC entry is needed.</p>
<ol class="arabic">
<li><p>Make sure that security zone has programmed done.</p></li>
<li><p>Get the new CRC value.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u32</span><span class="w"> </span><span class="n">OTPGetCRC</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Program the previous used entry to all 0x00 to invalidate this entry, that means both CRC and magic number are programmed into 0x00.</p>
<p>For example, assuming entry 0 is the previous entry:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">wraw</span><span class="w"> </span><span class="mi">370</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mo">00000000</span>
</pre></div>
</div>
</li>
<li><p>Program the next CRC entry with valid CRC and magic number to validate the next entry.</p>
<p>For example, if entry 0 is the previous entry, entry 1 should be used now:</p>
<ul>
<li><p>Magic number is 0x8730:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">wraw</span><span class="w"> </span><span class="mi">374</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3087</span>
</pre></div>
</div>
</li>
<li><p>Assuming that CRC value is 0xB4C5:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">wraw</span><span class="w"> </span><span class="mi">376</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">C5B4</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Read the CRC entry back to check whether it’s been written correctly</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">efuse</span><span class="w"> </span><span class="n">rraw</span>
</pre></div>
</div>
</li>
<li><p>Reset the chip to check if CRC entry is ok.</p>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<ul class="simple">
<li><p>We suggest users programming CRC entry in factory.</p></li>
<li><p>Once CRC entry is programmed, and you need to modify secure zone. Please remember to invalidate current CRC entry and program the correct CRC value and magic number in the next CRC entry before re-boot. Otherwise, chip will enter endless loop and cannot boot successfully again.</p></li>
</ul>
</div>
</li>
</ol>
</section>
</section>
</section>
<section id="id13">
<h2>隐藏物理区域<a class="headerlink" href="#id13" title="Link to this heading"></a></h2>
<p>隐藏物理区域存储部分 RMA 密钥和 Realtek 校准数据，用户仅可编程与 RMA 相关的区域。</p>
<p>在此区域中，以下两个密钥具备独立的读保护和写保护机制，且会被自动加载到硬件中：</p>
<ul class="simple">
<li><p>SWD密钥：若处于未编程状态（0xFF），则表明密钥未被启用。</p></li>
<li><p>安全启动公钥哈希：若处于未编程状态（0xFF），则表示在 RMA 模式下禁用安全启动功能。</p></li>
</ul>
<p>隐藏物理区域的具体内容及用途如下表所示：</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">RTL8721Dx</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">RTL8720E</button><button aria-controls="panel-3-3-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-2" name="3-2" role="tab" tabindex="-1">RTL8726E</button><button aria-controls="panel-3-3-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-3" name="3-3" role="tab" tabindex="-1">RTL8730E</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x700</p></td>
<td><p>[7:0]</p></td>
<td><p>RMA (Life State)</p></td>
<td><p>Define which mode device works in.</p>
<ul class="simple">
<li><p>If the number of 1 is odd, it will go to RMA mode</p></li>
<li><p>If the number of 1 is even, it will go to Normal mode</p></li>
</ul>
<p>HW will auto-load the work mode first when boot.</p>
<p>In RMA mode, the secure 4K bits should be protected and return all <code class="docutils literal notranslate"><span class="pre">1</span></code> when read.</p>
</td>
<td><ul class="simple">
<li><p>To make the device go to RMA mode, you should program this field to make sure the number of 1 is odd.</p></li>
<li><p>To make the device go to Normal mode, you should program this field to make sure the number of 1 is even.</p></li>
<li><p>By default, the value is 0xFF and it’s in normal mode.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td rowspan="7"><p>0x701</p></td>
<td><p>[1:0]</p></td>
<td><p>ROM_PATCH_EN</p></td>
<td rowspan="7"><p>Defined by Realtek</p></td>
<td rowspan="7"><p>Used by Realtek</p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>ROM_PATCH_LWE1</p></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>ROM_PATCH_LWE2</p></td>
</tr>
<tr class="row-even"><td><p>[4]</p></td>
<td><p>ROM_PATCH_LWE3</p></td>
</tr>
<tr class="row-odd"><td><p>[5]</p></td>
<td><p>ROM_PATCH_LWE4</p></td>
</tr>
<tr class="row-even"><td><p>[6]</p></td>
<td><p>ROM_PATCH_LWE5</p></td>
</tr>
<tr class="row-odd"><td><p>[7]</p></td>
<td><p>ROM_PATCH_HWE</p></td>
</tr>
<tr class="row-even"><td rowspan="4"><p>0x702</p></td>
<td><p>[0]</p></td>
<td><p>RMA_SWD_PWD_R_Protection_EN</p></td>
<td rowspan="3"><p>Key read protection and write protection.</p></td>
<td rowspan="3"></td>
</tr>
<tr class="row-odd"><td><p>[1]</p></td>
<td><p>RMA_SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>RMA_PK_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[7:3]</p></td>
<td><p>RSVD</p></td>
<td><p>Reserved</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>0x704</p></td>
<td><p>[63:0]</p></td>
<td><p>ADC calibration</p></td>
<td><p>Defined by Realtek</p></td>
<td><p>Used by Realtek</p></td>
</tr>
<tr class="row-odd"><td><p>0x710</p></td>
<td><p>128</p></td>
<td><p>RMA SWD Key</p></td>
<td><p>SWD Key in RMA Mode</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>0x720</p></td>
<td><p>256</p></td>
<td><p>RMA SBOOT KEY HASH</p></td>
<td><p>SBOOT Key Hash in RMA Mode</p></td>
<td></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x700</p></td>
<td><p>[7:0]</p></td>
<td><p>RMA (Life state)</p></td>
<td><p>Define which mode device works in.</p>
<ul class="simple">
<li><p>If the number of 1 is odd, it will go to RMA mode.</p></li>
<li><p>If the number of 1 is even, it will go to normal mode.</p></li>
</ul>
<p>HW will auto-load the work mode first when boot.</p>
<p>In RMA mode, the secure 4K bits should be protected and return all <code class="docutils literal notranslate"><span class="pre">1</span></code> when read.</p>
</td>
<td><ul class="simple">
<li><p>To make the device go to RMA mode, you should program this field to make sure the number of 1 is odd.</p></li>
<li><p>To make the device go to Normal mode, you should program this field to make sure the number of 1 is even.</p></li>
<li><p>By default, the value is 0xFF and it’s in normal mode.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x701</p></td>
<td><p>[1:0]</p></td>
<td><p>ROM_PATCH_EN</p></td>
<td rowspan="3"><p>Defined by Realtek</p></td>
<td rowspan="4"><p>Used by Realtek</p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>ROM_PATCH_LWE</p></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>ROM_PATCH_HWE</p></td>
</tr>
<tr class="row-even"><td><p>[7:4]</p></td>
<td><p>RSVD</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x702</p></td>
<td><p>[0]</p></td>
<td><p>RMA_SWD_PWD_R_Protection_EN</p></td>
<td rowspan="3"><p>Key read protection and write protection</p></td>
<td rowspan="4"></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RMA_SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RMA_PK_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7:3]</p></td>
<td><p>RSVD</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>0x704</p></td>
<td><p>[63:0]</p></td>
<td><p>ADC calibration</p></td>
<td><p>Defined by Realtek</p></td>
<td><p>Used by Realtek</p></td>
</tr>
<tr class="row-even"><td><p>0x710</p></td>
<td><p>[127:0]</p></td>
<td><p>RMA SWD Key</p></td>
<td><p>SWD Key in RMA Mode</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0x720</p></td>
<td><p>[255:0]</p></td>
<td><p>RMA SBOOT Key Hash</p></td>
<td><p>SBOOT Key Hash in RMA Mode</p></td>
<td></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-3-3-2" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-2" name="3-2" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x700</p></td>
<td><p>[7:0]</p></td>
<td><p>RMA (Life state)</p></td>
<td><p>Define which mode device works in.</p>
<ul class="simple">
<li><p>If the number of 1 is odd, it will go to RMA mode.</p></li>
<li><p>If the number of 1 is even, it will go to normal mode.</p></li>
</ul>
<p>HW will auto-load the work mode first when boot.</p>
<p>In RMA mode, the secure 4K bits should be protected and return all <code class="docutils literal notranslate"><span class="pre">1</span></code> when read.</p>
</td>
<td><ul class="simple">
<li><p>To make the device go to RMA mode, you should program this field to make sure the number of 1 is odd.</p></li>
<li><p>To make the device go to Normal mode, you should program this field to make sure the number of 1 is even.</p></li>
<li><p>By default, the value is 0xFF and it’s in normal mode.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x701</p></td>
<td><p>[1:0]</p></td>
<td><p>ROM_PATCH_EN</p></td>
<td rowspan="3"><p>Defined by Realtek</p></td>
<td rowspan="4"><p>Used by Realtek</p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>ROM_PATCH_LWE</p></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>ROM_PATCH_HWE</p></td>
</tr>
<tr class="row-even"><td><p>[7:4]</p></td>
<td><p>RSVD</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x702</p></td>
<td><p>[0]</p></td>
<td><p>RMA_SWD_PWD_R_Protection_EN</p></td>
<td rowspan="3"><p>Key read protection and write protection</p></td>
<td rowspan="4"></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RMA_SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RMA_PK_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7:3]</p></td>
<td><p>RSVD</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>0x704</p></td>
<td><p>[63:0]</p></td>
<td><p>ADC calibration</p></td>
<td><p>Defined by Realtek</p></td>
<td><p>Used by Realtek</p></td>
</tr>
<tr class="row-even"><td><p>0x710</p></td>
<td><p>[127:0]</p></td>
<td><p>RMA SWD Key</p></td>
<td><p>SWD Key in RMA Mode</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0x720</p></td>
<td><p>[255:0]</p></td>
<td><p>RMA SBOOT Key Hash</p></td>
<td><p>SBOOT Key Hash in RMA Mode</p></td>
<td></td>
</tr>
</tbody>
</table>
</div><div aria-labelledby="tab-3-3-3" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-3" name="3-3" role="tabpanel" tabindex="0"><table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Bit</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x700</p></td>
<td><p>[7:0]</p></td>
<td><p>RMA (Life state)</p></td>
<td><p>Define which mode device works in.</p>
<ul class="simple">
<li><p>If the number of 1 is odd, it will go to RMA mode.</p></li>
<li><p>If the number of 1 is even, it will go to normal mode.</p></li>
</ul>
<p>HW will auto-load the work mode first when boot.</p>
<p>In RMA mode, the secure 4K bits should be protected and return all <code class="docutils literal notranslate"><span class="pre">1</span></code> when read.</p>
</td>
<td><ul class="simple">
<li><p>To make the device go to RMA mode, you should program this field to make sure the number of 1 is odd.</p></li>
<li><p>To make the device go to Normal mode, you should program this field to make sure the number of 1 is even.</p></li>
<li><p>By default, the value is 0xFF and it’s in normal mode.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x701</p></td>
<td><p>[1:0]</p></td>
<td><p>ROM_PATCH_EN</p></td>
<td rowspan="3"><p>Defined by Realtek</p></td>
<td rowspan="4"><p>Used by Realtek</p></td>
</tr>
<tr class="row-even"><td><p>[2]</p></td>
<td><p>ROM_PATCH_LWE</p></td>
</tr>
<tr class="row-odd"><td><p>[3]</p></td>
<td><p>ROM_PATCH_HWE</p></td>
</tr>
<tr class="row-even"><td><p>[7:4]</p></td>
<td><p>RSVD</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>0x702</p></td>
<td><p>[0]</p></td>
<td><p>RMA_SWD_PWD_R_Protection_EN</p></td>
<td rowspan="3"><p>Key read protection and write protection</p></td>
<td rowspan="4"></td>
</tr>
<tr class="row-even"><td><p>[1]</p></td>
<td><p>RMA_SWD_PWD_W_Forbidden_EN</p></td>
</tr>
<tr class="row-odd"><td><p>[2]</p></td>
<td><p>RMA_PK_W_Forbidden_EN</p></td>
</tr>
<tr class="row-even"><td><p>[7:3]</p></td>
<td><p>RSVD</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>0x704</p></td>
<td><p>[63:0]</p></td>
<td><p>ADC calibration</p></td>
<td><p>Defined by Realtek</p></td>
<td><p>Used by Realtek</p></td>
</tr>
<tr class="row-even"><td><p>0x710</p></td>
<td><p>[127:0]</p></td>
<td><p>RMA SWD Key</p></td>
<td><p>SWD Key in RMA Mode</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0x720</p></td>
<td><p>[255:0]</p></td>
<td><p>RMA SBOOT Key Hash</p></td>
<td><p>SBOOT Key Hash in RMA Mode</p></td>
<td></td>
</tr>
</tbody>
</table>
</div></div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>读保护和写保护一旦启用，密钥将无法再次被读取。请务必妥善保管密钥。</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="0_otpc_index_cn.html" class="btn btn-neutral float-left" title="OTP 存储器" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../1_chipen/0_chipen_index_cn.html" class="btn btn-neutral float-right" title="芯片使能（CHIP_EN）" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2025, Realsil。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
    <!-- 问题反馈按钮和对话框 -->
    
        <button id="report-button">Inquire</button>
    
    <div id="feedback-dialog" class="feedback-dialog" style="display: none;">
        <div class="form-group">
            <label style="font-weight: bold;">Please select the related chapter:</label>
            <select id="chapter-select">
                <option value="">Select Chapter</option>
                <!-- 章节选项将通过JavaScript动态填充 -->
            </select>
        </div>

        <div class="form-group">
            <label style="font-weight: bold;">Post Type</label>
            <select id="post-type" class="form-control" required>
                <option value="">-- Select Type --</option>
                <option value="doc_correction">Document Correction</option>
                <option value="tech_consult">Technical Consult</option>
                <option value="tech_summary">Technical Summary</option>
                <option value="operation_flow">Operation Flow</option>
            </select>
        </div>

        <div class="form-group">
            <label style="font-weight: bold;">Related Paragraph:</label>
            <textarea
                id="paragraph-input"
                placeholder="{{ '你可以先选择有问题的段落或手动输入...' if language == 'zh_CN' else 'You can select text or type directly here...' }}"
                rows="4"
            ></textarea>
        </div>

        <div class="form-group">
            <label style="font-weight: bold;">Please describe your issue:</label>
            <textarea
                id="inquire_input"
                placeholder="Feature enhancement in progress, please stay tuned...">
            </textarea>
        </div>

        <button id="submit-feedback">Submit</button>
        <button id="cancel-feedback">Cancel</button>
    </div>

    <style>
        .form-group {
            margin: 5px 0;  /* 基础间距 */
        }

        /* 相邻表单项缩小上方间距 */
        .form-group + .form-group {
            margin-top: 10px;
        }

        /* 段落输入框底部微调 */
        #paragraph-input, #inquire_input {
            margin: 2px 0; /* 上下间距 */
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            min-height: 100px;

            /* 占位符样式 */
            &::placeholder {
                color: #999;
                font-style: italic;
            }
        }
    </style>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
     

    
        
        <script>
            // 路由守卫配置
            const ROUTER_CONFIG = {
                baseUrl: 'http://172.29.57.206:5000',
                checkInterval: 30000 // 30秒检查一次
            };

            window.getStoredUsername = function() {
                try {
                    const session = localStorage.getItem('auth_session');
                    if (!session) return null;
                    const { username, expires } = JSON.parse(session);
                    if (Date.now() > expires) {
                        localStorage.removeItem('auth_session');
                        return null;
                    }
                    return username;
                } catch (e) {
                    console.error('读取存储会话失败:', e);
                    return null;
                }
            }

            // 增强型路由守卫
            function setupRouteGuard() {
                const originalPushState = history.pushState;
                const originalReplaceState = history.replaceState;
            
                function wrappedHistoryMethod(method) {
                    return function(state, title, url) {
                        if (url) {
                            const urlObj = new URL(url, window.location.origin);
                            verifyNavigation(urlObj.pathname).then(allowed => {
                                if (allowed) {
                                    method.apply(history, [state, title, url]);
                                }
                            });
                        } else {
                            method.apply(history, [state, title, url]);
                        }
                    };
                }

                history.pushState = wrappedHistoryMethod(originalPushState);
                history.replaceState = wrappedHistoryMethod(originalReplaceState);

                window.addEventListener('popstate', () => {
                    verifyNavigation(window.location.pathname);
                });
            }

            // CSRF Token处理：获取CSRF令牌
            window.getCSRFToken = function() {
                // 从 Cookie 中获取 CSRF Token
                const cookieValue = document.cookie
                    .split('; ')
                    .find(row => row.startsWith('csrf_token='))
                    ?.split('=')[1];
                return cookieValue || '';
            }

            // 统一验证逻辑
            function verifyNavigation(path, isBackgroundCheck = false) {
                console.log('[NDA Auth] verifyNavigation fetch check_nda_access ...');

                if (isExemptPath(path)) return Promise.resolve(true);

                const page = new URL(path, window.location.origin).pathname.split('/').pop();
                console.log('[DEBUG] 提取的页面名称:', page);

                return fetch('http://172.29.57.206:5000/check_nda_access', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': window.getCSRFToken()
                    },
                    body: JSON.stringify({
                        path: page,
                        username: window.getStoredUsername() || 'null' //  注意：后端从 session 取用户名，此处不需要传 username
                    }),
                    credentials: 'include'
                })
                .then(response => {
                    // 关键：先检查状态码再解析 JSON
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json(); // 显式解析 JSON
                })
                .then(data => {
                    console.log('[DEBUG] data.access:', data.access);
                    return data.access ?? false;
                })
                .catch(error => {
                    console.error('[ERROR] 验证失败:', error);
                    return false;
                });
            }

            // 初始化
            document.addEventListener('DOMContentLoaded', () => {
                verifyNavigation(window.location.pathname);
                setupRouteGuard();
            });
        </script>
    

    


</body>
</html>