

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; Ameba IoT Docs  文档</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom_cn.css?v=0d22fac7" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/_static/custom_cn.css" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=7d86a446"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../../_static/translations.js?v=beaddf03"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Inter-integrated Circuit (I2C) Interface" href="../8_i2c/0_i2c_index_cn.html" />
    <link rel="prev" title="Light Emitting Diode Controller (LEDC)" href="0_ledc_index_cn.html" />
   
  
  <script type="text/javascript" src="../../_static/js/selector.js"></script>

  <style>
    .wy-nav-content {max-width: 1000px;} /* 设置最大宽度 */
  </style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../rst_rtos/0_ameba_product/0_ameba_product_center_index_cn.html">产品中心</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_rtos/0_ameba_sdk/0_ameba_sdks_index_cn.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_release_packages/0_release_packages_index_cn.html">0.0 释放包</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index_cn.html">0.1 GCC 编译环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_architecture/0_sdk_architecture_index_cn.html">0.2 SDK 架构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_rtos/0_tools/0_tools_index_cn.html">0.7 工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_question_help/0_question_help_index_cn.html">0.A 问题与帮助</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_debugging/0_debugging_index_cn.html">0.B 系统调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index_cn.html">1.1 启动流程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index_cn.html">1.2 固件在线升级（OTA）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_otpc/0_otpc_index_cn.html">1.3 OTP 存储器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_flash/0_flash_index_cn.html">1.4 闪存</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index_cn.html">1.7 通用输入输出端口</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index_cn.html">1.8 电源管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_secure_boot/0_secure_boot_index_nda_cn.html">3.6 安全启动</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb_boot/0_usb_boot_index_cn.html">3.7 USB 启动</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_crypto_engine/0_crypto_engine_index_cn.html">3.8 加密引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index_cn.html">4.3 多媒体</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index_cn.html">7.1 USB 主机与设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_sdio/0_sdioh_index_cn.html">7.2 SDIO 主机</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index_cn.html">8.1 DMA 控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc/0_rtc_index_cn.html">8.2 实时时钟（RTC）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index_cn.html">8.3 热计量器（Thermel）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index_cn.html">8.4 模数转换器（ADC）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_cap_touch/0_cap_touch_index_cn.html">8.5 电容触摸（Cap-touch）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index_cn.html">8.6 红外收发器（IR）</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_ledc_index_cn.html">8.7 LED 灯控制器</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dts-configuration">DTS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-configuration">Build Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#apis">APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apis-for-user-space">APIs for User Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apis-for-kernel-space">APIs for Kernel Space</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ledc-control-application">LEDC Control Application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../8_i2c/0_i2c_index_cn.html">8.8 集成电路间通信（I2C）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_uart/0_uart_index_cn.html">8.9 通用异步收发传输器（UART）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index_cn.html">8.A 液晶显示控制器（LCDC）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_spi/0_spi_index_cn.html">8.B 串行外设接口（SPI）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_spic/0_spic_index_cn.html">8.C SPI 闪存控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_timer/0_timer_index_cn.html">8.D 计时器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_wdg/0_wdg_index_cn.html">8.E 看门狗</a></li>
<li class="toctree-l1"><a class="reference internal" href="../9_bluetooth/0_bluetooth_index_cn.html">9.1 蓝牙</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">

        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_ledc_index_cn.html">Light Emitting Diode Controller (LEDC)</a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<span id="ledc"></span><h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<p>LEDC is used to control external Intelligent LED lamps, like <em>WS2812B</em>.</p>
<p>LEDC supports DMA mode and interrupt mode, with 32*24bit LEDC FIFO. LEDC also supports <em>RGB888</em> display mode and configurable refresh time.</p>
<section id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Link to this heading"></a></h2>
<p>The LEDC driver of Realtek follows Linux framework: <code class="file docutils literal notranslate"><span class="pre">led-class.c</span></code>, <code class="file docutils literal notranslate"><span class="pre">led-core.c</span></code>, <code class="file docutils literal notranslate"><span class="pre">led-trigger.c</span></code>. Pattern trigger is supported by this driver. The LEDC software architecture is illustrated in below.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/ledc_software_arch.svg"><img alt="../../_images/ledc_software_arch.svg" height="291" src="../../_images/ledc_software_arch.svg" width="428" /></a>
<figcaption>
<p><span class="caption-text">LEDC software architecture</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>For more details of Linux LEDs system, refer to: <a class="reference external" href="https://www.kernel.org/doc/html/v5.4/leds/index.html?highlight=leds">https://www.kernel.org/doc/html/v5.4/leds/index.html?highlight=leds</a>.</p>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Link to this heading"></a></h2>
<p>The LEDC driver is implemented as the following files:</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Driver location</p></th>
<th class="head"><p>Introduction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&lt;linux&gt;/drivers/rtkdrivers/ledc/Kconfig</p></td>
<td><p>LEDC driver Kconfig</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;linux&gt;/drivers/rtkdrivers/ledc/Makefile</p></td>
<td><p>LEDC driver Makefile</p></td>
</tr>
<tr class="row-even"><td><p>&lt;linux&gt;/drivers/rtkdrivers/ledc/leds-rtk-ws28xxx.c</p></td>
<td><p>LEDC functions.</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;linux&gt;/drivers/rtkdrivers/ledc/leds-rtk-ws28xxx.h</p></td>
<td><p>LEDC related function declaration, macro definition, structure definition and the other header files quoted.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h1>
<section id="dts-configuration">
<h2>DTS Configuration<a class="headerlink" href="#dts-configuration" title="Link to this heading"></a></h2>
<p>The LEDC DTS node is defined in DTS file <code class="docutils literal notranslate"><span class="pre">&lt;dts&gt;/rtl8730e-ocp.dtsi</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ledc</span><span class="p">:</span> <span class="n">led</span><span class="o">-</span><span class="n">controller</span><span class="o">@</span><span class="mi">41008000</span> <span class="p">{</span>
   <span class="n">compatible</span> <span class="o">=</span> <span class="s2">&quot;realtek,ameba-ws28xxx-led&quot;</span><span class="p">;</span>
   <span class="n">reg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x41008000</span> <span class="mh">0x1000</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">interrupts</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">GIC_SPI</span> <span class="mi">68</span> <span class="n">IRQ_TYPE_LEVEL_HIGH</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="c1">#address-cells = &lt;1&gt;;</span>
   <span class="c1">#size-cells = &lt;0&gt;;</span>
   <span class="n">clocks</span> <span class="o">=</span> <span class="o">&lt;&amp;</span><span class="n">rcc</span> <span class="n">RTK_CKE_LEDC</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">led</span><span class="o">-</span><span class="n">nums</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">dmas</span> <span class="o">=</span> <span class="o">&lt;&amp;</span><span class="n">dma</span> <span class="mi">5</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">dma</span><span class="o">-</span><span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;dma_leds_tx&quot;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">wait</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">timeout</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x7FFF</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">output</span><span class="o">-</span><span class="n">RGB</span><span class="o">-</span><span class="n">mode</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">;</span> <span class="o">//</span> <span class="n">Refer</span> <span class="n">to</span> <span class="n">spec</span> <span class="k">for</span> <span class="n">details</span><span class="o">.</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">data</span><span class="o">-</span><span class="n">tx</span><span class="o">-</span><span class="n">time0h</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0xD</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">data</span><span class="o">-</span><span class="n">tx</span><span class="o">-</span><span class="n">time0l</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x27</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">data</span><span class="o">-</span><span class="n">tx</span><span class="o">-</span><span class="n">time1h</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x27</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">data</span><span class="o">-</span><span class="n">tx</span><span class="o">-</span><span class="n">time1l</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0xD</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">refresh</span><span class="o">-</span><span class="n">time</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x3A97</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;disabled&quot;</span><span class="p">;</span>
   <span class="n">led</span><span class="o">@</span><span class="mi">0</span> <span class="p">{</span>
      <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;common&quot;</span><span class="p">;</span>
      <span class="n">reg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x0</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The DTS parameters of LEDC are listed in the following table.</p>
<table class="docutils align-default" id="id3" style="width: 100%">
<caption><span class="caption-text">LEDC DTS parameters configuration</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Configurable?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>compatible</p></td>
<td><p>The description of LEDC driver: <code class="docutils literal notranslate"><span class="pre">realtek,</span> <span class="pre">ameba-ws28xxx-led</span></code></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>reg</p></td>
<td><p>The hardware address and size for LEDC device: &lt;0x41008000 0x1000&gt;.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>interrupts</p></td>
<td><p>The GIC number of LEDC device: &lt;GIC_SPI 68 IRQ_TYPE_LEVEL_HIGH&gt;.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>clocks</p></td>
<td><p>The clock of LEDC device: &lt;&amp;rcc RTK_CKE_LEDC&gt;.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>dmas</p></td>
<td><p>DMA channel, refer to DMA application note</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>dma-names</p></td>
<td><p>DMA channel name</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>rtk,led-nums</p></td>
<td><p>The led numbers in your hardware. 1 LED, 32 LEDs, 64 or the other.</p></td>
<td><p>1~1024</p></td>
</tr>
<tr class="row-odd"><td><p>rtk,wait-data-timeout</p></td>
<td><p>When the setting time exceeds, LEDC will get an interrupt and software-reset the LEDC device.</p></td>
<td><p>1~0x7FFF</p></td>
</tr>
<tr class="row-even"><td><p>rtk,output-RGB-mode</p></td>
<td><p>Output RGB mode</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>rtk,data-tx-time0h</p></td>
<td><p>0-code, High-level time, default by 0xd, t0h = 25ns * (0xd + 1).</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>rtk,data-tx-time0l</p></td>
<td><p>0-code, Low-level time, default by 0x27, t0l = 25ns * (0x27 + 1).</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>rtk,data-tx-time1h</p></td>
<td><p>1-code, High-level time, default by 0x27, t1h = 25ns * (0x27 + 1).</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>rtk,data-tx-time1l</p></td>
<td><p>1-code, Low-level time, default by 0xd, t1l = 25ns * (0xd + 1).</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>rtk,refresh-time</p></td>
<td><p>Reset time control of LED lamp, the refresh time for one slice. Default as 0x3a97, reset time = 25ns * (0x3a97 + 1).</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>Whether enable this device.</p>
<ul class="simple">
<li><p>disabled</p></li>
<li><p>okay</p></li>
</ul>
</td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>led&#64;0</p></td>
<td><p>LEDC client node. The whole group of ws28xxx LED lamps will be considered as one LED device named <code class="docutils literal notranslate"><span class="pre">common</span></code>.</p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Section <a class="reference internal" href="#ledc-control-application"><span class="std std-ref">LEDC Control Application</span></a> provides an example for the LEDC timing parameters.</p>
</div>
<p>The pin assignments of LEDC are listed in the following table.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Port name</p></th>
<th class="head"><p>Pin name</p></th>
<th class="head"><p>pinctrl description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PA3</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-odd"><td><p>PA6</p></td>
<td><p>LEDC_TX</p></td>
<td><p>&lt;&amp;ledc_pins&gt;</p></td>
</tr>
<tr class="row-even"><td><p>PA7</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-odd"><td><p>PA8</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-even"><td><p>PA9</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-odd"><td><p>PA10</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-even"><td><p>PA13</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-odd"><td><p>PA20</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-even"><td><p>PA21</p></td>
<td><p>LEDC_TX</p></td>
<td><p>Shall add manually.</p></td>
</tr>
<tr class="row-odd"><td><p>PA22</p></td>
<td><p>LEDC_TX</p></td>
<td><p>&lt;&amp;ledc_pins_a &gt;</p></td>
</tr>
<tr class="row-even"><td><p>PA25</p></td>
<td><p>LEDC_TX</p></td>
<td><p>&lt;&amp;ledc_pins_a &gt;</p></td>
</tr>
</tbody>
</table>
<p>LEDC has only one pinmux for Tx, therefore, in pinmux DTS, only one pin is defined.
If pinmux needs revision according to the specific board, just revise the ledc_pins node in pinmux DTS. The pinmux can be revised to anyone above, as far as board hardware supported.</p>
</section>
<section id="build-configuration">
<h2>Build Configuration<a class="headerlink" href="#build-configuration" title="Link to this heading"></a></h2>
<p>Select <span class="menuselection">Device Drivers -&gt; Drivers for Realtek -&gt; LED driver for WS28XXX</span>.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../../_images/ledc_driver.png"><img alt="../../_images/ledc_driver.png" src="../../_images/ledc_driver.png" style="width: 297.0px; height: 324.0px;" /></a>
<figcaption>
<p><span class="caption-text">LEDC Driver</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="apis">
<h1>APIs<a class="headerlink" href="#apis" title="Link to this heading"></a></h1>
<section id="apis-for-user-space">
<h2>APIs for User Space<a class="headerlink" href="#apis-for-user-space" title="Link to this heading"></a></h2>
<p>Set LEDC pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># cd /sys/class/leds/rtk_ws28xxx:common/</span>
<span class="c1"># echo 0x2255FF 0 0x2255FF 0 0x2255FF 0 0x2255FF 0 &gt; hw_pattern</span>
</pre></div>
</div>
<p>Find the LEDC demo for user space at <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;/tests/ledc</span></code>.</p>
</section>
<section id="apis-for-kernel-space">
<h2>APIs for Kernel Space<a class="headerlink" href="#apis-for-kernel-space" title="Link to this heading"></a></h2>
<p>None.</p>
</section>
</section>
<section id="ledc-control-application">
<span id="id1"></span><h1>LEDC Control Application<a class="headerlink" href="#ledc-control-application" title="Link to this heading"></a></h1>
<p>Taking <em>WS2812C-2020</em> LED for example, before using this LED, we have to configure the logical character <code class="docutils literal notranslate"><span class="pre">0</span></code> and character <code class="docutils literal notranslate"><span class="pre">1</span></code> according to the LEDC data input code of typical LED datasheet,
as shown in the following table.</p>
<table class="docutils align-default" id="id5" style="width: 100%">
<caption><span class="caption-text">Typical LED modulation datasheet</span><a class="headerlink" href="#id5" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Modulate code</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Time range</p></th>
<th class="head"><p>Unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>T0H</p></td>
<td><p>Digital 0 code, high-level time</p></td>
<td><p>220 ~ 380</p></td>
<td><p>ns</p></td>
</tr>
<tr class="row-odd"><td><p>T0L</p></td>
<td><p>Digital 0 code, low-level time</p></td>
<td><p>580 ~ 1000</p></td>
<td><p>ns</p></td>
</tr>
<tr class="row-even"><td><p>T1H</p></td>
<td><p>Digital 1 code, high-level time</p></td>
<td><p>580 ~ 1000</p></td>
<td><p>ns</p></td>
</tr>
<tr class="row-odd"><td><p>T1L</p></td>
<td><p>Digital 1 code, low-level time</p></td>
<td><p>220 ~ 420</p></td>
<td><p>ns</p></td>
</tr>
<tr class="row-even"><td><p>RESET</p></td>
<td><p>Frame unit, low-level time</p></td>
<td><p>&gt; 280</p></td>
<td><p>μs</p></td>
</tr>
</tbody>
</table>
<p>Logical <code class="docutils literal notranslate"><span class="pre">0</span></code> coding time is T0-code: 800ns ~ 1980ns, and logical <code class="docutils literal notranslate"><span class="pre">1</span></code> coding time is T1-code: 800ns ~ 2020ns.</p>
<p>The supported LED number</p>
<ul class="simple">
<li><p>When LED’s refresh rate is 30 frames/s, the supported LED number is 681 to 1023;</p></li>
<li><p>When LED’s refresh rate is 60 frames/s, the supported LED number is 337 to 853.</p></li>
</ul>
<p>The related registers of LED setting are <cite>LED_T0&amp;T1_TIMING_CTRL_REG</cite>, <cite>LEDC_DATA_FINISH_CNT_REG</cite>, <cite>LED_RESET_TIMING_CTRL_REG</cite>, <cite>LEDC_WAIT_TIME_CTRL_REG</cite>, <cite>LEDC_DMA_CTRL_REG</cite>, and <cite>LEDC_INTERRUPT_CTRL_REG</cite>.</p>
<p>WS2812 serious LED data transfer protocol uses a single NRZ (non-return zero) communication mode.
After the LED power-on reset, the <code class="docutils literal notranslate"><span class="pre">DI</span></code> port receives data from the controller, the first LED collects initial 24-bit data then sends 24-bit data to the internal data latch,
the other data reshaping by the internal signal reshaping amplification circuit sent to the next cascade pixel through the <code class="docutils literal notranslate"><span class="pre">DO</span></code> port.
After transmission of each pixel, the signal reduces 24 bits. Pixel adopts auto reshaping transmit technology,
making the pixel cascade number is not limited by the signal transmission, only depending on the speed of signal transmission.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="0_ledc_index_cn.html" class="btn btn-neutral float-left" title="Light Emitting Diode Controller (LEDC)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../8_i2c/0_i2c_index_cn.html" class="btn btn-neutral float-right" title="Inter-integrated Circuit (I2C) Interface" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2025, Realsil。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>