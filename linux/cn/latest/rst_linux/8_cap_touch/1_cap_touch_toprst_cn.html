

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>概述 &mdash; Ameba IoT Docs  文档</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom_cn.css?v=0d22fac7" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/_static/custom_cn.css" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=7d86a446"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../../_static/translations.js?v=beaddf03"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="红外收发器（IR）" href="../8_ir/0_ir_index_cn.html" />
    <link rel="prev" title="Cap-Touch控制器（CTC）" href="0_cap_touch_index_cn.html" />
   
  
  <script type="text/javascript" src="../../_static/js/selector.js"></script>

  <style>
    .wy-nav-content {max-width: 1000px;} /* 设置最大宽度 */
  </style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Ameba IoT Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../rst_rtos/0_ameba_product/0_ameba_product_center_index_cn.html">产品中心</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_rtos/0_ameba_sdk/0_ameba_sdks_index_cn.html">Ameba SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_release_packages/0_release_packages_index_cn.html">0.0 释放包</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_gcc_build_environment/0_gcc_build_index_cn.html">0.1 GCC 编译环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_sdk_architecture/0_sdk_architecture_index_cn.html">0.2 SDK 架构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_rtos/0_tools/0_tools_index_cn.html">0.7 工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_question_help/0_question_help_index_cn.html">0.A 问题与帮助</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0_debugging/0_debugging_index_cn.html">0.B 系统调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_boot_process/0_boot_index_cn.html">1.1 启动流程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_ota/0_ota_index_cn.html">1.2 固件在线升级（OTA）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_otpc/0_otpc_index_cn.html">1.3 OTP 存储器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_flash/0_flash_index_cn.html">1.4 闪存</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_gpio/0_gpio_index_cn.html">1.7 通用输入输出端口</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_power_save/0_ps_index_cn.html">1.8 电源管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_nda_secure_boot/0_secure_boot_index_nda_cn.html">3.6 安全启动</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb_boot/0_usb_boot_index_cn.html">3.7 USB 启动</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_crypto_engine/0_crypto_engine_index_cn.html">3.8 加密引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_multimedia/0_multimedia_index_cn.html">4.3 多媒体</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_usb/0_usb_index_cn.html">7.1 USB 主机与设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_sdio/0_sdioh_index_cn.html">7.2 SDIO 主机</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_dmac/0_dmac_index_cn.html">8.1 DMA 控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_rtc/0_rtc_index_cn.html">8.2 实时时钟（RTC）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_thermal/0_thermal_index_cn.html">8.3 热计量器（Thermel）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_adc/0_adc_index_cn.html">8.4 模数转换器（ADC）</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="0_cap_touch_index_cn.html">8.5 电容触摸（Cap-touch）</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">概述</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">架构</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">实现</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id4">配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dts">DTS 配置</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">引脚</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id6">编译配置</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apis-for-user-space">APIs for User Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apis-for-kernel-space">APIs for Kernel Space</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../8_ir/0_ir_index_cn.html">8.6 红外收发器（IR）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_ledc/0_ledc_index_cn.html">8.7 LED 灯控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_i2c/0_i2c_index_cn.html">8.8 集成电路间通信（I2C）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_uart/0_uart_index_cn.html">8.9 通用异步收发传输器（UART）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_lcdc/0_lcdc_index_cn.html">8.A 液晶显示控制器（LCDC）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_spi/0_spi_index_cn.html">8.B 串行外设接口（SPI）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_spic/0_spic_index_cn.html">8.C SPI 闪存控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_timer/0_timer_index_cn.html">8.D 计时器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_wdg/0_wdg_index_cn.html">8.E 看门狗</a></li>
<li class="toctree-l1"><a class="reference internal" href="../9_bluetooth/0_bluetooth_index_cn.html">9.1 蓝牙</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ameba IoT Docs</a>
      </nav>

      <div class="wy-nav-content">

        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="0_cap_touch_index_cn.html">Cap-Touch控制器（CTC）</a></li>
      <li class="breadcrumb-item active">概述</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ctc">
<span id="id1"></span><h1>概述<a class="headerlink" href="#ctc" title="Link to this heading"></a></h1>
<section id="id2">
<h2>架构<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>The CTC driver follows Linux’s Input subsystem. Input provides CTC interface to user space. The CTC software architecture is illustrated in the following figure.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/ctc_software_architecture.svg"><img alt="../../_images/ctc_software_architecture.svg" height="398" src="../../_images/ctc_software_architecture.svg" width="394" /></a>
</figure>
<p>The CTC software architecture contains the following parts:</p>
<ul class="simple">
<li><p>Input driver: CTC driver.</p></li>
<li><p>Input core: Input subsystem core driver. It is the link and bridge between input driver layer and event handler layer, providing the interface downward to the hardware input driver layer and upward to the event processing layer.</p></li>
<li><p>Event handler: Interact with user space, it is used to report the events from the hardware driver layer to the user program.</p></li>
<li><p>Application: User space use. A simple example to show how to use CTC.</p></li>
</ul>
<p>For more details, refer to <a class="reference external" href="https://www.kernel.org/doc/html/v5.4/input/input-programming.html?highlight=input%20uapi">How to Create Input Device Driver</a>.</p>
</section>
<section id="id3">
<h2>实现<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p>CTC driver is implemented as following files:</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Driver location</p></th>
<th class="head"><p>Introduction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&lt;linux&gt;/drivers/rtkdrivers/captouch/Kconfig</p></td>
<td><p>CTC driver Kconfig</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;linux&gt;/drivers/rtkdrivers/captouch/Makefile</p></td>
<td><p>CTC driver Makefile</p></td>
</tr>
<tr class="row-even"><td><p>&lt;linux&gt;/drivers/rtkdrivers/captouch/realtek-captouch.c</p></td>
<td><p>CTC functions.</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;linux&gt;/drivers/rtkdrivers/captouch/realtek-captouch.h</p></td>
<td><p>CTC related function declaration, macro definition, structure definition and the other header files quoted</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="id4">
<h1>配置<a class="headerlink" href="#id4" title="Link to this heading"></a></h1>
<section id="dts">
<h2>DTS 配置<a class="headerlink" href="#dts" title="Link to this heading"></a></h2>
<p>CTC DTS节点：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">captouch</span><span class="p">:</span> <span class="n">captouch</span><span class="o">@</span><span class="mi">42010000</span> <span class="p">{</span>
   <span class="n">compatible</span> <span class="o">=</span> <span class="s2">&quot;realtek,ameba-captouch&quot;</span><span class="p">;</span>
   <span class="n">reg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x42010000</span> <span class="mh">0x500</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="mh">0x420082F8</span> <span class="mh">0x4</span><span class="o">&gt;</span><span class="p">;</span><span class="o">//</span><span class="n">Control</span> <span class="n">digital</span> <span class="n">path</span> <span class="nb">input</span> <span class="k">for</span> <span class="n">ADC</span> <span class="ow">and</span> <span class="n">CTC</span> <span class="n">pad</span>
   <span class="n">interrupts</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">GIC_SPI</span> <span class="mi">13</span> <span class="n">IRQ_TYPE_LEVEL_HIGH</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">clocks</span> <span class="o">=</span> <span class="o">&lt;&amp;</span><span class="n">rcc</span> <span class="n">RTK_CKE_CTC</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;&amp;</span><span class="n">rcc</span> <span class="n">RTK_CKE_ADC</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">clock</span><span class="o">-</span><span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;rtk_ctc_clk&quot;</span><span class="p">,</span> <span class="s2">&quot;rtk_adc_clk&quot;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">ctc</span><span class="o">-</span><span class="n">diffthr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">ctc</span><span class="o">-</span><span class="n">mbias</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mh">0x18</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mh">0x17</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mh">0x1B</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mh">0x00</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mh">0x00</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mh">0x00</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mh">0x00</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mh">0x00</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">ctc</span><span class="o">-</span><span class="n">nnoise</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">ctc</span><span class="o">-</span><span class="n">pnoise</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">400</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1000</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">ctc</span><span class="o">-</span><span class="n">ch</span><span class="o">-</span><span class="n">status</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">rtk</span><span class="p">,</span><span class="n">ctc</span><span class="o">-</span><span class="n">keycodes</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">KEY_1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_2</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_3</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_4</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_5</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_6</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_7</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_8</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">KEY_9</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">nvmem</span><span class="o">-</span><span class="n">cells</span> <span class="o">=</span> <span class="o">&lt;&amp;</span><span class="n">efuse_ctc_mbias</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="n">nvmem</span><span class="o">-</span><span class="n">cell</span><span class="o">-</span><span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;ctc_mbias&quot;</span><span class="p">;</span>
   <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;disabled&quot;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>CTC DTS的配置如下表所示。</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Configurable?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>compatible</p></td>
<td><p>The description of CTC driver. Default: “realtek,ameba- captouch “.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>reg</p></td>
<td><p>The hardware address and size for CTC device. Default: &lt;0x42010000 0x500&gt;</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>interrupts</p></td>
<td><p>The GIC number of CTC device. Default: &lt;GIC_SPI 13 IRQ_TYPE_LEVEL_HIGH&gt;</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>clocks</p></td>
<td><p>The clock of CTC device. Default: &lt;&amp;rcc RTK_CKE_CTC&gt;, &lt;&amp;rcc RTK_CKE_ADC&gt;</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>rtk,ctc-diffthr</p></td>
<td><p>Cap-touch difference threshold for 9 channels. (see NOTE below)</p></td>
<td><p>0~4095</p></td>
</tr>
<tr class="row-odd"><td><p>rtk,ctc-mbias</p></td>
<td><p>Cap-touch mbias current for 9 channels. (see NOTE below)</p></td>
<td><p>0~63</p></td>
</tr>
<tr class="row-even"><td><p>rtk,ctc-nnoise</p></td>
<td><p>Cap-touch negative noise threshold for 9 channels. (see NOTE below)</p></td>
<td><p>0~4095</p></td>
</tr>
<tr class="row-odd"><td><p>rtk,ctc-pnoise</p></td>
<td><p>Cap-touch positive noise threshold for 9 channels. (see NOTE below)</p></td>
<td><p>0~4095</p></td>
</tr>
<tr class="row-even"><td><p>rtk,ctc-ch-status</p></td>
<td><p>Cap-touch channel enable control for 9 channels.</p>
<ul class="simple">
<li><p>1: enable</p></li>
<li><p>0: disable</p></li>
</ul>
</td>
<td><p>0/1</p></td>
</tr>
<tr class="row-odd"><td><p>rtk,ctc-keycodes</p></td>
<td><p>Cap-touch key codes corresponding to 9 channels.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>nvmem-cells</p></td>
<td><p>The nvmem cells for CTC.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>nvmem-cell-names</p></td>
<td><p>The names of nvmen cells for CTC</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>Whether enable the device.</p>
<ul class="simple">
<li><p>disabled</p></li>
<li><p>okay</p></li>
</ul>
</td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>Each parameter 9 values are corresponding to touch0~touch8 in sequence.</p></li>
<li><p>Due to there are difference among channels and different boards, cap-touch is suggested to do calibration.</p></li>
<li><p>For the parameters <em>ctc-diffthr</em>, <em>ctc-mbias</em>, <em>ctc-nnoise</em>, <em>ctc-pnoise</em> in table above, the factory should calibrate them for each channel, and write them into EFUSE. If the values in EFUSE are empty, the value in dts file will be used instead.</p></li>
</ul>
</div>
<section id="id5">
<h3>引脚<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>The pin assignments of captouch are listed in the table below.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Port name</p></th>
<th class="head"><p>Pin name</p></th>
<th class="head"><p>pinctrl description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PA0</p></td>
<td><p>TOUCH0</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-odd"><td><p>PA1</p></td>
<td><p>TOUCH1</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-even"><td><p>PA2</p></td>
<td><p>TOUCH2</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-odd"><td><p>PA3</p></td>
<td><p>TOUCH3</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-even"><td><p>PA4</p></td>
<td><p>TOUCH4</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-odd"><td><p>PA5</p></td>
<td><p>TOUCH5</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-even"><td><p>PA6</p></td>
<td><p>TOUCH6</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-odd"><td><p>PA7</p></td>
<td><p>TOUCH7</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
<tr class="row-even"><td><p>PA8</p></td>
<td><p>TOUCH8</p></td>
<td><p>&lt;&amp;captouch_pins &gt;</p></td>
</tr>
</tbody>
</table>
<p>Refer to pinctrl application note for more details.</p>
</section>
</section>
<section id="id6">
<h2>编译配置<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<p>Select <span class="menuselection">Device Drivers &gt; Drivers for Realtek &gt; Captouch driver</span> in order:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/cap_touch_build_configuration.png"><img alt="../../_images/cap_touch_build_configuration.png" src="../../_images/cap_touch_build_configuration.png" style="width: 742.5px; height: 679.5px;" /></a>
</figure>
</section>
</section>
<section id="api">
<h1>API<a class="headerlink" href="#api" title="Link to this heading"></a></h1>
<section id="apis-for-user-space">
<h2>APIs for User Space<a class="headerlink" href="#apis-for-user-space" title="Link to this heading"></a></h2>
<p>sysfs interface is used to interact with user space, device node locates in <code class="docutils literal notranslate"><span class="pre">/dev/input/eventX</span></code>. User space can use <em>open()</em>, <em>read()</em> to get CTC event.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Items</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>evdev_open</p></td>
<td><p>Open input device.</p></td>
</tr>
<tr class="row-odd"><td><p>evdev_read</p></td>
<td><p>Get data from input device.</p></td>
</tr>
</tbody>
</table>
<p>CTC demo for user space locates at: <code class="docutils literal notranslate"><span class="pre">&lt;test&gt;/captouch</span></code>.</p>
</section>
<section id="apis-for-kernel-space">
<h2>APIs for Kernel Space<a class="headerlink" href="#apis-for-kernel-space" title="Link to this heading"></a></h2>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Items</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>devm_input_allocate_device</p></td>
<td><p>Allocate managed input device.</p></td>
</tr>
<tr class="row-odd"><td><p>input_allocate_device</p></td>
<td><p>Allocate memory for new input device.</p></td>
</tr>
<tr class="row-even"><td><p>input_free_device</p></td>
<td><p>Free memory occupied by input_dev structure</p></td>
</tr>
<tr class="row-odd"><td><p>input_register_device</p></td>
<td><p>Register device with input core.</p></td>
</tr>
<tr class="row-even"><td><p>input_unregister_device</p></td>
<td><p>Unregister previously registered device.</p></td>
</tr>
<tr class="row-odd"><td><p>input_event</p></td>
<td><p>Report new input event.</p></td>
</tr>
</tbody>
</table>
<p>For more details, refer to <a class="reference external" href="https://www.kernel.org/doc/html/v5.4/input/input_kapi.html">Input Subsystem kernel API</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="0_cap_touch_index_cn.html" class="btn btn-neutral float-left" title="Cap-Touch控制器（CTC）" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../8_ir/0_ir_index_cn.html" class="btn btn-neutral float-right" title="红外收发器（IR）" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2025, Realsil。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>